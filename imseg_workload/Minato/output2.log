rnouaj
/dl-bench/rnouaj/data-preprocessing-loader
drwxrwxrwx 10 rnouaj nogroup 4096 Apr  3 12:33 /dl-bench/rnouaj/data-preprocessing-loader
STARTING TIMING RUN AT 2025-04-03 06:31:13 PM
:::MLLOG {"namespace": "", "time_ms": 1743705074904, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
2.4.1+cu121
:::MLLOG {"namespace": "", "time_ms": 1743705082067, "event_type": "INTERVAL_START", "key": "init_start", "value": null, "metadata": {"file": "/workspace/unet3d/main.py", "lineno": 73}}
Format conversion /raw_data
:::MLLOG {"namespace": "", "time_ms": 1743705082140, "event_type": "INTERVAL_START", "key": "init_start", "value": null, "metadata": {"file": "/workspace/unet3d/main.py", "lineno": 73}}
:::MLLOG {"namespace": "", "time_ms": 1743705082140, "event_type": "INTERVAL_START", "key": "init_start", "value": null, "metadata": {"file": "/workspace/unet3d/main.py", "lineno": 73}}
:::MLLOG {"namespace": "", "time_ms": 1743705082140, "event_type": "INTERVAL_START", "key": "init_start", "value": null, "metadata": {"file": "/workspace/unet3d/main.py", "lineno": 73}}
Format conversion /raw_dataFormat conversion /raw_data

Format conversion /raw_data
Distributed initialized. World size: 4
:::MLLOG {"namespace": "", "time_ms": 1743705083053, "event_type": "POINT_IN_TIME", "key": "world_size", "value": 4, "metadata": {"file": "/workspace/unet3d/main.py", "lineno": 88}}
:::MLLOG {"namespace": "", "time_ms": 1743705084513, "event_type": "POINT_IN_TIME", "key": "local_rank", "value": 0, "metadata": {"file": "/workspace/unet3d/main.py", "lineno": 89}}
:::MLLOG {"namespace": "", "time_ms": 1743705084515, "event_type": "POINT_IN_TIME", "key": "Batch size used", "value": 2, "metadata": {"file": "/workspace/unet3d/main.py", "lineno": 90}}
Using master seed from command line: 1Using master seed from command line: 1Using master seed from command line: 1


:::MLLOG {"namespace": "", "time_ms": 1743705084516, "event_type": "POINT_IN_TIME", "key": "Epochs", "value": 100, "metadata": {"file": "/workspace/unet3d/main.py", "lineno": 91}}
Using master seed from command line: 1
:::MLLOG {"namespace": "", "time_ms": 1743705084522, "event_type": "POINT_IN_TIME", "key": "seed", "value": 1, "metadata": {"file": "/workspace/unet3d/main.py", "lineno": 96}}
:::MLLOG {"namespace": "", "time_ms": 1743705084523, "event_type": "POINT_IN_TIME", "key": "submission_benchmark", "value": "unet3d", "metadata": {"file": "/workspace/unet3d/runtime/logging.py", "lineno": 64}}
:::MLLOG {"namespace": "", "time_ms": 1743705084691, "event_type": "POINT_IN_TIME", "key": "submission_org", "value": "your-company", "metadata": {"file": "/workspace/unet3d/runtime/logging.py", "lineno": 69}}
:::MLLOG {"namespace": "", "time_ms": 1743705084692, "event_type": "POINT_IN_TIME", "key": "submission_division", "value": "closed", "metadata": {"file": "/workspace/unet3d/runtime/logging.py", "lineno": 73}}
:::MLLOG {"namespace": "", "time_ms": 1743705084692, "event_type": "POINT_IN_TIME", "key": "submission_status", "value": "onprem", "metadata": {"file": "/workspace/unet3d/runtime/logging.py", "lineno": 77}}
:::MLLOG {"namespace": "", "time_ms": 1743705084692, "event_type": "POINT_IN_TIME", "key": "submission_platform", "value": "your_platform", "metadata": {"file": "/workspace/unet3d/runtime/logging.py", "lineno": 81}}
:::MLLOG {"namespace": "", "time_ms": 1743705084692, "event_type": "POINT_IN_TIME", "key": "opt_name", "value": "sgd", "metadata": {"file": "/workspace/unet3d/runtime/logging.py", "lineno": 87}}
:::MLLOG {"namespace": "", "time_ms": 1743705084693, "event_type": "POINT_IN_TIME", "key": "opt_base_learning_rate", "value": 0.8, "metadata": {"file": "/workspace/unet3d/runtime/logging.py", "lineno": 88}}
:::MLLOG {"namespace": "", "time_ms": 1743705084693, "event_type": "POINT_IN_TIME", "key": "opt_learning_rate_warmup_epochs", "value": 10, "metadata": {"file": "/workspace/unet3d/runtime/logging.py", "lineno": 89}}
:::MLLOG {"namespace": "", "time_ms": 1743705084693, "event_type": "POINT_IN_TIME", "key": "opt_learning_rate_decay_boundary_epochs", "value": [], "metadata": {"file": "/workspace/unet3d/runtime/logging.py", "lineno": 91}}
:::MLLOG {"namespace": "", "time_ms": 1743705084693, "event_type": "POINT_IN_TIME", "key": "opt_learning_rate_decay_factor", "value": 1.0, "metadata": {"file": "/workspace/unet3d/runtime/logging.py", "lineno": 92}}
:::MLLOG {"namespace": "", "time_ms": 1743705084694, "event_type": "POINT_IN_TIME", "key": "opt_weight_decay", "value": 0.0, "metadata": {"file": "/workspace/unet3d/runtime/logging.py", "lineno": 93}}
:::MLLOG {"namespace": "", "time_ms": 1743705084694, "event_type": "POINT_IN_TIME", "key": "opt_momentum", "value": 0.9, "metadata": {"file": "/workspace/unet3d/runtime/logging.py", "lineno": 94}}
:::MLLOG {"namespace": "", "time_ms": 1743705084694, "event_type": "POINT_IN_TIME", "key": "oversampling", "value": 0.4, "metadata": {"file": "/workspace/unet3d/runtime/logging.py", "lineno": 95}}
:::MLLOG {"namespace": "", "time_ms": 1743705084695, "event_type": "POINT_IN_TIME", "key": "training_input_shape", "value": [128, 128, 128], "metadata": {"file": "/workspace/unet3d/runtime/logging.py", "lineno": 96}}
:::MLLOG {"namespace": "", "time_ms": 1743705084695, "event_type": "POINT_IN_TIME", "key": "validation_input_shape", "value": [128, 128, 128], "metadata": {"file": "/workspace/unet3d/runtime/logging.py", "lineno": 97}}
:::MLLOG {"namespace": "", "time_ms": 1743705084695, "event_type": "POINT_IN_TIME", "key": "validation_overlap", "value": 0.5, "metadata": {"file": "/workspace/unet3d/runtime/logging.py", "lineno": 98}}
:::MLLOG {"namespace": "", "time_ms": 1743705084695, "event_type": "POINT_IN_TIME", "key": "Loader", "value": "pytorch", "metadata": {"file": "/workspace/unet3d/runtime/logging.py", "lineno": 99}}
:::MLLOG {"namespace": "", "time_ms": 1743705085130, "event_type": "INTERVAL_END", "key": "init_stop", "value": null, "metadata": {"file": "/workspace/unet3d/main.py", "lineno": 106}}
:::MLLOG {"namespace": "", "time_ms": 1743705085131, "event_type": "INTERVAL_START", "key": "run_start", "value": null, "metadata": {"file": "/workspace/unet3d/main.py", "lineno": 107}}
GPU Rank 3 is assigned 42 samples.
GPU Rank 2 is assigned 42 samples.:::MLLOG {"namespace": "", "time_ms": 1743705085135, "event_type": "POINT_IN_TIME", "key": "train_samples", "value": 169, "metadata": {"file": "/workspace/unet3d/data_loading/data_loader.py", "lineno": 63}}

GPU Rank 1 is assigned 42 samples.
:::MLLOG {"namespace": "", "time_ms": 1743705085136, "event_type": "POINT_IN_TIME", "key": "eval_samples", "value": 41, "metadata": {"file": "/workspace/unet3d/data_loading/data_loader.py", "lineno": 64}}
Created queue for GPU Rank 3.
[GPU Rank 3] Producer 0 assigned indices: [90, 153, 65, 154, 54, 106, 146, 46, 11, 136]
GPU Rank 0 is assigned 42 samples.
Created queue for GPU Rank 2.
[GPU Rank 2] Producer 0 assigned indices: [72, 43, 69, 31, 125, 106, 152, 35, 138, 99]
Created queue for GPU Rank 1.
[GPU Rank 1] Producer 0 assigned indices: [158, 92, 157, 94, 164, 77, 150, 128, 122, 120]
Created queue for GPU Rank 0.
[GPU Rank 0] Producer 0 assigned indices: [8, 6, 43, 75, 106, 72, 166, 55, 134, 59]
[GPU Rank 3] Producer 1 assigned indices: [87, 56, 144, 35, 124, 47, 137, 82, 60, 126]
[GPU Rank 2] Producer 1 assigned indices: [63, 107, 22, 164, 141, 129, 160, 143, 114, 41]
[GPU Rank 3 | Producer 291] Starting.
[GPU Rank 3 | Producer 291] Processing index 90
[GPU Rank 1] Producer 1 assigned indices: [136, 16, 0, 125, 152, 46, 140, 42, 23, 127]
[GPU Rank 0] Producer 1 assigned indices: [151, 76, 93, 17, 4, 74, 111, 62, 165, 28]
[GPU Rank 2 | Producer 292] Starting.
[GPU Rank 2 | Producer 292] Processing index 72
[GPU Rank 0 | Producer 294] Starting.
[GPU Rank 1 | Producer 293] Starting.
[GPU Rank 0 | Producer 294] Processing index 8
[GPU Rank 1 | Producer 293] Processing index 158
[GPU Rank 2] Producer 2 assigned indices: [104, 83, 65, 60, 30, 50, 103, 156, 9, 26]
[GPU Rank 3] Producer 2 assigned indices: [3, 94, 86, 0, 19, 51, 16, 43, 8, 29]
[GPU Rank 2 | Producer 295] Starting.
[GPU Rank 2 | Producer 295] Processing index 63
[GPU Rank 3 | Producer 296] Starting.
[GPU Rank 3 | Producer 296] Processing index 87
[GPU Rank 1] Producer 2 assigned indices: [56, 167, 14, 145, 35, 115, 63, 143, 19, 141]
[GPU Rank 0] Producer 2 assigned indices: [68, 114, 86, 145, 57, 141, 110, 65, 97, 101]
[GPU Rank 1 | Producer 297] Starting.
[GPU Rank 1 | Producer 297] Processing index 136
[GPU Rank 0 | Producer 298] Starting.
[GPU Rank 0 | Producer 298] Processing index 151
[GPU Rank 2] Producer 3 assigned indices: [38, 145, 108, 137, 87, 136, 113, 74, 20, 49]
[GPU Rank 2 | Producer 299] Starting.
[GPU Rank 2 | Producer 299] Processing index 104
[GPU Rank 3] Producer 3 assigned indices: [17, 88, 158, 99, 74, 23, 131, 52, 32, 161]
[GPU Rank 3 | Producer 300] Starting.
[GPU Rank 3 | Producer 300] Processing index 3
[GPU Rank 1] Producer 3 assigned indices: [78, 112, 162, 26, 8, 64, 55, 133, 110, 146]
[GPU Rank 0] Producer 3 assigned indices: [38, 0, 102, 152, 45, 63, 46, 121, 14, 80]
[GPU Rank 1 | Producer 301] Starting.
[GPU Rank 1 | Producer 301] Processing index 56
[GPU Rank 0 | Producer 302] Starting.
[GPU Rank 0 | Producer 302] Processing index 68
GPU Rank 2 is assigned 10 samples.
Created queue for GPU Rank 2.
[GPU Rank 2] Producer 0 assigned indices: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
[GPU Rank 2 | Producer 303] Starting.
[GPU Rank 2 | Producer 303] Processing index 38
GPU Rank 3 is assigned 10 samples.
Created queue for GPU Rank 3.
[GPU Rank 3] Producer 0 assigned indices: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
[GPU Rank 3 | Producer 304] Starting.
[GPU Rank 3 | Producer 304] Processing index 17
GPU Rank 1 is assigned 10 samples.
Created queue for GPU Rank 1.
[GPU Rank 1] Producer 0 assigned indices: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]GPU Rank 0 is assigned 11 samples.

[GPU Rank 1 | Producer 305] Starting.
[GPU Rank 1 | Producer 305] Processing index 78
Created queue for GPU Rank 0.
[GPU Rank 0] Producer 0 assigned indices: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
[GPU Rank 0 | Producer 306] Starting.
[GPU Rank 0 | Producer 306] Processing index 38
training starts here
[GPU Rank 2 | Producer 307] Starting.
[GPU Rank 2 | Producer 307] Processing index 0
training starts here
[GPU Rank 3 | Producer 308] Starting.
[GPU Rank 3 | Producer 308] Processing index 0
training starts here
[GPU Rank 1 | Producer 309] Starting.
[GPU Rank 1 | Producer 309] Processing index 0
:::MLLOG {"namespace": "", "time_ms": 1743705085224, "event_type": "POINT_IN_TIME", "key": "len train_dataloader", "value": 21, "metadata": {"file": "/workspace/unet3d/main.py", "lineno": 110}}
:::MLLOG {"namespace": "", "time_ms": 1743705085227, "event_type": "POINT_IN_TIME", "key": "len val_dataloader", "value": 11, "metadata": {"file": "/workspace/unet3d/main.py", "lineno": 111}}
:::MLLOG {"namespace": "", "time_ms": 1743705085228, "event_type": "POINT_IN_TIME", "key": "samples_per_epoch", "value": 168, "metadata": {"file": "/workspace/unet3d/main.py", "lineno": 114}}
[GPU Rank 0 | Producer 310] Starting.
:::MLLOG {"namespace": "", "time_ms": 1743705085228, "event_type": "POINT_IN_TIME", "key": "global_batch_size", "value": 8, "metadata": {"file": "/workspace/unet3d/main.py", "lineno": 118}}
[GPU Rank 0 | Producer 310] Processing index 0
:::MLLOG {"namespace": "", "time_ms": 1743705085229, "event_type": "POINT_IN_TIME", "key": "gradient_accumulation_steps", "value": 1, "metadata": {"file": "/workspace/unet3d/main.py", "lineno": 119}}
training starts here
:::MLLOG {"namespace": "", "time_ms": 1743705085311, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 66, "first_epoch_num": 1, "epoch_count": 1}}
:::MLLOG {"namespace": "", "time_ms": 1743705085311, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 68, "epoch_num": 1}}
Batch processed: 0 for rank: Batch processed:1
 0 for rank: 0
Queue size for GPU 1: 0 samplesQueue size for GPU 0: 0 samples

Batch processed: 0 for rank: 3
Queue size for GPU 3: 0 samples
Batch processed: 0 for rank: 2
Queue size for GPU 2: 0 samples
[GPU Rank 2 | Producer 307] Processing index 1
[GPU Rank 3 | Producer 308] Processing index 1
[GPU Rank 1 | Producer 309] Processing index 1
[GPU Rank 0 | Producer 310] Processing index 1
[GPU Rank 3 | Producer 291] Processing index 153
[GPU Rank 0 | Producer 294] Processing index 6
[GPU Rank 2 | Producer 307] Processing index 2
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 0 | Producer 302] Processing index 114
[GPU Rank 3 | Producer 308] Processing index 2
[GPU Rank 0 | Producer 298] Processing index 76
[GPU Rank 1 | Producer 309] Processing index 2
[GPU Rank 0 | Producer 310] Processing index 2
[GPU Rank 1 | Producer 305] Processing index 112
[GPU Rank 3 | Producer 300] Processing index 94
[GPU Rank 1 | Producer 301] Processing index 167
[GPU Rank 3 | Producer 304] Processing index 88
[GPU Rank 2 | Producer 299] Processing index 83
[GPU Rank 2 | Producer 295] Processing index 107
[GPU Rank 2 | Producer 307] Processing index 3
[GPU Rank 1 | Producer 309] Processing index 3
[GPU Rank 1 | Producer 297] Processing index 16
[GPU Rank 0 | Producer 294] Processing index 43
[GPU Rank 2 | Producer 307] Processing index 4
[GPU Rank 0] Processed batch 1.
[GPU Rank 3 | Producer 308] Processing index 3
[GPU Rank 0 | Producer 310] Processing index 3
[GPU Rank 1 | Producer 293] Processing index 92
[GPU Rank 3 | Producer 304] Processing index 158
[GPU Rank 3 | Producer 296] Processing index 144
[GPU Rank 3] Processed batch 1.
[GPU Rank 0 | Producer 302] Processing index 86
[GPU Rank 3 | Producer 291] Processing index 65
[GPU Rank 2 | Producer 292] Processing index 43
[GPU Rank 1 | Producer 309] Processing index 4
[GPU Rank 1 | Producer 305] Processing index 162
[GPU Rank 1] Processed batch 1.
[GPU Rank 2 | Producer 295] Processing index 22
[GPU Rank 0 | Producer 310] Processing index 4
[GPU Rank 2] Processed batch 1.
[GPU Rank 0 | Producer 298] Processing index 93
[GPU Rank 1 | Producer 297] Processing index 0
[GPU Rank 1 | Producer 309] Processing index 5
[GPU Rank 0 | Producer 302] Processing index 145
[GPU Rank 3 | Producer 300] Processing index 86
[GPU Rank 2 | Producer 303] Processing index 145
[GPU Rank 0 | Producer 306] Processing index 0
[GPU Rank 3 | Producer 308] Processing index 4
[GPU Rank 1 | Producer 309] Processing index 6
[GPU Rank 1 | Producer 293] Processing index 157
[GPU Rank 0 | Producer 310] Processing index 5
[GPU Rank 1 | Producer 301] Processing index 14
[GPU Rank 2 | Producer 299] Processing index 65
[GPU Rank 1 | Producer 305] Processing index 26
[GPU Rank 3 | Producer 300] Processing index 0
[GPU Rank 2 | Producer 307] Processing index 5
loss_value in pytorch [GPU Rank 3 | Producer 296] Processing index 35
[GPU Rank 3 | Producer 291] Processing index 154
[GPU Rank 1 | Producer 297] Processing index 125
[GPU Rank 0 | Producer 310] Processing index 6
[GPU Rank 3 | Producer 308] Processing index 5
[GPU Rank 3 | Producer 304] Processing index 99
[GPU Rank 0 | Producer 306] Processing index 102
loss_value in pytorch tensor(1.1065, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 57
[GPU Rank 0 | Producer 298] Processing index 17
[GPU Rank 2 | Producer 303] Processing index 108
loss_value in pytorch [GPU Rank 1 | Producer 309] Processing index 7
loss_value in pytorch [GPU Rank 2 | Producer 307] Processing index 6
[GPU Rank 0 | Producer 294] Processing index 75
tensor(1.0882, device='cuda:3', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 295] Processing index 164
tensor(1.0933, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 307] Processing index 7
[GPU Rank 1 | Producer 297] Processing index 152
tensor(1.0936, device='cuda:2', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 19
[GPU Rank 1 | Producer 293] Processing index 94
[GPU Rank 1 | Producer 309] Processing index 8
[GPU Rank 0 | Producer 310] Processing index 7
[GPU Rank 2 | Producer 292] Processing index 69
[GPU Rank 2 | Producer 299] Processing index 60
[GPU Rank 0 | Producer 306] Processing index 152
[GPU Rank 0 | Producer 310] Processing index 8
[GPU Rank 3 | Producer 308] Processing index 6
[GPU Rank 1 | Producer 305] Processing index 8
[GPU Rank 2 | Producer 307] Processing index 8
[GPU Rank 0 | Producer 294] Processing index 106
[GPU Rank 2 | Producer 307] Processing index 9
[GPU Rank 0 | Producer 298] Processing index 4
[GPU Rank 3 | Producer 296] Processing index 124
[GPU Rank 1 | Producer 301] Processing index 145
[GPU Rank 2 | Producer 295] Processing index 141
[GPU Rank 2 | Producer 303] Processing index 137
[GPU Rank 3 | Producer 300] Processing index 51
[GPU Rank 2 | Producer 307] Processing index 0
[GPU Rank 3 | Producer 304] Processing index 74
[GPU Rank 3 | Producer 308] Processing index 7
[GPU Rank 1 | Producer 309] Processing index 9
[GPU Rank 2 | Producer 307] Processing index 1
[GPU Rank 0 | Producer 310] Processing index 9
[GPU Rank 1 | Producer 305] Processing index 64
[GPU Rank 3 | Producer 291] Processing index 54
[GPU Rank 1 | Producer 297] Processing index 46
[GPU Rank 2 | Producer 299] Processing index 30
[GPU Rank 3 | Producer 296] Processing index 47
[GPU Rank 1 | Producer 293] Processing index 164
[GPU Rank 2 | Producer 292] Processing index 31
Batch processed: 1 for rank:Batch processed: Batch processed:2
  11  for rank:for rank:  31Queue size for GPU 2: 5 samples


Queue size for GPU 1: 6 samples
Queue size for GPU 3: 7 samples
Batch processed: 1 for rank: 0
Queue size for GPU 0: 6 samples
[GPU Rank 2] Processed batch 2.
[GPU Rank 1] Processed batch 2.
[GPU Rank 3] Processed batch 2.
[GPU Rank 0] Processed batch 2.
[GPU Rank 0 | Producer 306] Processing index 45
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 3 | Producer 300] Processing index 16
[GPU Rank 2 | Producer 307] Processing index 2
[GPU Rank 0 | Producer 310] Processing index 10
[GPU Rank 1 | Producer 309] Processing index 0
[GPU Rank 3 | Producer 308] Processing index 8
[GPU Rank 1 | Producer 301] Processing index 35
[GPU Rank 0 | Producer 302] Processing index 141
tensor(0.9659, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.9598, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.9588, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.9625, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 307] Processing index 3
[GPU Rank 0 | Producer 294] Processing index 72
[GPU Rank 2 | Producer 295] Processing index 129
[GPU Rank 1 | Producer 309] Processing index 1
[GPU Rank 3 | Producer 304] Processing index 23
[GPU Rank 3 | Producer 308] Processing index 9
[GPU Rank 0 | Producer 310] Processing index 0
[GPU Rank 2 | Producer 307] Processing index 4
[GPU Rank 3 | Producer 291] Processing index 106
[GPU Rank 3 | Producer 300] Processing index 43
[GPU Rank 0 | Producer 306] Processing index 63
[GPU Rank 2 | Producer 292] Processing index 125
[GPU Rank 1 | Producer 293] Processing index 77
[GPU Rank 3 | Producer 296] Processing index 137
[GPU Rank 1 | Producer 309] Processing index 2
[GPU Rank 1 | Producer 305] Processing index 55
[GPU Rank 0 | Producer 298] Processing index 74
[GPU Rank 0 | Producer 310] Processing index 1[GPU Rank 1 | Producer 309] Processing index 3

[GPU Rank 3 | Producer 308] Processing index 0
[GPU Rank 2 | Producer 295] Processing index 160
[GPU Rank 0 | Producer 310] Processing index 2
[GPU Rank 3 | Producer 308] Processing index 1
[GPU Rank 2 | Producer 292] Processing index 106
[GPU Rank 1 | Producer 301] Processing index 115
[GPU Rank 2 | Producer 307] Processing index 5
[GPU Rank 2 | Producer 299] Processing index 50
[GPU Rank 0 | Producer 302] Processing index 110
[GPU Rank 1 | Producer 297] Processing index 140
Batch processed: 2Batch processed: for rank:  Batch processed:02 
Batch processed:for rank:  23  
for rank: 2Queue size for GPU 0: 7 samples1 

for rank: 2
Queue size for GPU 1: 8 samples
Queue size for GPU 3: 8 samples
Queue size for GPU 2: 6 samples
[GPU Rank 3] Processed batch 3.
[GPU Rank 1] Processed batch 3.
[GPU Rank 0] Processed batch 3.
[GPU Rank 2] Processed batch 3.
loss_value in pytorch [GPU Rank 1 | Producer 305] Processing index 133
loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 1 | Producer 309] Processing index 4
[GPU Rank 0 | Producer 306] Processing index 46
[GPU Rank 2 | Producer 303] Processing index 87
[GPU Rank 3 | Producer 308] Processing index 2
[GPU Rank 1 | Producer 309] Processing index 5
[GPU Rank 0 | Producer 310] Processing index 3
[GPU Rank 0 | Producer 298] Processing index 111
tensor(0.8250, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.8262, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.8243, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.8320, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 291] Processing index 146
[GPU Rank 2 | Producer 307] Processing index 6
[GPU Rank 2 | Producer 295] Processing index 143
[GPU Rank 3 | Producer 304] Processing index 131
[GPU Rank 1 | Producer 293] Processing index 150
[GPU Rank 1 | Producer 297] Processing index 42
[GPU Rank 1 | Producer 309] Processing index 6
[GPU Rank 0 | Producer 294] Processing index 166
[GPU Rank 0 | Producer 302] Processing index 65
[GPU Rank 2 | Producer 307] Processing index 7
[GPU Rank 2 | Producer 299] Processing index 103
[GPU Rank 0 | Producer 310] Processing index 4
[GPU Rank 3 | Producer 308] Processing index 3
[GPU Rank 2 | Producer 303] Processing index 136
[GPU Rank 2 | Producer 307] Processing index 8
[GPU Rank 2 | Producer 307] Processing index 9
[GPU Rank 3 | Producer 300] Processing index 8
[GPU Rank 1 | Producer 309] Processing index 7
[GPU Rank 0 | Producer 310] Processing index 5
[GPU Rank 2 | Producer 299] Processing index 156
[GPU Rank 2 | Producer 292] Processing index 152
[GPU Rank 1 | Producer 297] Processing index 23
[GPU Rank 0 | Producer 310] Processing index 6
[GPU Rank 2 | Producer 307] Processing index 0
[GPU Rank 1 | Producer 301] Processing index 63
[GPU Rank 1 | Producer 309] Processing index 8
[GPU Rank 3 | Producer 291] Processing index 46
[GPU Rank 3 | Producer 308] Processing index 4
Batch processed:Batch processed:  33  Batch processed:for rank:for rank:  31 

3 for rank: 2
Queue size for GPU 1: 10 samplesQueue size for GPU 3: 10 samples

Batch processed: Queue size for GPU 2: 8 samples
3 for rank: 0
Queue size for GPU 0: 9 samples
[GPU Rank 3 | Producer 296] Processing index 82
[GPU Rank 2] Processed batch 4.
[GPU Rank 0] Processed batch 4.
[GPU Rank 3] Processed batch 4.
[GPU Rank 1] Processed batch 4.
[GPU Rank 3 | Producer 300] Processing index 29
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 298] Processing index 62
[GPU Rank 0 | Producer 302] Processing index 97
[GPU Rank 2 | Producer 295] Processing index 114
[GPU Rank 0 | Producer 306] Processing index 121
[GPU Rank 2 | Producer 303] Processing index 113
[GPU Rank 0 | Producer 310] Processing index 7
[GPU Rank 0 | Producer 310] Processing index 8
tensor(0.7224, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.7180, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.7126, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.7127, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 293] Processing index 128
[GPU Rank 0 | Producer 294] Processing index 55
[GPU Rank 3 | Producer 304] Processing index 52
[GPU Rank 1 | Producer 309] Processing index 9
[GPU Rank 2 | Producer 292] Processing index 35
[GPU Rank 3 | Producer 308] Processing index 5
[GPU Rank 1 | Producer 301] Processing index 143
[GPU Rank 0 | Producer 302] Processing index 101
[GPU Rank 3 | Producer 308] Processing index 6
[GPU Rank 1 | Producer 305] Processing index 110
[GPU Rank 2 | Producer 303] Processing index 74
[GPU Rank 2 | Producer 299] Processing index 9
[GPU Rank 2 | Producer 295] Processing index 41
[GPU Rank 0 | Producer 306] Processing index 14
[GPU Rank 1 | Producer 297] Processing index 127
[GPU Rank 1 | Producer 309] Processing index 0
[GPU Rank 0 | Producer 310] Processing index 9
[GPU Rank 0 | Producer 294] Processing index 134
[GPU Rank 3 | Producer 300] Processing index 3
[GPU Rank 3 | Producer 304] Processing index 32
[GPU Rank 3 | Producer 296] Processing index 60
[GPU Rank 3 | Producer 291] Processing index 11
[GPU Rank 3 | Producer 308] Processing index 7
Batch processed:Batch processed:  44  for rank:for rank:  30

Queue size for GPU 0: 11 samplesQueue size for GPU 3: 13 samples

Batch processed: 4 for rank: 2
Queue size for GPU 2: 10 samples
Batch processed: 4 for rank: 1
Queue size for GPU 1: 10 samples
[GPU Rank 0] Processed batch 5.
[GPU Rank 3] Processed batch 5.
[GPU Rank 2] Processed batch 5.
[GPU Rank 1 | Producer 305] Processing index 146
[GPU Rank 1] Processed batch 5.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 298] Processing index 165
[GPU Rank 2 | Producer 292] Processing index 138
[GPU Rank 2 | Producer 295] Processing index 63
[GPU Rank 1 | Producer 297] Processing index 136
[GPU Rank 0 | Producer 294] Processing index 59
[GPU Rank 2 | Producer 303] Processing index 20
[GPU Rank 0 | Producer 302] Processing index 68
[GPU Rank 1 | Producer 301] Processing index 19
[GPU Rank 3 | Producer 300] Processing index 94
tensor(0.6631, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.6426, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.6441, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.6427, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 308] Processing index 8
[GPU Rank 3 | Producer 304] Processing index 161
[GPU Rank 2 | Producer 299] Processing index 26
[GPU Rank 3 | Producer 296] Processing index 126
[GPU Rank 1 | Producer 293] Processing index 122
[GPU Rank 3 | Producer 291] Processing index 136
[GPU Rank 3 | Producer 308] Processing index 9
[GPU Rank 1 | Producer 305] Processing index 78
[GPU Rank 0 | Producer 302] Processing index 114
[GPU Rank 0 | Producer 306] Processing index 80
[GPU Rank 1 | Producer 301] Processing index 141
[GPU Rank 2 | Producer 295] Processing index 107
[GPU Rank 0 | Producer 294] Processing index 8
[GPU Rank 1 | Producer 297] Processing index 16
[GPU Rank 0 | Producer 298] Processing index 28
[GPU Rank 2 | Producer 292] Processing index 99
[GPU Rank 1 | Producer 293] Processing index 120
[GPU Rank 3 | Producer 308] Processing index 0
[GPU Rank 3 | Producer 300] Processing index 86
[GPU Rank 3 | Producer 296] Processing index 87
[GPU Rank 3 | Producer 304] Processing index 17
Batch processed: 5 for rank: 0
Queue size for GPU 0: 13 samples
Batch processed: 5 for rank: 1
Batch processed:Queue size for GPU 1: 13 samples
 5 for rank: 3
Queue size for GPU 3: 15 samples
Batch processed: 5 for rank: 2
Queue size for GPU 2: 12 samples
[GPU Rank 1 | Producer 305] Processing index 112
[GPU Rank 1] Processed batch 6.
[GPU Rank 3] Processed batch 6.
[GPU Rank 2] Processed batch 6.
[GPU Rank 0] Processed batch 6.
loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 3 | Producer 291] Processing index 90
loss_value in pytorch [GPU Rank 0 | Producer 294] Processing index 6
[GPU Rank 2 | Producer 299] Processing index 104
[GPU Rank 0 | Producer 302] Processing index 86
[GPU Rank 1 | Producer 297] Processing index 0
[GPU Rank 3 | Producer 300] Processing index 0
[GPU Rank 0 | Producer 306] Processing index 38
[GPU Rank 2 | Producer 295] Processing index 22
tensor(0.5970, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5956, device='cuda:3', grad_fn=<DivBackward0>)tensor(0.5887, device='cuda:1', grad_fn=<DivBackward0>)

tensor(0.5987, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 293] Processing index 158
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 3 | Producer 291] Processing index 153
[GPU Rank 0 | Producer 302] Processing index 145
[GPU Rank 1 | Producer 301] Processing index 56
[GPU Rank 0 | Producer 294] Processing index 43
[GPU Rank 3 | Producer 304] Processing index 88
[GPU Rank 1 | Producer 305] Processing index 162
[GPU Rank 2 | Producer 303] Processing index 49
[GPU Rank 2 | Producer 292] Processing index 72
[GPU Rank 1 | Producer 297] Processing index 125
[GPU Rank 3 | Producer 300] Processing index 19
[GPU Rank 2 | Producer 299] Processing index 83
[GPU Rank 3 | Producer 304] Processing index 158
[GPU Rank 3 | Producer 296] Processing index 144
[GPU Rank 0 | Producer 298] Processing index 151
[GPU Rank 1 | Producer 301] Processing index 167
[GPU Rank 1 | Producer 305] Processing index 26
[GPU Rank 1 | Producer 297] Processing index 152
[GPU Rank 0 | Producer 302] Processing index 57
[GPU Rank 3 | Producer 291] Processing index 65
Batch processed:Batch processed: 6  for rank:6  1for rank:
 2
Queue size for GPU 1: 17 samples
Queue size for GPU 2: 14 samples
Batch processed: 6 for rank: 0
Batch processed: 6 Queue size for GPU 0: 17 samplesfor rank:
 3
Queue size for GPU 3: 19 samples
[GPU Rank 2] Processed batch 7.
[GPU Rank 1] Processed batch 7.
[GPU Rank 0] Processed batch 7.
[GPU Rank 3] Processed batch 7.
[GPU Rank 3 | Producer 300] Processing index 51
[GPU Rank 2 | Producer 295] Processing index 164
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 1 | Producer 293] Processing index 92
tensor(0.5720, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.6063, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.5625, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5563, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 298] Processing index 76
[GPU Rank 0 | Producer 306] Processing index 0
[GPU Rank 3 | Producer 300] Processing index 16
[GPU Rank 3 | Producer 296] Processing index 35
[GPU Rank 2 | Producer 303] Processing index 38
[GPU Rank 2 | Producer 299] Processing index 65
[GPU Rank 1 | Producer 297] Processing index 46
[GPU Rank 2 | Producer 295] Processing index 141
[GPU Rank 0 | Producer 294] Processing index 75
[GPU Rank 2 | Producer 292] Processing index 43
[GPU Rank 1 | Producer 293] Processing index 157
[GPU Rank 1 | Producer 305] Processing index 8
[GPU Rank 3 | Producer 304] Processing index 99
[GPU Rank 3 | Producer 291] Processing index 154
[GPU Rank 1 | Producer 301] Processing index 14
[GPU Rank 3 | Producer 300] Processing index 43
[GPU Rank 0 | Producer 306] Processing index 102
[GPU Rank 0 | Producer 294] Processing index 106
[GPU Rank 0 | Producer 298] Processing index 93
[GPU Rank 1 | Producer 305] Processing index 64
Batch processed:Batch processed:  Batch processed:77   for rank:for rank:7   12for rank:

 0
Queue size for GPU 1: 19 samplesQueue size for GPU 2: 16 samples

Queue size for GPU 0: 19 samples
Batch processed: 7 for rank: 3
Queue size for GPU 3: 19 samples
[GPU Rank 1] Processed batch 8.
[GPU Rank 2] Processed batch 8.
[GPU Rank 0] Processed batch 8.
[GPU Rank 3] Processed batch 8.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 3 | Producer 296] Processing index 124
[GPU Rank 0 | Producer 302] Processing index 141
[GPU Rank 2 | Producer 299] Processing index 60
[GPU Rank 2 | Producer 295] Processing index 129
[GPU Rank 0 | Producer 306] Processing index 152
[GPU Rank 1 | Producer 293] Processing index 94
tensor(0.7100, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5718, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.5430, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5684, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 47
[GPU Rank 3 | Producer 304] Processing index 74
[GPU Rank 0 | Producer 298] Processing index 17
[GPU Rank 1 | Producer 297] Processing index 140
[GPU Rank 1 | Producer 305] Processing index 55
[GPU Rank 2 | Producer 303] Processing index 145
[GPU Rank 0 | Producer 294] Processing index 72
[GPU Rank 2 | Producer 292] Processing index 69
[GPU Rank 1 | Producer 301] Processing index 145
[GPU Rank 2 | Producer 295] Processing index 160
[GPU Rank 2 | Producer 299] Processing index 30
[GPU Rank 0 | Producer 302] Processing index 110
[GPU Rank 0 | Producer 306] Processing index 45
[GPU Rank 1 | Producer 297] Processing index 42
[GPU Rank 3 | Producer 304] Processing index 23
Batch processed: 8 for rank: 0Batch processed:
 8 for rank: 3
Queue size for GPU 3: 20 samplesQueue size for GPU 0: 20 samples

Batch processed: 8 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 8 for rank: 2
Queue size for GPU 2: 18 samples
[GPU Rank 0 | Producer 298] Processing index 4
[GPU Rank 3 | Producer 291] Processing index 54[GPU Rank 1 | Producer 293] Processing index 164

[GPU Rank 0] Processed batch 9.
[GPU Rank 1] Processed batch 9.
[GPU Rank 2] Processed batch 9.
[GPU Rank 3] Processed batch 9.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 1 | Producer 305] Processing index 133
[GPU Rank 2 | Producer 295] Processing index 143
[GPU Rank 2 | Producer 303] Processing index 108
[GPU Rank 0 | Producer 302] Processing index 65
[GPU Rank 2 | Producer 292] Processing index 31
[GPU Rank 0 | Producer 306] Processing index 63
tensor(0.6166, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5606, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.6319, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.6070, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 293] Processing index 77
[GPU Rank 3 | Producer 291] Processing index 106
[GPU Rank 2 | Producer 292] Processing index 125
[GPU Rank 2 | Producer 299] Processing index 50
[GPU Rank 2 | Producer 303] Processing index 137
[GPU Rank 2 | Producer 295] Processing index 114
[GPU Rank 2 | Producer 292] Processing index 106
Batch processed: 9 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 9 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 9 for rank: 3
Batch processed: 9 for rank: 2
Queue size for GPU 3: 20 samples
Queue size for GPU 2: 20 samples
[GPU Rank 0 | Producer 294] Processing index 166
[GPU Rank 1 | Producer 301] Processing index 35[GPU Rank 3 | Producer 300] Processing index 8
[GPU Rank 0] Processed batch 10.
[GPU Rank 1] Processed batch 10.

[GPU Rank 3] Processed batch 10.
[GPU Rank 2] Processed batch 10.
[GPU Rank 0 | Producer 298] Processing index 74
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 299] Processing index 103
tensor(0.5463, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.6066, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5266, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5605, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 295] Processing index 41
[GPU Rank 3 | Producer 300] Processing index 29
[GPU Rank 2 | Producer 299] Processing index 156
[GPU Rank 1 | Producer 301] Processing index 115
[GPU Rank 0 | Producer 294] Processing index 55
Batch processed: 10 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 10 for rank: 1
Batch processed: Queue size for GPU 1: 20 samples
10 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 10 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 0 | Producer 306] Processing index 46
[GPU Rank 1 | Producer 293] Processing index 150[GPU Rank 2 | Producer 292] Processing index 152
[GPU Rank 3 | Producer 304] Processing index 131

[GPU Rank 3] Processed batch 11.
[GPU Rank 0] Processed batch 11.
[GPU Rank 2] Processed batch 11.
[GPU Rank 1] Processed batch 11.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.6017, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5379, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.6424, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.5422, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 292] Processing index 35
[GPU Rank 1 | Producer 293] Processing index 128
[GPU Rank 0 | Producer 306] Processing index 121
[GPU Rank 3 | Producer 304] Processing index 52
Batch processed: 11 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 11 for rank:Batch processed: 2 Batch processed:
11  for rank: 3Queue size for GPU 2: 20 samples
11
 for rank: 1Queue size for GPU 3: 20 samples

Queue size for GPU 1: 20 samples
[GPU Rank 0 | Producer 294] Processing index 134[GPU Rank 2 | Producer 295] Processing index 63
[GPU Rank 1 | Producer 297] Processing index 23[GPU Rank 3 | Producer 296] Processing index 137


[GPU Rank 3] Processed batch 12.
[GPU Rank 2] Processed batch 12.
[GPU Rank 1] Processed batch 12.
[GPU Rank 0] Processed batch 12.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.5205, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.6231, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5172, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.5670, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 294] Processing index 59
[GPU Rank 2 | Producer 295] Processing index 107
[GPU Rank 1 | Producer 297] Processing index 127
Batch processed: 12 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed:Batch processed:Batch processed:   121212   for rank:for rank:for rank:   031


Queue size for GPU 1: 20 samples
Queue size for GPU 3: 20 samples
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 292] Processing index 138
[GPU Rank 1 | Producer 305] Processing index 110
[GPU Rank 0 | Producer 302] Processing index 97[GPU Rank 3 | Producer 291] Processing index 146

[GPU Rank 2] Processed batch 13.
[GPU Rank 0] Processed batch 13.
[GPU Rank 3] Processed batch 13.
[GPU Rank 1] Processed batch 13.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.5432, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5464, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5502, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4992, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 82
[GPU Rank 1 | Producer 305] Processing index 146
[GPU Rank 0 | Producer 302] Processing index 101
[GPU Rank 3 | Producer 291] Processing index 46
[GPU Rank 2 | Producer 292] Processing index 99
Batch processed: 13 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 13 for rank: 0
Batch processed:Queue size for GPU 0: 20 samples
 13 for rank: 3
Batch processed:[GPU Rank 2 | Producer 295] Processing index 22 Queue size for GPU 3: 20 samples13 
for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 0 | Producer 294] Processing index 8
[GPU Rank 3 | Producer 300] Processing index 3

[GPU Rank 1 | Producer 293] Processing index 122
[GPU Rank 2] Processed batch 14.
[GPU Rank 0] Processed batch 14.
[GPU Rank 1] Processed batch 14.
[GPU Rank 3] Processed batch 14.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.5951, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5449, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5183, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.5837, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 294] Processing index 6
[GPU Rank 1 | Producer 293] Processing index 120
[GPU Rank 3 | Producer 300] Processing index 94
[GPU Rank 2 | Producer 295] Processing index 164
Batch processed: 14 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 14 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 14 for rank: 3
Batch processed: 14 Queue size for GPU 3: 20 samplesfor rank: 
1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 292] Processing index 72[GPU Rank 0 | Producer 302] Processing index 68

[GPU Rank 1 | Producer 305] Processing index 78
[GPU Rank 3 | Producer 296] Processing index 60
[GPU Rank 0] Processed batch 15.
[GPU Rank 3] Processed batch 15.
[GPU Rank 2] Processed batch 15.
[GPU Rank 1] Processed batch 15.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.5364, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5186, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5197, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.5542, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 114
[GPU Rank 1 | Producer 305] Processing index 112
[GPU Rank 3 | Producer 296] Processing index 126
[GPU Rank 2 | Producer 292] Processing index 43
Batch processed: 15 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 15 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: Batch processed:15  for rank: 151
 for rank: 3
Queue size for GPU 1: 20 samples
Queue size for GPU 3: 20 samples
[GPU Rank 0 | Producer 302] Processing index 86[GPU Rank 2 | Producer 303] Processing index 87
[GPU Rank 1 | Producer 293] Processing index 158

[GPU Rank 3 | Producer 300] Processing index 86
[GPU Rank 0] Processed batch 16.
[GPU Rank 1] Processed batch 16.
[GPU Rank 2] Processed batch 16.
[GPU Rank 3] Processed batch 16.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 3 | Producer 300] Processing index 0
[GPU Rank 0 | Producer 302] Processing index 145
tensor(0.5426, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5963, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.5279, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.6866, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 303] Processing index 136
[GPU Rank 1 | Producer 293] Processing index 92
Batch processed: 16 for rank:Batch processed: 0
 16Batch processed: for rank:Batch processed:  116 
 for rank:Queue size for GPU 0: 20 samples 
316
 for rank: 2
Queue size for GPU 3: 20 samples
Queue size for GPU 1: 20 samples
Queue size for GPU 2: 20 samples
[GPU Rank 2 | Producer 292] Processing index 69
[GPU Rank 3 | Producer 296] Processing index 87
[GPU Rank 1 | Producer 305] Processing index 162
[GPU Rank 0 | Producer 306] Processing index 14
[GPU Rank 2] Processed batch 17.
[GPU Rank 3] Processed batch 17.
[GPU Rank 0] Processed batch 17.
[GPU Rank 1] Processed batch 17.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.6925, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5034, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5549, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.5417, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 1 | Producer 305] Processing index 26
[GPU Rank 2 | Producer 292] Processing index 31
[GPU Rank 0 | Producer 306] Processing index 80
Batch processed: 17 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 17 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 17 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 17 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 299] Processing index 9
[GPU Rank 3 | Producer 296] Processing index 144
[GPU Rank 0] Processed batch 18.
[GPU Rank 1 | Producer 297] Processing index 136
[GPU Rank 1] Processed batch 18.
[GPU Rank 2] Processed batch 18.
[GPU Rank 3] Processed batch 18.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.5127, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.5403, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.5888, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5395, device='cuda:2', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 298] Processing index 111
[GPU Rank 3 | Producer 296] Processing index 35
[GPU Rank 1 | Producer 297] Processing index 16
[GPU Rank 2 | Producer 299] Processing index 26
Batch processed:Batch processed: Batch processed: 18  18for rank:  182for rank: 
 for rank:0 1

Queue size for GPU 2: 20 samples
Queue size for GPU 1: 20 samples
Queue size for GPU 0: 20 samples
Batch processed: 18 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 1 | Producer 305] Processing index 8
[GPU Rank 2 | Producer 292] Processing index 125[GPU Rank 0 | Producer 306] Processing index 38[GPU Rank 3 | Producer 304] Processing index 32


[GPU Rank 2] Processed batch 19.
[GPU Rank 0] Processed batch 19.
[GPU Rank 1] Processed batch 19.
[GPU Rank 3] Processed batch 19.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 298] Processing index 62
tensor(0.5143, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.5206, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5550, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.5356, device='cuda:2', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 64
[GPU Rank 2 | Producer 292] Processing index 106
[GPU Rank 3 | Producer 304] Processing index 161
Batch processed: 19 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 19 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 19 for rank:Batch processed: 3
 19 for rank: 1
Queue size for GPU 3: 20 samples
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 303] Processing index 113
[GPU Rank 3 | Producer 296] Processing index 124
[GPU Rank 1 | Producer 293] Processing index 157[GPU Rank 0] Processed batch 20.

[GPU Rank 3] Processed batch 20.
[GPU Rank 2] Processed batch 20.
[GPU Rank 1] Processed batch 20.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 306] Processing index 0
[GPU Rank 0 | Producer 298] Processing index 165
tensor(0.5269, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5226, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.5176, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 47
tensor(0.5555, device='cuda:2', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 303] Processing index 74
[GPU Rank 0 | Producer 298] Processing index 28
[GPU Rank 1 | Producer 293] Processing index 94
Batch processed: 20 for rank: 0Batch processed:
 20Queue size for GPU 0: 20 samples 
for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 20 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 20 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 0 | Producer 294] Processing index 43
[GPU Rank 3 | Producer 304] Processing index 17
[GPU Rank 1 | Producer 305] Processing index 55[GPU Rank 2 | Producer 292] Processing index 152

[GPU Rank 2] Processed batch 21.
[GPU Rank 3] Processed batch 21.
[GPU Rank 1] Processed batch 21.
[GPU Rank 0] Processed batch 21.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.5846, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5402, device='cuda:1', grad_fn=<DivBackward0>)tensor(0.5343, device='cuda:3', grad_fn=<DivBackward0>)

tensor(0.5274, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 133
[GPU Rank 3 | Producer 304] Processing index 88
[GPU Rank 2 | Producer 292] Processing index 35
Batch processed: Batch processed: 21 for rank: 210 Batch processed:for rank:
 2 
21RAISE StopIterationRAISE StopIteration 

for rank: 3
Batch processed: RAISE StopIteration
21 for rank: 1
RAISE StopIteration
Batch processed: 0 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 2 | Producer 295] Processing index 141
Batch processed: 0 for rank: 3
Queue size for GPU 3: 20 samplesBatch processed:
 0 for rank: 1
:::MLLOG {"namespace": "", "time_ms": 1743705102888, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 106, "epoch_num": 1, "current_lr": 0.08009000000000001}}
Queue size for GPU 1: 20 samples
[GPU Rank 1 | Producer 297] Processing index 0
:::MLLOG {"namespace": "", "time_ms": 1743705102889, "event_type": "INTERVAL_END", "key": "block_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 135, "first_epoch_num": 1, "epoch_count": 1}}
[GPU Rank 3 | Producer 296] Processing index 137
:::MLLOG {"namespace": "", "time_ms": 1743705102890, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 66, "first_epoch_num": 2, "epoch_count": 1}}
:::MLLOG {"namespace": "", "time_ms": 1743705102890, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 68, "epoch_num": 2}}
[GPU Rank 2] Processed batch 1.
Batch processed: 0 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3] Processed batch 1.
[GPU Rank 1] Processed batch 1.
[GPU Rank 0 | Producer 298] Processing index 151
[GPU Rank 0] Processed batch 1.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 294] Processing index 75
tensor(0.5256, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5040, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.5591, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5054, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 298] Processing index 76
[GPU Rank 1 | Producer 297] Processing index 125
[GPU Rank 2 | Producer 295] Processing index 129
Batch processed: 1Batch processed: for rank:  01
 for rank: 2
Queue size for GPU 0: 20 samples
Queue size for GPU 2: 20 samples
Batch processed: 1 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 1 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 292] Processing index 138
[GPU Rank 0 | Producer 294] Processing index 106
[GPU Rank 1 | Producer 305] Processing index 110
[GPU Rank 3 | Producer 304] Processing index 158
[GPU Rank 0] Processed batch 2.
[GPU Rank 2] Processed batch 2.
[GPU Rank 1] Processed batch 2.
[GPU Rank 3] Processed batch 2.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.5032, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.5229, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5856, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5553, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 82
[GPU Rank 1 | Producer 305] Processing index 146
[GPU Rank 2 | Producer 292] Processing index 99
[GPU Rank 0 | Producer 294] Processing index 72
[GPU Rank 3 | Producer 304] Processing index 99
Batch processed: Batch processed:2  for rank:2  3for rank:
 0
Queue size for GPU 3: 20 samples
Queue size for GPU 0: 20 samples
Batch processed: 2 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 2 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 0 | Producer 298] Processing index 93
[GPU Rank 2 | Producer 303] Processing index 20
[GPU Rank 1 | Producer 297] Processing index 152
[GPU Rank 2] Processed batch 3.
[GPU Rank 0] Processed batch 3.
[GPU Rank 1] Processed batch 3.
[GPU Rank 3] Processed batch 3.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 3 | Producer 296] Processing index 60
tensor(0.5306, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5060, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.5230, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5667, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 298] Processing index 17
[GPU Rank 1 | Producer 297] Processing index 46
[GPU Rank 3 | Producer 296] Processing index 126
Batch processed: 3 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 3 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 3 for rank: 3
Queue size for GPU 3: 20 samplesBatch processed:
 3 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 292] Processing index 72
[GPU Rank 0 | Producer 306] Processing index 102
[GPU Rank 1 | Producer 305] Processing index 78[GPU Rank 3 | Producer 291] Processing index 11

[GPU Rank 2] Processed batch 4.
[GPU Rank 0] Processed batch 4.
[GPU Rank 1] Processed batch 4.
[GPU Rank 3] Processed batch 4.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 303] Processing index 49
tensor(0.5366, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5418, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5184, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.5343, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 112
[GPU Rank 0 | Producer 306] Processing index 152
[GPU Rank 3 | Producer 291] Processing index 136
[GPU Rank 2 | Producer 292] Processing index 43
Batch processed: 4 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 4 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 4 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 4 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 0 | Producer 298] Processing index 4[GPU Rank 2 | Producer 295] Processing index 160[GPU Rank 1 | Producer 301] Processing index 63
[GPU Rank 3 | Producer 296] Processing index 87


[GPU Rank 2] Processed batch 5.
[GPU Rank 3] Processed batch 5.
[GPU Rank 1] Processed batch 5.
[GPU Rank 0] Processed batch 5.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.5853, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5488, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5327, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.6079, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 2 | Producer 295] Processing index 143
[GPU Rank 1 | Producer 301] Processing index 143
[GPU Rank 0 | Producer 298] Processing index 74
Batch processed: 5 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 5 for rank: 1
Batch processed:Queue size for GPU 1: 20 samples
 5 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 5 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 0 | Producer 306] Processing index 45
[GPU Rank 2 | Producer 303] Processing index 38
[GPU Rank 3 | Producer 291] Processing index 90
[GPU Rank 0] Processed batch 6.
[GPU Rank 1 | Producer 305] Processing index 162[GPU Rank 3] Processed batch 6.

[GPU Rank 2] Processed batch 6.
[GPU Rank 1] Processed batch 6.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.5398, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5946, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5337, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.5626, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 291] Processing index 153
[GPU Rank 1 | Producer 305] Processing index 26
[GPU Rank 0 | Producer 306] Processing index 63
Batch processed: 6 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 6 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed:Batch processed:  6[GPU Rank 2 | Producer 292] Processing index 696  
for rank:for rank:  31

Queue size for GPU 3: 20 samples
Queue size for GPU 1: 20 samples
[GPU Rank 0 | Producer 298] Processing index 111
[GPU Rank 3 | Producer 296] Processing index 144[GPU Rank 1 | Producer 301] Processing index 19

[GPU Rank 0] Processed batch 7.
[GPU Rank 1] Processed batch 7.
[GPU Rank 3] Processed batch 7.
[GPU Rank 2] Processed batch 7.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 303] Processing index 145
tensor(0.4904, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5474, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.5151, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.5523, device='cuda:2', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 301] Processing index 141
[GPU Rank 2 | Producer 292] Processing index 31
[GPU Rank 3 | Producer 296] Processing index 35
[GPU Rank 0 | Producer 298] Processing index 62
Batch processed: 7 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 7 for rank: 0
Queue size for GPU 0: 20 samplesBatch processed:
 7 for rank: 3
Batch processed: 7 for rank: 1
Queue size for GPU 3: 20 samples
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 303] Processing index 108[GPU Rank 0 | Producer 306] Processing index 46
[GPU Rank 1 | Producer 305] Processing index 8

[GPU Rank 3 | Producer 291] Processing index 65
[GPU Rank 2] Processed batch 8.
[GPU Rank 1] Processed batch 8.
[GPU Rank 0] Processed batch 8.
[GPU Rank 3] Processed batch 8.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.6018, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.6325, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5771, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.4998, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 64
[GPU Rank 2 | Producer 303] Processing index 137
[GPU Rank 3 | Producer 291] Processing index 154
[GPU Rank 0 | Producer 306] Processing index 121
Batch processed:Batch processed: 8 for rank: 2
 8 for rank: 0
Queue size for GPU 2: 20 samples
Queue size for GPU 0: 20 samples
Batch processed: Batch processed:8  for rank:8 1 
for rank: 3
Queue size for GPU 1: 20 samples
Queue size for GPU 3: 20 samples
[GPU Rank 2 | Producer 292] Processing index 125[GPU Rank 0 | Producer 298] Processing index 165[GPU Rank 1 | Producer 301] Processing index 56


[GPU Rank 3 | Producer 296] Processing index 124
[GPU Rank 0] Processed batch 9.
[GPU Rank 2] Processed batch 9.
[GPU Rank 3] Processed batch 9.
[GPU Rank 1] Processed batch 9.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.5834, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5209, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.6107, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.5415, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 292] Processing index 106
[GPU Rank 3 | Producer 296] Processing index 47
[GPU Rank 1 | Producer 301] Processing index 167
[GPU Rank 0 | Producer 298] Processing index 28
Batch processed: 9 for rank: 0
Batch processed:Queue size for GPU 0: 20 samples 
9 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed:Batch processed:  99  for rank:for rank:  13

Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

[GPU Rank 2 | Producer 303] Processing index 87
[GPU Rank 1 | Producer 305] Processing index 55
[GPU Rank 0 | Producer 302] Processing index 57
[GPU Rank 3 | Producer 300] Processing index 19
[GPU Rank 0] Processed batch 10.
[GPU Rank 3] Processed batch 10.
[GPU Rank 1] Processed batch 10.
[GPU Rank 2] Processed batch 10.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.5150, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.5318, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4940, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5238, device='cuda:2', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 133
[GPU Rank 3 | Producer 300] Processing index 51
[GPU Rank 2 | Producer 303] Processing index 136
Batch processed: 10 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 10 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 10 for rank: 3
Batch processed: Queue size for GPU 3: 20 samples10
 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 0 | Producer 298] Processing index 151
[GPU Rank 2 | Producer 299] Processing index 104
[GPU Rank 3 | Producer 296] Processing index 137
[GPU Rank 1 | Producer 293] Processing index 164[GPU Rank 0] Processed batch 11.

[GPU Rank 2] Processed batch 11.
[GPU Rank 1] Processed batch 11.
[GPU Rank 3] Processed batch 11.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 141
tensor(0.5279, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5393, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.5070, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5087, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 293] Processing index 77
[GPU Rank 2 | Producer 299] Processing index 83
[GPU Rank 0 | Producer 298] Processing index 76
Batch processed: 11 for rank: 0
Queue size for GPU 0: 20 samplesBatch processed:
 11 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 11 for rank: 1
Batch processed: 11 for rank: 3
Queue size for GPU 1: 20 samples
Queue size for GPU 3: 20 samples
[GPU Rank 2 | Producer 303] Processing index 113[GPU Rank 1 | Producer 305] Processing index 110

[GPU Rank 0 | Producer 306] Processing index 14
[GPU Rank 3 | Producer 304] Processing index 74
[GPU Rank 0] Processed batch 12.
[GPU Rank 2] Processed batch 12.
[GPU Rank 3] Processed batch 12.
[GPU Rank 1] Processed batch 12.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.5050, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5602, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5371, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4962, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 82
[GPU Rank 1 | Producer 305] Processing index 146
[GPU Rank 2 | Producer 303] Processing index 74
[GPU Rank 3 | Producer 304] Processing index 23
[GPU Rank 0 | Producer 306] Processing index 80
Batch processed: 12 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 12 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 12 for rank: Batch processed:1
 12 for rank: 3
Queue size for GPU 1: 20 samples
Queue size for GPU 3: 20 samples
[GPU Rank 0 | Producer 302] Processing index 110[GPU Rank 2 | Producer 292] Processing index 152
[GPU Rank 1 | Producer 301] Processing index 14

[GPU Rank 3 | Producer 300] Processing index 16[GPU Rank 0] Processed batch 13.

[GPU Rank 2] Processed batch 13.
[GPU Rank 3] Processed batch 13.
[GPU Rank 1] Processed batch 13.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.5325, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5433, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.4975, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.4959, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 65
[GPU Rank 3 | Producer 300] Processing index 43
[GPU Rank 2 | Producer 292] Processing index 35
[GPU Rank 1 | Producer 301] Processing index 145
Batch processed: Batch processed:13 for rank: 2
 Queue size for GPU 2: 20 samples13
 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 13 for rank: 3
Batch processed: 13 for rank:Queue size for GPU 3: 20 samples 
1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 303] Processing index 20
[GPU Rank 0 | Producer 294] Processing index 166
[GPU Rank 3 | Producer 296] Processing index 60
[GPU Rank 1 | Producer 305] Processing index 78
[GPU Rank 2] Processed batch 14.
[GPU Rank 0] Processed batch 14.
[GPU Rank 3] Processed batch 14.
[GPU Rank 1] Processed batch 14.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.5217, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5160, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5966, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.6278, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 112
[GPU Rank 3 | Producer 296] Processing index 126
[GPU Rank 0 | Producer 294] Processing index 55
Batch processed: 14 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 14 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 14 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 14 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 295] Processing index 114
[GPU Rank 0 | Producer 302] Processing index 97[GPU Rank 3 | Producer 300] Processing index 8
[GPU Rank 1 | Producer 297] Processing index 140

[GPU Rank 2] Processed batch 15.
[GPU Rank 0] Processed batch 15.
[GPU Rank 3] Processed batch 15.
[GPU Rank 1] Processed batch 15.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 303] Processing index 49
tensor(0.5253, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.6089, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5049, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.4705, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 101
[GPU Rank 3 | Producer 300] Processing index 29
[GPU Rank 1 | Producer 297] Processing index 42
[GPU Rank 2 | Producer 295] Processing index 41
Batch processed: 15 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 15 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 15 for rank: 3
Queue size for GPU 3: 20 samplesBatch processed:
 15 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 0 | Producer 294] Processing index 134
[GPU Rank 2 | Producer 303] Processing index 38[GPU Rank 1 | Producer 305] Processing index 162
[GPU Rank 3 | Producer 296] Processing index 87

[GPU Rank 0] Processed batch 16.
[GPU Rank 2] Processed batch 16.
[GPU Rank 3] Processed batch 16.
[GPU Rank 1] Processed batch 16.
loss_value in pytorchloss_value in pytorch  loss_value in pytorch loss_value in pytorch tensor(0.4939, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5822, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5368, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.4780, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 0 | Producer 294] Processing index 59
[GPU Rank 1 | Producer 305] Processing index 26
Batch processed: 16Batch processed: for rank:  2
16 for rank:Queue size for GPU 2: 20 samples 
0
Queue size for GPU 0: 20 samples
Batch processed: 16 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 16 [GPU Rank 2 | Producer 295] Processing index 63for rank: 1

Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 300] Processing index 3[GPU Rank 0 | Producer 302] Processing index 68

[GPU Rank 1 | Producer 297] Processing index 23
[GPU Rank 2] Processed batch 17.
[GPU Rank 0] Processed batch 17.
[GPU Rank 3] Processed batch 17.
[GPU Rank 1] Processed batch 17.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 303] Processing index 145
tensor(0.5512, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5237, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.4892, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.6135, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 114
[GPU Rank 3 | Producer 300] Processing index 94
[GPU Rank 2 | Producer 295] Processing index 107
[GPU Rank 1 | Producer 297] Processing index 127
Batch processed: Batch processed:17  for rank:17  2for rank:
 0
Queue size for GPU 2: 20 samples
Queue size for GPU 0: 20 samples
Batch processed: 17 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 17 for rank: 1
[GPU Rank 2 | Producer 303] Processing index 108Queue size for GPU 1: 20 samples
[GPU Rank 0 | Producer 294] Processing index 8
[GPU Rank 3 | Producer 296] Processing index 144

[GPU Rank 1 | Producer 305] Processing index 8
[GPU Rank 2] Processed batch 18.
[GPU Rank 0] Processed batch 18.
[GPU Rank 3] Processed batch 18.
[GPU Rank 1] Processed batch 18.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.5211, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5457, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.6645, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.4822, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 294] Processing index 6
[GPU Rank 1 | Producer 305] Processing index 64
[GPU Rank 2 | Producer 303] Processing index 137
[GPU Rank 3 | Producer 296] Processing index 35
Batch processed: 18 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 18 for rank: 3
Batch processed: Queue size for GPU 3: 20 samples18
 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 18 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 295] Processing index 22[GPU Rank 3 | Producer 300] Processing index 86
[GPU Rank 0 | Producer 302] Processing index 86

[GPU Rank 1 | Producer 293] Processing index 150
[GPU Rank 2] Processed batch 19.
[GPU Rank 3] Processed batch 19.
[GPU Rank 0] Processed batch 19.
[GPU Rank 1] Processed batch 19.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 3 | Producer 300] Processing index 0
[GPU Rank 0 | Producer 302] Processing index 145
tensor(0.5145, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.4801, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.4939, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.6739, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 295] Processing index 164
[GPU Rank 1 | Producer 293] Processing index 128
Batch processed: 19 for rank: 2
Batch processed: Queue size for GPU 2: 20 samples
19 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 19 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 19 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 303] Processing index 87
[GPU Rank 0 | Producer 306] Processing index 38[GPU Rank 1 | Producer 305] Processing index 55
[GPU Rank 3 | Producer 291] Processing index 54

[GPU Rank 2] Processed batch 20.
[GPU Rank 3] Processed batch 20.
[GPU Rank 0] Processed batch 20.
[GPU Rank 1] Processed batch 20.
loss_value in pytorchloss_value in pytorch  loss_value in pytorch loss_value in pytorch tensor(0.5028, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.4934, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5189, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.5178, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 303] Processing index 136
[GPU Rank 1 | Producer 305] Processing index 133
[GPU Rank 3 | Producer 291] Processing index 106
Batch processed: 20 for rank: 2
Batch processed:Queue size for GPU 2: 20 samples 
20 for rank: 0
Batch processed:Queue size for GPU 0: 20 samples 
20 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 20 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 0 | Producer 302] Processing index 57[GPU Rank 2 | Producer 292] Processing index 138

[GPU Rank 1 | Producer 297] Processing index 136
[GPU Rank 3] Processed batch 21.
[GPU Rank 2] Processed batch 21.
[GPU Rank 0] Processed batch 21.
[GPU Rank 1] Processed batch 21.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 306] Processing index 0
[GPU Rank 3 | Producer 304] Processing index 131
tensor(0.5139, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.4839, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.4920, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.5662, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 297] Processing index 16
[GPU Rank 2 | Producer 292] Processing index 99
Batch processed: 21 for rank: 3
RAISE StopIterationBatch processed:
Batch processed:  2121  for rank:for rank:  12

Batch processed:RAISE StopIterationRAISE StopIteration
 
21 for rank: 0
RAISE StopIteration
Batch processed: 0 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 0 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 0 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 303] Processing index 113[GPU Rank 3 | Producer 296] Processing index 124[GPU Rank 1 | Producer 293] Processing index 122:::MLLOG {"namespace": "", "time_ms": 1743705119218, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 106, "epoch_num": 2, "current_lr": 0.16008}}


:::MLLOG {"namespace": "", "time_ms": 1743705119220, "event_type": "INTERVAL_END", "key": "block_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 135, "first_epoch_num": 2, "epoch_count": 1}}
[GPU Rank 2] Processed batch 1.
:::MLLOG {"namespace": "", "time_ms": 1743705119220, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 66, "first_epoch_num": 3, "epoch_count": 1}}

:::MLLOG {"namespace": "", "time_ms": 1743705119220, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 68, "epoch_num": 3}}
[GPU Rank 3] Processed batch 1.
[GPU Rank 1] Processed batch 1.
Batch processed: 0 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 0 | Producer 306] Processing index 102
[GPU Rank 0] Processed batch 1.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 3 | Producer 304] Processing index 52
[GPU Rank 0 | Producer 302] Processing index 141
tensor(0.4664, device='cuda:2', grad_fn=<DivBackward0>)tensor(0.5639, device='cuda:3', grad_fn=<DivBackward0>)

tensor(0.5452, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4988, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 306] Processing index 152
[GPU Rank 3 | Producer 296] Processing index 47
[GPU Rank 1 | Producer 293] Processing index 120
[GPU Rank 2 | Producer 303] Processing index 74
Batch processed: 1 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed:Batch processed:  11  for rank:for rank:  30

Queue size for GPU 3: 20 samplesQueue size for GPU 0: 20 samples

Batch processed: 1 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 299] Processing index 65
[GPU Rank 0 | Producer 298] Processing index 93[GPU Rank 1 | Producer 305] Processing index 110[GPU Rank 3 | Producer 304] Processing index 32


[GPU Rank 3] Processed batch 2.
[GPU Rank 2] Processed batch 2.
[GPU Rank 1] Processed batch 2.
[GPU Rank 0] Processed batch 2.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.5149, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.5185, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.4420, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5563, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 146
[GPU Rank 3 | Producer 304] Processing index 161
[GPU Rank 0 | Producer 298] Processing index 17
[GPU Rank 2 | Producer 299] Processing index 60
Batch processed: 2 for rank: 0
Batch processed:Batch processed: Queue size for GPU 0: 20 samples 2
 2 for rank:for rank:  32

Queue size for GPU 2: 20 samples
Queue size for GPU 3: 20 samples
Batch processed: 2 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 303] Processing index 20[GPU Rank 3 | Producer 296] Processing index 137[GPU Rank 0 | Producer 302] Processing index 110
[GPU Rank 1 | Producer 293] Processing index 158


[GPU Rank 2] Processed batch 3.
[GPU Rank 0] Processed batch 3.
[GPU Rank 3] Processed batch 3.
[GPU Rank 1] Processed batch 3.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.4781, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4134, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5896, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5715, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 293] Processing index 92
[GPU Rank 0 | Producer 302] Processing index 65
Batch processed: 3 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed:Batch processed: 3  for rank:3  0for rank:
 3
Queue size for GPU 0: 20 samples
Queue size for GPU 3: 20 samplesBatch processed:
 3 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 295] Processing index 141[GPU Rank 1 | Producer 297] Processing index 0
[GPU Rank 0 | Producer 298] Processing index 4
[GPU Rank 3 | Producer 304] Processing index 17

[GPU Rank 3] Processed batch 4.
[GPU Rank 1] Processed batch 4.
[GPU Rank 2] Processed batch 4.
[GPU Rank 0] Processed batch 4.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 303] Processing index 49
tensor(0.5702, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5963, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.5777, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.6082, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 82
[GPU Rank 3 | Producer 304] Processing index 88
[GPU Rank 1 | Producer 297] Processing index 125
[GPU Rank 2 | Producer 295] Processing index 129
[GPU Rank 0 | Producer 298] Processing index 74
Batch processed:Batch processed:  44  Batch processed:for rank:for rank:  30 

4 Queue size for GPU 0: 20 samplesQueue size for GPU 3: 20 samplesfor rank:

 2
Queue size for GPU 2: 20 samples
Batch processed: 4 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 291] Processing index 146[GPU Rank 0 | Producer 306] Processing index 45[GPU Rank 1 | Producer 293] Processing index 157


[GPU Rank 2] Processed batch 5.
[GPU Rank 0] Processed batch 5.
[GPU Rank 1] Processed batch 5.
[GPU Rank 3] Processed batch 5.
[GPU Rank 2 | Producer 303] Processing index 38
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.5055, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5455, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.4722, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4531, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 306] Processing index 63
[GPU Rank 1 | Producer 293] Processing index 94
[GPU Rank 3 | Producer 291] Processing index 46
Batch processed: 5 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: Batch processed:5  for rank:5Batch processed:  1for rank: 
 53 
for rank: Queue size for GPU 1: 20 samples0Queue size for GPU 3: 20 samples


Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 295] Processing index 160[GPU Rank 1 | Producer 297] Processing index 152
[GPU Rank 0 | Producer 294] Processing index 43
[GPU Rank 3 | Producer 304] Processing index 158

[GPU Rank 2] Processed batch 6.
[GPU Rank 3] Processed batch 6.
[GPU Rank 1] Processed batch 6.
[GPU Rank 0] Processed batch 6.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 303] Processing index 145
tensor(0.5071, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4761, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5336, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.6551, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 295] Processing index 143
[GPU Rank 1 | Producer 297] Processing index 46
[GPU Rank 3 | Producer 304] Processing index 99
Batch processed: 6 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed:Batch processed:  Batch processed:66   for rank:6for rank:   1for rank:3
 
2
Queue size for GPU 2: 20 samplesQueue size for GPU 1: 20 samples
Queue size for GPU 3: 20 samples

[GPU Rank 0 | Producer 306] Processing index 46[GPU Rank 2 | Producer 303] Processing index 108
[GPU Rank 1 | Producer 293] Processing index 164
[GPU Rank 3 | Producer 300] Processing index 19

[GPU Rank 1] Processed batch 7.
[GPU Rank 3] Processed batch 7.
[GPU Rank 2] Processed batch 7.
[GPU Rank 0] Processed batch 7.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 294] Processing index 75
tensor(0.4630, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5637, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5052, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.5259, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 51
[GPU Rank 1 | Producer 293] Processing index 77
[GPU Rank 2 | Producer 303] Processing index 137
[GPU Rank 0 | Producer 306] Processing index 121
Batch processed: 7 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed:Batch processed: 7  for rank:Batch processed:7   1for rank:
7  2for rank:
 0Queue size for GPU 1: 20 samples

Queue size for GPU 2: 20 samples
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 296] Processing index 60[GPU Rank 2 | Producer 295] Processing index 114
[GPU Rank 1 | Producer 305] Processing index 78[GPU Rank 0 | Producer 298] Processing index 111


[GPU Rank 2] Processed batch 8.
[GPU Rank 1] Processed batch 8.
[GPU Rank 3] Processed batch 8.
[GPU Rank 0] Processed batch 8.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.5830, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.5857, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5224, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.6537, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 295] Processing index 41
[GPU Rank 1 | Producer 305] Processing index 112
[GPU Rank 3 | Producer 296] Processing index 126
[GPU Rank 0 | Producer 298] Processing index 62
Batch processed:Batch processed:  8 8for rank:  for rank:0 
3
Queue size for GPU 0: 20 samples
Queue size for GPU 3: 20 samples
Batch processed: 8 for rank: Batch processed:1
 8Queue size for GPU 1: 20 samples 
for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 3 | Producer 300] Processing index 16[GPU Rank 2 | Producer 303] Processing index 87

[GPU Rank 1 | Producer 293] Processing index 150[GPU Rank 0 | Producer 302] Processing index 97

[GPU Rank 1] Processed batch 9.
[GPU Rank 0] Processed batch 9.
[GPU Rank 2] Processed batch 9.
[GPU Rank 3] Processed batch 9.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.4979, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5801, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5112, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.5548, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 43
[GPU Rank 2 | Producer 303] Processing index 136
[GPU Rank 0 | Producer 302] Processing index 101
[GPU Rank 1 | Producer 293] Processing index 128
Batch processed: 9 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 9 for rank: 3
Batch processed:Queue size for GPU 3: 20 samples
 9 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 9 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 295] Processing index 63
[GPU Rank 3 | Producer 296] Processing index 87
[GPU Rank 1 | Producer 301] Processing index 35[GPU Rank 0 | Producer 294] Processing index 106

[GPU Rank 2] Processed batch 10.
[GPU Rank 0] Processed batch 10.
[GPU Rank 3] Processed batch 10.
[GPU Rank 1] Processed batch 10.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.4151, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5842, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5082, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4858, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 2 | Producer 295] Processing index 107
[GPU Rank 0 | Producer 294] Processing index 72
[GPU Rank 1 | Producer 301] Processing index 115
Batch processed: 10 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 10 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed:Batch processed: 10  for rank: 010
 for rank: 1
Queue size for GPU 0: 20 samples
Queue size for GPU 1: 20 samples[GPU Rank 2 | Producer 303] Processing index 113

[GPU Rank 0 | Producer 302] Processing index 68[GPU Rank 1 | Producer 293] Processing index 122
[GPU Rank 3 | Producer 300] Processing index 8

[GPU Rank 2] Processed batch 11.
[GPU Rank 1] Processed batch 11.
[GPU Rank 3] Processed batch 11.
[GPU Rank 0] Processed batch 11.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.4404, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.4052, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4138, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.4700, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 114
[GPU Rank 1 | Producer 293] Processing index 120
[GPU Rank 2 | Producer 303] Processing index 74
[GPU Rank 3 | Producer 300] Processing index 29
Batch processed: 11 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 11 for rank:Batch processed: 3
 11 for rank: 0
Queue size for GPU 3: 20 samples
Queue size for GPU 0: 20 samples
Batch processed:[GPU Rank 2 | Producer 295] Processing index 22 11 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 0 | Producer 294] Processing index 166
[GPU Rank 3 | Producer 296] Processing index 144

[GPU Rank 1 | Producer 305] Processing index 162
[GPU Rank 2] Processed batch 12.
[GPU Rank 3] Processed batch 12.
[GPU Rank 0] Processed batch 12.
[GPU Rank 1] Processed batch 12.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.4328, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5279, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.6155, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4126, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 26
[GPU Rank 3 | Producer 296] Processing index 35
[GPU Rank 2 | Producer 295] Processing index 164
[GPU Rank 0 | Producer 294] Processing index 55
Batch processed: 12 for rank: 2
Batch processed:Queue size for GPU 2: 20 samples
 12 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 2 | Producer 303] Processing index 20
Batch processed: 12 for rank: 1
[GPU Rank 3 | Producer 300] Processing index 3Queue size for GPU 1: 20 samples
Batch processed: 12 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 1 | Producer 293] Processing index 158

[GPU Rank 0 | Producer 302] Processing index 86
[GPU Rank 3] Processed batch 13.
[GPU Rank 1] Processed batch 13.
[GPU Rank 2] Processed batch 13.
[GPU Rank 0] Processed batch 13.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 145
tensor(0.4684, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.4070, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5303, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.5435, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 94
[GPU Rank 1 | Producer 293] Processing index 92
Batch processed: 13Batch processed: for rank:  3
13 for rank: 2Queue size for GPU 3: 20 samples

Queue size for GPU 2: 20 samples
Batch processed: 13 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 299] Processing index 30
[GPU Rank 3 | Producer 296] Processing index 124
Batch processed: 13 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 1 | Producer 305] Processing index 8
[GPU Rank 0 | Producer 294] Processing index 134
[GPU Rank 3] Processed batch 14.
[GPU Rank 2] Processed batch 14.
[GPU Rank 0] Processed batch 14.
[GPU Rank 1] Processed batch 14.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 303] Processing index 49
tensor(0.5264, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.4926, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.4775, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.5269, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 47
[GPU Rank 1 | Producer 305] Processing index 64
[GPU Rank 0 | Producer 294] Processing index 59
[GPU Rank 2 | Producer 299] Processing index 50
Batch processed: 14 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 14 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 14 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 300] Processing index 86
Batch processed: 14 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 1 | Producer 293] Processing index 157
[GPU Rank 2 | Producer 292] Processing index 72
[GPU Rank 0 | Producer 302] Processing index 57
[GPU Rank 3] Processed batch 15.
[GPU Rank 2] Processed batch 15.
[GPU Rank 1] Processed batch 15.
[GPU Rank 0] Processed batch 15.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 3 | Producer 300] Processing index 0
tensor(0.7586, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5827, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.6477, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.5024, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 293] Processing index 94
[GPU Rank 2 | Producer 292] Processing index 43
Batch processed: 15 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 15 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 15 for rank: 1
[GPU Rank 2 | Producer 303] Processing index 38
Queue size for GPU 1: 20 samples
Batch processed: [GPU Rank 3 | Producer 296] Processing index 13715 for rank: 
0
Queue size for GPU 0: 20 samples
[GPU Rank 0 | Producer 294] Processing index 8
[GPU Rank 1 | Producer 305] Processing index 55
[GPU Rank 2] Processed batch 16.
[GPU Rank 3] Processed batch 16.
[GPU Rank 1] Processed batch 16.
[GPU Rank 0] Processed batch 16.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 141
tensor(0.5439, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5219, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5337, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.6023, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 294] Processing index 6
[GPU Rank 1 | Producer 305] Processing index 133
Batch processed: 16 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: Batch processed:16  for rank: 016
 for rank: 3
Queue size for GPU 0: 20 samples
Queue size for GPU 3: 20 samples
Batch processed: 16 for rank: 1
[GPU Rank 2 | Producer 292] Processing index 69Queue size for GPU 1: 20 samples
[GPU Rank 1 | Producer 293] Processing index 164
[GPU Rank 0 | Producer 306] Processing index 14
[GPU Rank 3 | Producer 291] Processing index 11

[GPU Rank 2] Processed batch 17.
[GPU Rank 3] Processed batch 17.
[GPU Rank 0] Processed batch 17.
[GPU Rank 1] Processed batch 17.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 303] Processing index 145
tensor(0.4983, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.6270, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5209, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.4537, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 82
[GPU Rank 1 | Producer 293] Processing index 77
[GPU Rank 2 | Producer 292] Processing index 31
[GPU Rank 3 | Producer 291] Processing index 136
Batch processed: 17 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: Batch processed:17  for rank:17  2for rank: 
0
Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samples

Batch processed: 17 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 0 | Producer 302] Processing index 110[GPU Rank 1 | Producer 297] Processing index 140
[GPU Rank 2 | Producer 295] Processing index 141[GPU Rank 3 | Producer 304] Processing index 74


[GPU Rank 3] Processed batch 18.
[GPU Rank 1] Processed batch 18.
[GPU Rank 2] Processed batch 18.
[GPU Rank 0] Processed batch 18.
[GPU Rank 0 | Producer 306] Processing index 80
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.5339, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5693, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.4621, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4943, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 65
[GPU Rank 1 | Producer 297] Processing index 42
[GPU Rank 2 | Producer 295] Processing index 129
[GPU Rank 3 | Producer 304] Processing index 23
Batch processed: 18 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 18 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 18 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 18 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 292] Processing index 125
[GPU Rank 1 | Producer 293] Processing index 150
[GPU Rank 3 | Producer 296] Processing index 60
[GPU Rank 0 | Producer 306] Processing index 38
[GPU Rank 2] Processed batch 19.
[GPU Rank 1] Processed batch 19.
[GPU Rank 3] Processed batch 19.
[GPU Rank 0] Processed batch 19.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.6489, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5342, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.4541, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4559, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 292] Processing index 106
[GPU Rank 3 | Producer 296] Processing index 126
[GPU Rank 1 | Producer 293] Processing index 128
Batch processed: 19 for rank:Batch processed: 3
 19 Queue size for GPU 3: 20 samplesfor rank:
 2
Queue size for GPU 2: 20 samples
Batch processed: 19 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed:[GPU Rank 3 | Producer 300] Processing index 19 19 for rank: 1
[GPU Rank 2 | Producer 295] Processing index 160Queue size for GPU 1: 20 samples
[GPU Rank 0 | Producer 302] Processing index 97


[GPU Rank 1 | Producer 297] Processing index 23
[GPU Rank 3] Processed batch 20.
[GPU Rank 2] Processed batch 20.
[GPU Rank 0] Processed batch 20.
[GPU Rank 1] Processed batch 20.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 306] Processing index 0
tensor(0.5739, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5127, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.6274, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.6192, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 101
[GPU Rank 2 | Producer 295] Processing index 143
[GPU Rank 3 | Producer 300] Processing index 51
[GPU Rank 1 | Producer 297] Processing index 127
Batch processed: 20Batch processed: for rank:  3
20 for rank: 2Queue size for GPU 3: 20 samples

Queue size for GPU 2: 20 samples
Batch processed: 20 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 20 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 292] Processing index 152
[GPU Rank 1 | Producer 293] Processing index 122
[GPU Rank 3 | Producer 296] Processing index 87
[GPU Rank 0 | Producer 294] Processing index 43
[GPU Rank 2] Processed batch 21.
[GPU Rank 3] Processed batch 21.
[GPU Rank 1] Processed batch 21.
[GPU Rank 0] Processed batch 21.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.5227, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4945, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5157, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5417, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 1 | Producer 293] Processing index 120
[GPU Rank 2 | Producer 292] Processing index 35
Batch processed: 21 for rank: 2
RAISE StopIteration
Batch processed: 21 for rank: 0
RAISE StopIteration
Batch processed: 21 for rank: 3
RAISE StopIteration
Batch processed: 21 for rank: 1
RAISE StopIteration
Batch processed: 0 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 0 for rank: 3
[GPU Rank 2 | Producer 295] Processing index 114Queue size for GPU 3: 20 samples

[GPU Rank 3 | Producer 300] Processing index 16
:::MLLOG {"namespace": "", "time_ms": 1743705135635, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 106, "epoch_num": 3, "current_lr": 0.24007}}
Batch processed: 0 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2] Processed batch 1.[GPU Rank 3] Processed batch 1.

[GPU Rank 1 | Producer 301] Processing index 63:::MLLOG {"namespace": "", "time_ms": 1743705135637, "event_type": "INTERVAL_END", "key": "block_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 135, "first_epoch_num": 3, "epoch_count": 1}}

:::MLLOG {"namespace": "", "time_ms": 1743705135638, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 66, "first_epoch_num": 4, "epoch_count": 1}}
:::MLLOG {"namespace": "", "time_ms": 1743705135638, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 68, "epoch_num": 4}}
[GPU Rank 1] Processed batch 1.
Batch processed: 0 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 0 | Producer 302] Processing index 68
[GPU Rank 0] Processed batch 1.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 294] Processing index 75
tensor(0.6400, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5207, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5546, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.5059, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 43
[GPU Rank 0 | Producer 302] Processing index 114
[GPU Rank 2 | Producer 295] Processing index 41
[GPU Rank 1 | Producer 301] Processing index 143
Batch processed: 1Batch processed: for rank:  31
 Batch processed:for rank:  0Queue size for GPU 3: 20 samples
1
 for rank: 1
Queue size for GPU 1: 20 samples
Queue size for GPU 0: 20 samplesBatch processed:
 1 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 3 | Producer 296] Processing index 144
[GPU Rank 2 | Producer 292] Processing index 138
[GPU Rank 1 | Producer 293] Processing index 158
[GPU Rank 0 | Producer 294] Processing index 106
[GPU Rank 2] Processed batch 2.
[GPU Rank 0] Processed batch 2.
[GPU Rank 1] Processed batch 2.
[GPU Rank 3] Processed batch 2.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.5496, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.5148, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.6326, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5671, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 35
[GPU Rank 2 | Producer 292] Processing index 99
[GPU Rank 0 | Producer 294] Processing index 72
[GPU Rank 1 | Producer 293] Processing index 92
Batch processed: 2 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: Batch processed:2  2 for rank: Batch processed:3
for rank:  21 
for rank: 0
Queue size for GPU 3: 20 samples
Queue size for GPU 0: 20 samples
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 295] Processing index 63[GPU Rank 0 | Producer 302] Processing index 86[GPU Rank 3 | Producer 300] Processing index 8
[GPU Rank 1 | Producer 297] Processing index 136


[GPU Rank 0] Processed batch 3.
[GPU Rank 3] Processed batch 3.
[GPU Rank 2] Processed batch 3.
[GPU Rank 1] Processed batch 3.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 145
tensor(0.4577, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.4757, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.4744, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4689, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 29
[GPU Rank 2 | Producer 295] Processing index 107
[GPU Rank 1 | Producer 297] Processing index 16
Batch processed:Batch processed:  3 for rank: 2
3Queue size for GPU 2: 20 samples 
for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 3 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed:[GPU Rank 2 | Producer 292] Processing index 72 3 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 0 | Producer 306] Processing index 102

[GPU Rank 3 | Producer 291] Processing index 90[GPU Rank 1 | Producer 293] Processing index 157
[GPU Rank 2] Processed batch 4.

[GPU Rank 3] Processed batch 4.
[GPU Rank 0] Processed batch 4.
[GPU Rank 1] Processed batch 4.
loss_value in pytorch loss_value in pytorch loss_value in pytorchloss_value in pytorch  tensor(0.4756, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4645, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.6228, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.4691, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 291] Processing index 153
[GPU Rank 0 | Producer 306] Processing index 152
[GPU Rank 1 | Producer 293] Processing index 94
[GPU Rank 2 | Producer 292] Processing index 43
Batch processed:Batch processed:  44  for rank:for rank:  32

Batch processed:Queue size for GPU 3: 20 samples 
4 for rank: 1Queue size for GPU 2: 20 samples

Queue size for GPU 1: 20 samples
Batch processed: 4 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 1 | Producer 297] Processing index 0[GPU Rank 3 | Producer 300] Processing index 3
[GPU Rank 2 | Producer 295] Processing index 22

[GPU Rank 0 | Producer 298] Processing index 165
[GPU Rank 3] Processed batch 5.
[GPU Rank 1] Processed batch 5.
[GPU Rank 2] Processed batch 5.
[GPU Rank 0] Processed batch 5.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.5949, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.4507, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3789, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.5255, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 94
[GPU Rank 1 | Producer 297] Processing index 125
[GPU Rank 0 | Producer 298] Processing index 28
[GPU Rank 2 | Producer 295] Processing index 164
Batch processed: 5 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 5 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 5 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 292] Processing index 69[GPU Rank 3 | Producer 291] Processing index 65
[GPU Rank 0 | Producer 306] Processing index 45

Batch processed: 5 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2] Processed batch 6.
[GPU Rank 1 | Producer 293] Processing index 164[GPU Rank 3] Processed batch 6.

[GPU Rank 0] Processed batch 6.
[GPU Rank 1] Processed batch 6.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.4954, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.4735, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.6000, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4832, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 306] Processing index 63
[GPU Rank 1 | Producer 293] Processing index 77
[GPU Rank 2 | Producer 292] Processing index 31
[GPU Rank 3 | Producer 291] Processing index 154
Batch processed: 6 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 6 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 6 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 300] Processing index 86
[GPU Rank 2 | Producer 299] Processing index 103
[GPU Rank 0 | Producer 298] Processing index 151Batch processed: 6 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3] Processed batch 7.

[GPU Rank 1 | Producer 301] Processing index 19
[GPU Rank 2] Processed batch 7.
[GPU Rank 0] Processed batch 7.
[GPU Rank 1] Processed batch 7.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 3 | Producer 300] Processing index 0
tensor(0.4379, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5151, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5661, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.6247, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 299] Processing index 156
[GPU Rank 1 | Producer 301] Processing index 141
[GPU Rank 0 | Producer 298] Processing index 76
Batch processed: 7 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 7 Batch processed:for rank:  2
7 for rank: 0
Queue size for GPU 2: 20 samples
Batch processed: 7 Queue size for GPU 0: 20 samples
for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 296] Processing index 124[GPU Rank 2 | Producer 292] Processing index 125[GPU Rank 0 | Producer 306] Processing index 46


[GPU Rank 1 | Producer 293] Processing index 150
[GPU Rank 3] Processed batch 8.
[GPU Rank 2] Processed batch 8.
[GPU Rank 0] Processed batch 8.
[GPU Rank 1] Processed batch 8.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.4453, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.4977, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4443, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.5398, device='cuda:2', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 292] Processing index 106
[GPU Rank 3 | Producer 296] Processing index 47
[GPU Rank 1 | Producer 293] Processing index 128
[GPU Rank 0 | Producer 306] Processing index 121
Batch processed: 8 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 8 for rank: Batch processed:3 
8 for rank:Queue size for GPU 3: 20 samples 
0
Queue size for GPU 0: 20 samples
Batch processed: 8 for rank: 1
Queue size for GPU 1: 20 samples[GPU Rank 2 | Producer 299] Processing index 9

[GPU Rank 0 | Producer 298] Processing index 93[GPU Rank 3 | Producer 304] Processing index 131

[GPU Rank 1 | Producer 301] Processing index 56
[GPU Rank 3] Processed batch 9.
[GPU Rank 2] Processed batch 9.
[GPU Rank 0] Processed batch 9.
[GPU Rank 1] Processed batch 9.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.4851, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5088, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3821, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4684, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 301] Processing index 167
[GPU Rank 0 | Producer 298] Processing index 17
[GPU Rank 2 | Producer 299] Processing index 26
[GPU Rank 3 | Producer 304] Processing index 52
Batch processed: 9 for rank: 2
Batch processed: Queue size for GPU 2: 20 samples9
 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 9 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 296] Processing index 137Batch processed: 9 for rank: 0
Queue size for GPU 0: 20 samples

[GPU Rank 2 | Producer 292] Processing index 152
[GPU Rank 1 | Producer 297] Processing index 152
[GPU Rank 0 | Producer 294] Processing index 166[GPU Rank 2] Processed batch 10.
[GPU Rank 3] Processed batch 10.

[GPU Rank 0] Processed batch 10.
[GPU Rank 1] Processed batch 10.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.4675, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5657, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.4678, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.5215, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 292] Processing index 35
[GPU Rank 1 | Producer 297] Processing index 46
[GPU Rank 0 | Producer 294] Processing index 55
Batch processed: 10 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 10 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 10Batch processed: for rank:  0
10 for rank: 1
Queue size for GPU 0: 20 samples
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 303] Processing index 108[GPU Rank 0 | Producer 298] Processing index 4[GPU Rank 1 | Producer 293] Processing index 122


[GPU Rank 3 | Producer 304] Processing index 32
[GPU Rank 2] Processed batch 11.
[GPU Rank 3] Processed batch 11.
[GPU Rank 1] Processed batch 11.
[GPU Rank 0] Processed batch 11.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.6049, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5290, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.5485, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5257, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 82
[GPU Rank 1 | Producer 293] Processing index 120
[GPU Rank 3 | Producer 304] Processing index 161
[GPU Rank 2 | Producer 303] Processing index 137
[GPU Rank 0 | Producer 298] Processing index 74
Batch processed: 11 for rank: 2Batch processed:
 Queue size for GPU 2: 20 samples11
 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 11 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 291] Processing index 54Batch processed: 11 for rank: 0
[GPU Rank 1 | Producer 297] Processing index 140

Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 292] Processing index 138
[GPU Rank 2] Processed batch 12.
[GPU Rank 0 | Producer 306] Processing index 14
[GPU Rank 3] Processed batch 12.
[GPU Rank 1] Processed batch 12.
[GPU Rank 0] Processed batch 12.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.4048, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.4837, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3835, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4510, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 297] Processing index 42
[GPU Rank 2 | Producer 292] Processing index 99
[GPU Rank 3 | Producer 291] Processing index 106
[GPU Rank 0 | Producer 306] Processing index 80
Batch processed: 12 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 12 for rank: 0Batch processed:
 12 for rank: 3Queue size for GPU 0: 20 samples

Queue size for GPU 3: 20 samples
Batch processed: 12 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 295] Processing index 141[GPU Rank 3 | Producer 304] Processing index 17
[GPU Rank 0 | Producer 298] Processing index 111

[GPU Rank 1 | Producer 293] Processing index 158
[GPU Rank 2] Processed batch 13.
[GPU Rank 1] Processed batch 13.
[GPU Rank 3] Processed batch 13.
[GPU Rank 0] Processed batch 13.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3734, device='cuda:3', grad_fn=<DivBackward0>)tensor(0.4245, device='cuda:2', grad_fn=<DivBackward0>)

tensor(0.4071, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4871, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 304] Processing index 88
[GPU Rank 2 | Producer 295] Processing index 129
[GPU Rank 0 | Producer 298] Processing index 62
[GPU Rank 1 | Producer 293] Processing index 92
Batch processed: 13 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed:Batch processed:  1313  for rank:for rank:  0Batch processed:
2 
Queue size for GPU 2: 20 samples
13 for rank:Queue size for GPU 0: 20 samples 
1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 291] Processing index 146
[GPU Rank 2 | Producer 303] Processing index 87[GPU Rank 0 | Producer 294] Processing index 134
[GPU Rank 1 | Producer 305] Processing index 110

[GPU Rank 3] Processed batch 14.
[GPU Rank 2] Processed batch 14.
[GPU Rank 0] Processed batch 14.
[GPU Rank 1] Processed batch 14.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.5287, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5762, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3967, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4673, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 303] Processing index 136
[GPU Rank 0 | Producer 294] Processing index 59
[GPU Rank 1 | Producer 305] Processing index 146
[GPU Rank 3 | Producer 291] Processing index 46
Batch processed: 14 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 14 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 14 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 14 for rank:[GPU Rank 2 | Producer 295] Processing index 160 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 304] Processing index 158
[GPU Rank 0 | Producer 298] Processing index 165
[GPU Rank 1 | Producer 301] Processing index 14

[GPU Rank 2] Processed batch 15.
[GPU Rank 3] Processed batch 15.
[GPU Rank 0] Processed batch 15.
[GPU Rank 1] Processed batch 15.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.4331, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3847, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3415, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4233, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 295] Processing index 143
[GPU Rank 0 | Producer 298] Processing index 28
[GPU Rank 3 | Producer 304] Processing index 99
[GPU Rank 1 | Producer 301] Processing index 145
Batch processed: 15Batch processed: for rank:  215
 for rank: 3Queue size for GPU 2: 20 samples

Queue size for GPU 3: 20 samples
Batch processed: 15 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 15 for rank:[GPU Rank 0 | Producer 294] Processing index 8 1[GPU Rank 2 | Producer 303] Processing index 113
Queue size for GPU 1: 20 samples[GPU Rank 3 | Producer 300] Processing index 19



[GPU Rank 1 | Producer 305] Processing index 78
[GPU Rank 2] Processed batch 16.
[GPU Rank 3] Processed batch 16.
[GPU Rank 0] Processed batch 16.
[GPU Rank 1] Processed batch 16.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.4009, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.4685, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5706, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4301, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 294] Processing index 6
[GPU Rank 1 | Producer 305] Processing index 112
[GPU Rank 2 | Producer 303] Processing index 74
[GPU Rank 3 | Producer 300] Processing index 51
Batch processed: 16 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 16 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 16 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 16 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 296] Processing index 60
[GPU Rank 2 | Producer 299] Processing index 104[GPU Rank 0 | Producer 298] Processing index 151[GPU Rank 1 | Producer 293] Processing index 157


[GPU Rank 3] Processed batch 17.
[GPU Rank 2] Processed batch 17.
[GPU Rank 1] Processed batch 17.
[GPU Rank 0] Processed batch 17.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3214, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3703, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3698, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4560, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 298] Processing index 76
[GPU Rank 2 | Producer 299] Processing index 83
[GPU Rank 1 | Producer 293] Processing index 94
[GPU Rank 3 | Producer 296] Processing index 126
Batch processed: 17 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 17Batch processed: for rank:  017
 for rank: 3
Queue size for GPU 0: 20 samples
Queue size for GPU 3: 20 samples
Batch processed: 17 for rank: 1
[GPU Rank 2 | Producer 303] Processing index 20Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 300] Processing index 16[GPU Rank 0 | Producer 302] Processing index 57
[GPU Rank 1 | Producer 305] Processing index 162


[GPU Rank 2] Processed batch 18.
[GPU Rank 3] Processed batch 18.
[GPU Rank 0] Processed batch 18.
[GPU Rank 1] Processed batch 18.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3686, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3924, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3399, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3658, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 43
[GPU Rank 1 | Producer 305] Processing index 26
Batch processed: Batch processed:18 for rank:  2
18 for rank: 3Queue size for GPU 2: 20 samples

Queue size for GPU 3: 20 samples
Batch processed: 18 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 18 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 295] Processing index 114[GPU Rank 3 | Producer 296] Processing index 87[GPU Rank 0 | Producer 298] Processing index 93
[GPU Rank 1 | Producer 293] Processing index 164


[GPU Rank 3] Processed batch 19.
[GPU Rank 0] Processed batch 19.
[GPU Rank 2] Processed batch 19.
[GPU Rank 1] Processed batch 19.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 141
[GPU Rank 2 | Producer 303] Processing index 49
tensor(0.3775, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3154, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3784, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3516, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 1 | Producer 293] Processing index 77
[GPU Rank 2 | Producer 295] Processing index 41
[GPU Rank 0 | Producer 298] Processing index 17
Batch processed: 19 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 19 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: Batch processed:19  for rank: 119
 for rank: 0
Queue size for GPU 1: 20 samples
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 292] Processing index 72
[GPU Rank 3 | Producer 291] Processing index 11
[GPU Rank 1 | Producer 305] Processing index 8
[GPU Rank 0 | Producer 306] Processing index 38
[GPU Rank 3] Processed batch 20.
[GPU Rank 2] Processed batch 20.
[GPU Rank 0] Processed batch 20.
[GPU Rank 1] Processed batch 20.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3189, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3297, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3699, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.3674, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 64
[GPU Rank 3 | Producer 291] Processing index 136
[GPU Rank 2 | Producer 292] Processing index 43
Batch processed: 20 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed:Batch processed:  2020  for rank:for rank:  02

Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samples

Batch processed: 20 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 296] Processing index 144[GPU Rank 2 | Producer 295] Processing index 63

[GPU Rank 0 | Producer 302] Processing index 110
[GPU Rank 1 | Producer 293] Processing index 150
[GPU Rank 3] Processed batch 21.
[GPU Rank 0] Processed batch 21.
[GPU Rank 2] Processed batch 21.
[GPU Rank 1] Processed batch 21.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 306] Processing index 0
tensor(0.4201, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3636, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3201, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5038, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 65
[GPU Rank 2 | Producer 295] Processing index 107
[GPU Rank 3 | Producer 296] Processing index 35
[GPU Rank 1 | Producer 293] Processing index 128
Batch processed: 21Batch processed: for rank: 2 
21RAISE StopIteration
 for rank: 3
RAISE StopIteration
Batch processed:Batch processed:  21 21for rank:  for rank:1 
0RAISE StopIteration

RAISE StopIteration
:::MLLOG {"namespace": "", "time_ms": 1743705152091, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 106, "epoch_num": 4, "current_lr": 0.32006}}
:::MLLOG {"namespace": "", "time_ms": 1743705152092, "event_type": "INTERVAL_START", "key": "eval_start", "value": 4, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 115, "epoch_num": 4}}
Batch processed: 0 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 3 | Producer 308] Processing index 1
[GPU Rank 3] Processed batch 1.
I AM HERe to evaluate
Batch processed: 0 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 0 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 2 | Producer 307] Processing index 1
[GPU Rank 1] Processed batch 1.
I AM HERe to evaluate
[GPU Rank 2] Processed batch 1.
I AM HERe to evaluate
Batch processed: 0 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 0] Processed batch 1.
I AM HERe to evaluate
[GPU Rank 0 | Producer 310] Processing index 10
[GPU Rank 1 | Producer 309] Processing index 1
Batch processed: 1 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 2 | Producer 307] Processing index 2
[GPU Rank 2] Processed batch 2.
I AM HERe to evaluate
Batch processed: 1 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 3 | Producer 308] Processing index 2
[GPU Rank 3] Processed batch 2.
I AM HERe to evaluate
Batch processed: 1 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 1] Processed batch 2.
I AM HERe to evaluate
[GPU Rank 1 | Producer 309] Processing index 2
Batch processed: 1 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 0] Processed batch 2.
I AM HERe to evaluate
[GPU Rank 0 | Producer 310] Processing index 0
Batch processed: 2 for rank: 2
RAISE StopIteration
Batch processed: 2 for rank: 1
RAISE StopIteration
Batch processed: 2 for rank: 3
RAISE StopIteration
Batch processed: 2 for rank: 0
RAISE StopIteration
:::MLLOG {"namespace": "", "time_ms": 1743705162441, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.14322766661643982, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 120, "epoch_num": 4}}
:::MLLOG {"namespace": "", "time_ms": 1743705162442, "event_type": "INTERVAL_END", "key": "eval_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 124, "epoch_num": 4}}
DLL 2025-04-03 18:32:42.443495 - 4.0 epoch : 4.0  L1 dice : 0.28645533323287964  L2 dice : 9.194382755151054e-11  mean_dice : 0.14322766661643982  eval_loss : 0.4851608872413635  train_loss : 0.46166083216667175  TOP_epoch : 4.0  TOP_L1 dice : 0.28645533323287964  TOP_L2 dice : 9.194382755151054e-11  TOP_mean_dice : 0.14322766661643982  TOP_eval_loss : 0.4851608872413635  TOP_train_loss : 0.46166083216667175 
Batch processed: 0 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 1 | Producer 293] Processing index 122
[GPU Rank 1] Processed batch 1.
Batch processed: 0 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 2] Processed batch 1.
Batch processed: 0 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 3 | Producer 291] Processing index 90
[GPU Rank 3] Processed batch 1.
:::MLLOG {"namespace": "", "time_ms": 1743705162471, "event_type": "INTERVAL_END", "key": "block_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 135, "first_epoch_num": 4, "epoch_count": 1}}
:::MLLOG {"namespace": "", "time_ms": 1743705162472, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 66, "first_epoch_num": 5, "epoch_count": 1}}
:::MLLOG {"namespace": "", "time_ms": 1743705162472, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 68, "epoch_num": 5}}
Batch processed: 0 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 0 | Producer 306] Processing index 102
[GPU Rank 0] Processed batch 1.
[GPU Rank 2 | Producer 292] Processing index 69
loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3072, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3624, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.4119, device='cuda:3', grad_fn=<DivBackward0>)
loss_value in pytorch tensor(0.4073, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 293] Processing index 120
[GPU Rank 3 | Producer 291] Processing index 153
[GPU Rank 0 | Producer 306] Processing index 152
[GPU Rank 2 | Producer 292] Processing index 31
Batch processed: 1 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 1 for rank: 3
Batch processed:Queue size for GPU 3: 20 samplesBatch processed:
 1  1for rank:  2for rank:
 1
Queue size for GPU 2: 20 samples
Queue size for GPU 1: 20 samples
[GPU Rank 1 | Producer 301] Processing index 35
[GPU Rank 3 | Producer 296] Processing index 124[GPU Rank 2 | Producer 303] Processing index 38
[GPU Rank 0 | Producer 298] Processing index 4

[GPU Rank 1] Processed batch 2.
[GPU Rank 3] Processed batch 2.
[GPU Rank 0] Processed batch 2.
[GPU Rank 2] Processed batch 2.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3839, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3240, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3697, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4078, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 47
[GPU Rank 1 | Producer 301] Processing index 115
Batch processed: 2 for rank: 3
Batch processed:Batch processed:Queue size for GPU 3: 20 samples
  22  for rank:for rank:  20

Queue size for GPU 2: 20 samples
Queue size for GPU 0: 20 samples
Batch processed: 2 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 291] Processing index 65
[GPU Rank 2 | Producer 292] Processing index 125
[GPU Rank 1 | Producer 305] Processing index 55
[GPU Rank 0 | Producer 306] Processing index 45
[GPU Rank 1] Processed batch 3.
[GPU Rank 3] Processed batch 3.
[GPU Rank 0] Processed batch 3.
[GPU Rank 2] Processed batch 3.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 298] Processing index 74
[GPU Rank 2 | Producer 303] Processing index 145
tensor(0.4276, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4095, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.4361, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3990, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 292] Processing index 106
[GPU Rank 0 | Producer 306] Processing index 63
[GPU Rank 1 | Producer 305] Processing index 133
[GPU Rank 3 | Producer 291] Processing index 154
Batch processed: 3 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 3 for rank: 2
Batch processed:Queue size for GPU 2: 20 samples 
3 for rank: 3
Batch processed:Queue size for GPU 3: 20 samples 
3 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 295] Processing index 22[GPU Rank 1 | Producer 297] Processing index 23

[GPU Rank 3 | Producer 296] Processing index 137
[GPU Rank 0 | Producer 302] Processing index 97
[GPU Rank 0] Processed batch 4.
[GPU Rank 3] Processed batch 4.
[GPU Rank 2] Processed batch 4.
[GPU Rank 1] Processed batch 4.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3164, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3285, device='cuda:1', grad_fn=<DivBackward0>)tensor(0.3453, device='cuda:3', grad_fn=<DivBackward0>)

tensor(0.6107, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 101
[GPU Rank 2 | Producer 295] Processing index 164
[GPU Rank 1 | Producer 297] Processing index 127
Batch processed: Batch processed:4  for rank: 4 0for rank:
 Batch processed:2
Queue size for GPU 0: 20 samples
 4 for rank:Batch processed: 3Queue size for GPU 2: 20 samples 

4 for rank: 1Queue size for GPU 3: 20 samples

Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 300] Processing index 8[GPU Rank 1 | Producer 305] Processing index 110
[GPU Rank 2 | Producer 292] Processing index 152
[GPU Rank 0 | Producer 306] Processing index 46

[GPU Rank 3] Processed batch 5.
[GPU Rank 1] Processed batch 5.
[GPU Rank 0] Processed batch 5.
[GPU Rank 2] Processed batch 5.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.4901, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3527, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3070, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2895, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 82
[GPU Rank 1 | Producer 305] Processing index 146
[GPU Rank 3 | Producer 300] Processing index 29
[GPU Rank 2 | Producer 292] Processing index 35
[GPU Rank 0 | Producer 306] Processing index 121
Batch processed: 5Batch processed: for rank:  35
 for rank: 2
Queue size for GPU 3: 20 samplesBatch processed:
 5 for rank:Queue size for GPU 2: 20 samples 
1
Batch processed: Queue size for GPU 1: 20 samples5
 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 304] Processing index 74
[GPU Rank 2 | Producer 299] Processing index 65
[GPU Rank 0 | Producer 302] Processing index 68
[GPU Rank 1 | Producer 301] Processing index 63
[GPU Rank 0] Processed batch 6.
[GPU Rank 3] Processed batch 6.
[GPU Rank 1] Processed batch 6.
[GPU Rank 2] Processed batch 6.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.7137, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.4157, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.6015, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.4645, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 114
[GPU Rank 1 | Producer 301] Processing index 143
[GPU Rank 3 | Producer 304] Processing index 23
[GPU Rank 2 | Producer 299] Processing index 60
Batch processed: 6 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 6 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 6 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 6 for rank: 0
[GPU Rank 3 | Producer 300] Processing index 3Queue size for GPU 0: 20 samples
[GPU Rank 1 | Producer 305] Processing index 78

[GPU Rank 2 | Producer 292] Processing index 138
[GPU Rank 0 | Producer 306] Processing index 14
[GPU Rank 3] Processed batch 7.
[GPU Rank 1] Processed batch 7.
[GPU Rank 2] Processed batch 7.
[GPU Rank 0] Processed batch 7.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.4038, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3634, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4596, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3781, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 112
[GPU Rank 3 | Producer 300] Processing index 94
[GPU Rank 2 | Producer 292] Processing index 99
[GPU Rank 0 | Producer 306] Processing index 80
Batch processed:Batch processed:  77  for rank:for rank:  31

Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

Batch processed: 7 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 7 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 1 | Producer 301] Processing index 19[GPU Rank 3 | Producer 304] Processing index 131[GPU Rank 0 | Producer 302] Processing index 86


[GPU Rank 2 | Producer 295] Processing index 141
[GPU Rank 0] Processed batch 8.
[GPU Rank 1] Processed batch 8.
[GPU Rank 2] Processed batch 8.
[GPU Rank 3] Processed batch 8.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 145
tensor(0.4252, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.4088, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3311, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.6011, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 301] Processing index 141
[GPU Rank 2 | Producer 295] Processing index 129
[GPU Rank 3 | Producer 304] Processing index 52
Batch processed: 8 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 8 for rank: Batch processed:1
 8 for rank: 2
Queue size for GPU 1: 20 samples
Queue size for GPU 2: 20 samples
Batch processed: 8 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 300] Processing index 86[GPU Rank 1 | Producer 305] Processing index 162[GPU Rank 2 | Producer 292] Processing index 72


[GPU Rank 0 | Producer 306] Processing index 38
[GPU Rank 3] Processed batch 9.
[GPU Rank 1] Processed batch 9.
[GPU Rank 2] Processed batch 9.
[GPU Rank 0] Processed batch 9.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 3 | Producer 300] Processing index 0
tensor(0.3193, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3211, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.4326, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3302, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 26
[GPU Rank 2 | Producer 292] Processing index 43
Batch processed:Batch processed:  99  for rank:for rank:  0
2
Queue size for GPU 0: 20 samples
Queue size for GPU 2: 20 samples
Batch processed: 9 for rank: 3Batch processed:
 9Queue size for GPU 3: 20 samples 
for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 304] Processing index 32
[GPU Rank 2 | Producer 295] Processing index 160
[GPU Rank 1 | Producer 301] Processing index 56
[GPU Rank 0 | Producer 294] Processing index 43
[GPU Rank 0] Processed batch 10.
[GPU Rank 2] Processed batch 10.
[GPU Rank 1] Processed batch 10.
[GPU Rank 3] Processed batch 10.
loss_value in pytorch [GPU Rank 0 | Producer 306] Processing index 0
loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3857, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3248, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.5928, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3197, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 295] Processing index 143
[GPU Rank 1 | Producer 301] Processing index 167
[GPU Rank 3 | Producer 304] Processing index 161
Batch processed:Batch processed: 10 Batch processed: for rank:10   210for rank:
  3for rank:
 1
Queue size for GPU 2: 20 samples
Queue size for GPU 3: 20 samples
Queue size for GPU 1: 20 samples
Batch processed: 10 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 1 | Producer 305] Processing index 8[GPU Rank 0 | Producer 306] Processing index 102
[GPU Rank 2 | Producer 292] Processing index 69

[GPU Rank 3 | Producer 296] Processing index 60
[GPU Rank 3] Processed batch 11.
[GPU Rank 1] Processed batch 11.
[GPU Rank 2] Processed batch 11.
[GPU Rank 0] Processed batch 11.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 294] Processing index 75
tensor(0.4671, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3221, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.4104, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3692, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 306] Processing index 152
[GPU Rank 1 | Producer 305] Processing index 64
[GPU Rank 2 | Producer 292] Processing index 31
[GPU Rank 3 | Producer 296] Processing index 126
Batch processed: Batch processed:11Batch processed:  for rank: 11 11 3 for rank:
for rank:  12

Queue size for GPU 3: 20 samples
Queue size for GPU 1: 20 samplesQueue size for GPU 2: 20 samples

Batch processed: 11 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 1 | Producer 297] Processing index 136
[GPU Rank 2 | Producer 299] Processing index 30[GPU Rank 3 | Producer 304] Processing index 17

[GPU Rank 0 | Producer 298] Processing index 111
[GPU Rank 1] Processed batch 12.
[GPU Rank 2] Processed batch 12.
[GPU Rank 3] Processed batch 12.
[GPU Rank 0] Processed batch 12.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3439, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3187, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3606, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3922, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 304] Processing index 88
[GPU Rank 1 | Producer 297] Processing index 16
[GPU Rank 0 | Producer 298] Processing index 62
Batch processed: 12 for rank: 3
Queue size for GPU 3: 20 samplesBatch processed:
 12 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed:Batch processed:  12 12for rank:  for rank:0 
2
Queue size for GPU 0: 20 samples
Queue size for GPU 2: 20 samples
[GPU Rank 3 | Producer 291] Processing index 54
[GPU Rank 1 | Producer 305] Processing index 55[GPU Rank 2 | Producer 292] Processing index 125

[GPU Rank 0 | Producer 306] Processing index 45
[GPU Rank 2] Processed batch 13.
[GPU Rank 3] Processed batch 13.
[GPU Rank 1] Processed batch 13.
[GPU Rank 0] Processed batch 13.
[GPU Rank 2 | Producer 299] Processing index 50
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.4121, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3460, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3955, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4551, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 292] Processing index 106
[GPU Rank 1 | Producer 305] Processing index 133
[GPU Rank 0 | Producer 306] Processing index 63
[GPU Rank 3 | Producer 291] Processing index 106
Batch processed: Batch processed:13 for rank:  113
 for rank: 2
Queue size for GPU 1: 20 samples
Queue size for GPU 2: 20 samples
Batch processed: Batch processed: 13 13for rank:  for rank:3 
0
Queue size for GPU 3: 20 samples
Queue size for GPU 0: 20 samples
[GPU Rank 1 | Producer 297] Processing index 0[GPU Rank 2 | Producer 295] Processing index 114
[GPU Rank 3 | Producer 300] Processing index 19

[GPU Rank 0 | Producer 294] Processing index 106
[GPU Rank 0] Processed batch 14.[GPU Rank 3] Processed batch 14.

[GPU Rank 2] Processed batch 14.
[GPU Rank 1] Processed batch 14.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2939, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.4529, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.4775, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.4013, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 295] Processing index 41
[GPU Rank 1 | Producer 297] Processing index 125
[GPU Rank 3 | Producer 300] Processing index 51
[GPU Rank 0 | Producer 294] Processing index 72
Batch processed: 14 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 14 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: Batch processed:14  for rank: 3
14 for rank: 1
Queue size for GPU 3: 20 samples
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 292] Processing index 152
[GPU Rank 0 | Producer 298] Processing index 165[GPU Rank 1 | Producer 297] Processing index 152[GPU Rank 3 | Producer 296] Processing index 87


[GPU Rank 2] Processed batch 15.
[GPU Rank 0] Processed batch 15.
[GPU Rank 1] Processed batch 15.
[GPU Rank 3] Processed batch 15.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3512, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5467, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3226, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3505, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 2 | Producer 292] Processing index 35
[GPU Rank 1 | Producer 297] Processing index 46
[GPU Rank 0 | Producer 298] Processing index 28
Batch processed: 15 for rank: 2
Batch processed: 15 Queue size for GPU 2: 20 samplesfor rank:
 0
Queue size for GPU 0: 20 samples
Batch processed:Batch processed:  1515  for rank:for rank:  31

Queue size for GPU 3: 20 samples
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 295] Processing index 63
[GPU Rank 0 | Producer 294] Processing index 166[GPU Rank 1 | Producer 305] Processing index 110[GPU Rank 3 | Producer 300] Processing index 16


[GPU Rank 2] Processed batch 16.
[GPU Rank 1] Processed batch 16.
[GPU Rank 3] Processed batch 16.
[GPU Rank 0] Processed batch 16.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3922, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3369, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3289, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2941, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 43
[GPU Rank 1 | Producer 305] Processing index 146
[GPU Rank 2 | Producer 295] Processing index 107
[GPU Rank 0 | Producer 294] Processing index 55
Batch processed:Batch processed:  16 16for rank:  for rank:0 
2
Queue size for GPU 2: 20 samplesQueue size for GPU 0: 20 samples

Batch processed: 16 Batch processed:for rank: 3 
16 for rank: 1
Queue size for GPU 3: 20 samples
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 292] Processing index 138
[GPU Rank 3 | Producer 296] Processing index 144[GPU Rank 1 | Producer 297] Processing index 140
[GPU Rank 0 | Producer 306] Processing index 46

[GPU Rank 2] Processed batch 17.
[GPU Rank 0] Processed batch 17.
[GPU Rank 1] Processed batch 17.
[GPU Rank 3] Processed batch 17.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2980, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3043, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3308, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3264, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 297] Processing index 42
[GPU Rank 3 | Producer 296] Processing index 35
[GPU Rank 2 | Producer 292] Processing index 99
Batch processed:Batch processed: 17 for rank: 0
Batch processed:  17Batch processed: Queue size for GPU 0: 20 samplesfor rank:
17   3for rank: 
217
 for rank: 1Queue size for GPU 3: 20 samples

Queue size for GPU 2: 20 samples
Queue size for GPU 1: 20 samples
[GPU Rank 0 | Producer 294] Processing index 134[GPU Rank 3 | Producer 300] Processing index 8
[GPU Rank 2 | Producer 295] Processing index 22
[GPU Rank 1 | Producer 301] Processing index 14

[GPU Rank 0] Processed batch 18.
[GPU Rank 1] Processed batch 18.
[GPU Rank 3] Processed batch 18.
[GPU Rank 2] Processed batch 18.
loss_value in pytorch [GPU Rank 0 | Producer 306] Processing index 121
loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3510, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3533, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2659, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.4237, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 29
[GPU Rank 0 | Producer 294] Processing index 59
[GPU Rank 2 | Producer 295] Processing index 164
[GPU Rank 1 | Producer 301] Processing index 145
Batch processed: 18 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed:Batch processed:  18 Batch processed:for rank:  183 18
for rank:  for rank:0 
1
Queue size for GPU 3: 20 samples
Queue size for GPU 1: 20 samples
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 292] Processing index 72
[GPU Rank 1 | Producer 305] Processing index 78
[GPU Rank 3 | Producer 296] Processing index 124
[GPU Rank 0 | Producer 302] Processing index 57
[GPU Rank 3] Processed batch 19.
[GPU Rank 2] Processed batch 19.
[GPU Rank 1] Processed batch 19.
[GPU Rank 0] Processed batch 19.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3669, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2893, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.5170, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.4851, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 47
[GPU Rank 1 | Producer 305] Processing index 112
[GPU Rank 2 | Producer 292] Processing index 43
Batch processed: 19 for rank: 0
Batch processed:Batch processed:Queue size for GPU 0: 20 samples 
 19 for rank:Batch processed: 319
  for rank:19  1Queue size for GPU 3: 20 samplesfor rank:

 2
Queue size for GPU 2: 20 samples
Queue size for GPU 1: 20 samples
[GPU Rank 0 | Producer 294] Processing index 8
[GPU Rank 3 | Producer 300] Processing index 3[GPU Rank 2 | Producer 303] Processing index 108

[GPU Rank 1 | Producer 293] Processing index 158
[GPU Rank 0] Processed batch 20.
[GPU Rank 2] Processed batch 20.
[GPU Rank 3] Processed batch 20.
[GPU Rank 1] Processed batch 20.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 141
tensor(0.3336, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3019, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.3145, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3222, device='cuda:3', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 294] Processing index 6
[GPU Rank 3 | Producer 300] Processing index 94
[GPU Rank 2 | Producer 303] Processing index 137
[GPU Rank 1 | Producer 293] Processing index 92
Batch processed: 20 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 20 for rank: 3
Batch processed: 20 for rank: Batch processed:0
Queue size for GPU 3: 20 samples 
20 for rank: Queue size for GPU 0: 20 samples1

Queue size for GPU 1: 20 samples
[GPU Rank 1 | Producer 305] Processing index 162[GPU Rank 0 | Producer 298] Processing index 151[GPU Rank 3 | Producer 296] Processing index 137
[GPU Rank 2 | Producer 292] Processing index 69


[GPU Rank 3] Processed batch 21.
[GPU Rank 2] Processed batch 21.
[GPU Rank 0] Processed batch 21.
[GPU Rank 1] Processed batch 21.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3148, device='cuda:1', grad_fn=<DivBackward0>)tensor(0.2733, device='cuda:2', grad_fn=<DivBackward0>)

tensor(0.3252, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3359, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 26
[GPU Rank 2 | Producer 292] Processing index 31
[GPU Rank 0 | Producer 298] Processing index 76
Batch processed: 21 for rank: 2
RAISE StopIteration
Batch processed:Batch processed:  21 for rank:21  3
for rank:RAISE StopIteration 
0
Batch processed:RAISE StopIteration 21
 for rank: 1
RAISE StopIteration
Batch processed: 0 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 2 | Producer 295] Processing index 141
Batch processed: 0 for rank: 3
Queue size for GPU 3: 20 samples
:::MLLOG {"namespace": "", "time_ms": 1743705179022, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 106, "epoch_num": 5, "current_lr": 0.40005}}
[GPU Rank 3 | Producer 300] Processing index 86
Batch processed: 0 for rank: 1
Queue size for GPU 1: 20 samples
:::MLLOG {"namespace": "", "time_ms": 1743705179023, "event_type": "INTERVAL_END", "key": "block_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 135, "first_epoch_num": 5, "epoch_count": 1}}
[GPU Rank 2] Processed batch 1.
:::MLLOG {"namespace": "", "time_ms": 1743705179024, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 66, "first_epoch_num": 6, "epoch_count": 1}}
[GPU Rank 1 | Producer 293] Processing index 157
:::MLLOG {"namespace": "", "time_ms": 1743705179024, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 68, "epoch_num": 6}}
[GPU Rank 3] Processed batch 1.
Batch processed: 0 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 1] Processed batch 1.
[GPU Rank 0 | Producer 302] Processing index 110
[GPU Rank 0] Processed batch 1.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 3 | Producer 300] Processing index 0
tensor(0.2453, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.4343, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3220, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2834, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 82
[GPU Rank 0 | Producer 302] Processing index 65
[GPU Rank 1 | Producer 293] Processing index 94
[GPU Rank 2 | Producer 295] Processing index 129
Batch processed: 1 for rank:Batch processed: 3 
Batch processed:1  for rank:Queue size for GPU 3: 20 samples1 
 2
for rank: 1
Queue size for GPU 2: 20 samples
Queue size for GPU 1: 20 samples
Batch processed: 1 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 292] Processing index 125[GPU Rank 3 | Producer 291] Processing index 146
[GPU Rank 0 | Producer 298] Processing index 93
[GPU Rank 1 | Producer 305] Processing index 8

[GPU Rank 2] Processed batch 2.
[GPU Rank 0] Processed batch 2.
[GPU Rank 3] Processed batch 2.
[GPU Rank 1] Processed batch 2.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.4873, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.4136, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2883, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3089, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 292] Processing index 106
[GPU Rank 1 | Producer 305] Processing index 64
[GPU Rank 0 | Producer 298] Processing index 17
[GPU Rank 3 | Producer 291] Processing index 46
Batch processed: 2 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed:Batch processed:  Batch processed:22  for rank: for rank:  321
 
for rank: 0
Queue size for GPU 1: 20 samples
Queue size for GPU 3: 20 samplesQueue size for GPU 0: 20 samples

[GPU Rank 0 | Producer 302] Processing index 97
[GPU Rank 3 | Producer 296] Processing index 60
[GPU Rank 1 | Producer 293] Processing index 164
[GPU Rank 2 | Producer 299] Processing index 103
[GPU Rank 2] Processed batch 3.
[GPU Rank 1] Processed batch 3.
[GPU Rank 3] Processed batch 3.
[GPU Rank 0] Processed batch 3.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3626, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2941, device='cuda:3', grad_fn=<DivBackward0>)tensor(0.3077, device='cuda:1', grad_fn=<DivBackward0>)

tensor(0.3801, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 299] Processing index 156
[GPU Rank 0 | Producer 302] Processing index 101
[GPU Rank 1 | Producer 293] Processing index 77
[GPU Rank 3 | Producer 296] Processing index 126
Batch processed: 3Batch processed: for rank:  0
3 for rank: 3
Queue size for GPU 0: 20 samples
Queue size for GPU 3: 20 samplesBatch processed:
 3 for rank: 2
Batch processed: 3 Queue size for GPU 2: 20 samplesfor rank:
 1
Queue size for GPU 1: 20 samples
[GPU Rank 0 | Producer 298] Processing index 4[GPU Rank 3 | Producer 304] Processing index 158[GPU Rank 2 | Producer 303] Processing index 87[GPU Rank 1 | Producer 305] Processing index 55



[GPU Rank 3] Processed batch 4.
[GPU Rank 0] Processed batch 4.[GPU Rank 2] Processed batch 4.

[GPU Rank 1] Processed batch 4.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3075, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2520, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5165, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3655, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 303] Processing index 136
[GPU Rank 1 | Producer 305] Processing index 133
[GPU Rank 3 | Producer 304] Processing index 99
[GPU Rank 0 | Producer 298] Processing index 74
Batch processed:Batch processed:  4 4for rank:  for rank:2 
3
Queue size for GPU 2: 20 samples
Queue size for GPU 3: 20 samplesBatch processed:
 4 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 4 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 0 | Producer 302] Processing index 68
[GPU Rank 2 | Producer 295] Processing index 160
[GPU Rank 3 | Producer 296] Processing index 87
[GPU Rank 1 | Producer 293] Processing index 150
[GPU Rank 1] Processed batch 5.
[GPU Rank 2] Processed batch 5.
[GPU Rank 3] Processed batch 5.
[GPU Rank 0] Processed batch 5.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3689, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.4557, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.5314, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3469, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 0 | Producer 302] Processing index 114
[GPU Rank 2 | Producer 295] Processing index 143
[GPU Rank 1 | Producer 293] Processing index 128
Batch processed: 5 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 5 for rank: 1
Batch processed:Queue size for GPU 1: 20 samples
 5 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 2 | Producer 292] Processing index 152
[GPU Rank 1 | Producer 305] Processing index 110
[GPU Rank 3 | Producer 300] Processing index 19
Batch processed: 5 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 0 | Producer 306] Processing index 14
[GPU Rank 2] Processed batch 6.
[GPU Rank 1] Processed batch 6.
[GPU Rank 3] Processed batch 6.
[GPU Rank 0] Processed batch 6.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.4460, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5738, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3784, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.4378, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 146
[GPU Rank 3 | Producer 300] Processing index 51
[GPU Rank 2 | Producer 292] Processing index 35
Batch processed: 6 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 6 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 6 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 6 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 1 | Producer 301] Processing index 35
[GPU Rank 2 | Producer 299] Processing index 9
[GPU Rank 0 | Producer 302] Processing index 86
[GPU Rank 3 | Producer 296] Processing index 144
[GPU Rank 2] Processed batch 7.
[GPU Rank 1] Processed batch 7.
[GPU Rank 3] Processed batch 7.
[GPU Rank 0] Processed batch 7.
[GPU Rank 0 | Producer 306] Processing index 80
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 145
tensor(0.5134, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3668, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.4248, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.5007, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 35
[GPU Rank 1 | Producer 301] Processing index 115
[GPU Rank 2 | Producer 299] Processing index 26
Batch processed: 7 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed:Batch processed:  77  for rank:for rank:  31

Queue size for GPU 3: 20 samples
Batch processed:Queue size for GPU 1: 20 samples 
7 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 0 | Producer 294] Processing index 43
[GPU Rank 3 | Producer 300] Processing index 16
[GPU Rank 2 | Producer 303] Processing index 113
[GPU Rank 1 | Producer 293] Processing index 122
[GPU Rank 2] Processed batch 8.
[GPU Rank 1] Processed batch 8.
[GPU Rank 3] Processed batch 8.
[GPU Rank 0] Processed batch 8.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3157, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.6749, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5348, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.4132, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 43
[GPU Rank 1 | Producer 293] Processing index 120
[GPU Rank 2 | Producer 303] Processing index 74
Batch processed: 8 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 8 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 8 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 8 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 2 | Producer 295] Processing index 114[GPU Rank 0 | Producer 302] Processing index 57
[GPU Rank 1 | Producer 297] Processing index 23
[GPU Rank 3 | Producer 296] Processing index 124

[GPU Rank 1] Processed batch 9.
[GPU Rank 0 | Producer 294] Processing index 75
[GPU Rank 3] Processed batch 9.
[GPU Rank 2] Processed batch 9.
[GPU Rank 0] Processed batch 9.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3666, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4163, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.4430, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3545, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 47
[GPU Rank 2 | Producer 295] Processing index 41
[GPU Rank 1 | Producer 297] Processing index 127
Batch processed: 9 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 9 for rank: 3
Batch processed:Queue size for GPU 3: 20 samples
 9 Batch processed:for rank:  19
 for rank: 0
Queue size for GPU 1: 20 samples
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 303] Processing index 20[GPU Rank 3 | Producer 300] Processing index 8[GPU Rank 1 | Producer 293] Processing index 158

[GPU Rank 0 | Producer 298] Processing index 111

[GPU Rank 2] Processed batch 10.
[GPU Rank 3] Processed batch 10.
[GPU Rank 1] Processed batch 10.
[GPU Rank 0] Processed batch 10.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 141
tensor(0.3920, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.3153, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3412, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3470, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 29
[GPU Rank 0 | Producer 298] Processing index 62
[GPU Rank 1 | Producer 293] Processing index 92
Batch processed: 10 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed:Batch processed:  10 10for rank:  for rank:0 
3
Queue size for GPU 0: 20 samples
Batch processed:Queue size for GPU 3: 20 samples
 10 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 295] Processing index 63[GPU Rank 0 | Producer 302] Processing index 110
[GPU Rank 3 | Producer 296] Processing index 137[GPU Rank 1 | Producer 297] Processing index 136


[GPU Rank 2] Processed batch 11.
[GPU Rank 0] Processed batch 11.
[GPU Rank 3] Processed batch 11.
[GPU Rank 1] Processed batch 11.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 303] Processing index 49
tensor(0.3756, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3160, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3178, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4116, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 65
[GPU Rank 2 | Producer 295] Processing index 107
[GPU Rank 1 | Producer 297] Processing index 16
Batch processed: 11 for rank: 2
Batch processed: 11 for rank: 0
Queue size for GPU 2: 20 samples
Queue size for GPU 0: 20 samplesBatch processed:
 11 for rank: 1
Batch processed: 11Queue size for GPU 1: 20 samples 
for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 2 | Producer 292] Processing index 138[GPU Rank 1 | Producer 293] Processing index 157[GPU Rank 0 | Producer 294] Processing index 106
[GPU Rank 3 | Producer 300] Processing index 3


[GPU Rank 0] Processed batch 12.
[GPU Rank 1] Processed batch 12.
[GPU Rank 2] Processed batch 12.
[GPU Rank 3] Processed batch 12.
loss_value in pytorch loss_value in pytorchloss_value in pytorch  loss_value in pytorch tensor(0.3180, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3146, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.4941, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2818, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 82
[GPU Rank 3 | Producer 300] Processing index 94
[GPU Rank 1 | Producer 293] Processing index 94
[GPU Rank 2 | Producer 292] Processing index 99
[GPU Rank 0 | Producer 294] Processing index 72
Batch processed:Batch processed:  1212  for rank:for rank:  02

Queue size for GPU 2: 20 samplesQueue size for GPU 0: 20 samples

Batch processed: Batch processed: 12 for rank: 312
 for rank: 1
Queue size for GPU 3: 20 samples
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 295] Processing index 22
[GPU Rank 0 | Producer 302] Processing index 97
[GPU Rank 1 | Producer 297] Processing index 0
[GPU Rank 0] Processed batch 13.
[GPU Rank 3] Processed batch 13.
[GPU Rank 2] Processed batch 13.
[GPU Rank 1] Processed batch 13.
[GPU Rank 3 | Producer 300] Processing index 86
loss_value in pytorch loss_value in pytorch loss_value in pytorchloss_value in pytorch  [GPU Rank 3 | Producer 300] Processing index 0
tensor(0.3977, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3497, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3213, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3636, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 101
[GPU Rank 1 | Producer 297] Processing index 125
[GPU Rank 2 | Producer 295] Processing index 164
Batch processed: 13 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 13Batch processed: Batch processed:for rank:  130  
for rank:13  3
for rank:Queue size for GPU 0: 20 samples
 2
Queue size for GPU 3: 20 samples
Queue size for GPU 2: 20 samples
[GPU Rank 1 | Producer 293] Processing index 164
[GPU Rank 3 | Producer 296] Processing index 60[GPU Rank 0 | Producer 306] Processing index 38

[GPU Rank 2 | Producer 292] Processing index 72
[GPU Rank 0] Processed batch 14.
[GPU Rank 1] Processed batch 14.
[GPU Rank 2] Processed batch 14.
[GPU Rank 3] Processed batch 14.
loss_value in pytorch loss_value in pytorchloss_value in pytorch  loss_value in pytorch tensor(0.3039, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3633, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2770, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3855, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 293] Processing index 77
[GPU Rank 3 | Producer 296] Processing index 126
[GPU Rank 2 | Producer 292] Processing index 43
Batch processed: 14 for rank: Batch processed:2
 14 Queue size for GPU 2: 20 samplesfor rank:
 3
Queue size for GPU 3: 20 samples
Batch processed: 14 for rank:Batch processed: 1 
14 for rank: 0
Queue size for GPU 1: 20 samples
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 303] Processing index 38[GPU Rank 0 | Producer 302] Processing index 68[GPU Rank 1 | Producer 301] Processing index 63


[GPU Rank 3 | Producer 296] Processing index 87
[GPU Rank 2] Processed batch 15.
[GPU Rank 3] Processed batch 15.
[GPU Rank 0] Processed batch 15.
[GPU Rank 1] Processed batch 15.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 306] Processing index 0
tensor(0.3710, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5093, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3335, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2987, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 0 | Producer 302] Processing index 114
[GPU Rank 1 | Producer 301] Processing index 143
Batch processed:Batch processed:  1515  for rank:for rank:  0
2
Queue size for GPU 0: 20 samples
Queue size for GPU 2: 20 samples
Batch processed: 15Batch processed: for rank:  115 
for rank: 3
Queue size for GPU 1: 20 samples
Queue size for GPU 3: 20 samples
[GPU Rank 2 | Producer 299] Processing index 104
[GPU Rank 0 | Producer 298] Processing index 165
[GPU Rank 1 | Producer 293] Processing index 150
[GPU Rank 3 | Producer 304] Processing index 74
[GPU Rank 0] Processed batch 16.[GPU Rank 2] Processed batch 16.

[GPU Rank 1] Processed batch 16.
[GPU Rank 3] Processed batch 16.
loss_value in pytorch loss_value in pytorchloss_value in pytorch  loss_value in pytorch [GPU Rank 2 | Producer 303] Processing index 145
tensor(0.4658, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3071, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3877, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3764, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 299] Processing index 83
[GPU Rank 0 | Producer 298] Processing index 28
[GPU Rank 3 | Producer 304] Processing index 23
[GPU Rank 1 | Producer 293] Processing index 128
Batch processed: 16Batch processed: for rank:Batch processed:  3 
16 for rank: 162Queue size for GPU 3: 20 samples 

for rank: 1
Queue size for GPU 2: 20 samples
Queue size for GPU 1: 20 samples
Batch processed: 16 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 296] Processing index 144
[GPU Rank 1 | Producer 301] Processing index 19
[GPU Rank 0 | Producer 302] Processing index 86
[GPU Rank 2 | Producer 292] Processing index 69
[GPU Rank 2] Processed batch 17.
[GPU Rank 3] Processed batch 17.
[GPU Rank 1] Processed batch 17.
[GPU Rank 0] Processed batch 17.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 145
tensor(0.2814, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3328, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3110, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.4311, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 301] Processing index 141
[GPU Rank 2 | Producer 292] Processing index 31
[GPU Rank 3 | Producer 296] Processing index 35
Batch processed: 17 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 17 for rank: 0
Batch processed:Queue size for GPU 0: 20 samples 
Batch processed:17  for rank: 1
17 for rank: 3
Queue size for GPU 1: 20 samples
Queue size for GPU 3: 20 samples
[GPU Rank 0 | Producer 294] Processing index 166[GPU Rank 1 | Producer 297] Processing index 152
[GPU Rank 3 | Producer 291] Processing index 11
[GPU Rank 2 | Producer 299] Processing index 65

[GPU Rank 2] Processed batch 18.
[GPU Rank 3] Processed batch 18.
[GPU Rank 1] Processed batch 18.
[GPU Rank 0] Processed batch 18.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3762, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2925, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5910, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3479, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 291] Processing index 136
[GPU Rank 2 | Producer 299] Processing index 60
[GPU Rank 1 | Producer 297] Processing index 46
[GPU Rank 0 | Producer 294] Processing index 55
Batch processed:Batch processed:  1818Batch processed:  for rank: for rank:  1831 
for rank: 2

Queue size for GPU 1: 20 samplesQueue size for GPU 2: 20 samples
Queue size for GPU 3: 20 samples

Batch processed: 18 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 296] Processing index 124[GPU Rank 2 | Producer 292] Processing index 125[GPU Rank 1 | Producer 293] Processing index 122[GPU Rank 0 | Producer 302] Processing index 57



[GPU Rank 3] Processed batch 19.
[GPU Rank 2] Processed batch 19.
[GPU Rank 1] Processed batch 19.
[GPU Rank 0] Processed batch 19.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3820, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2823, device='cuda:3', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 292] Processing index 106
tensor(0.3443, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3618, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 47
[GPU Rank 1 | Producer 293] Processing index 120
Batch processed: 19 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 19 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 19 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 19 for rank: 1
[GPU Rank 2 | Producer 299] Processing index 30Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 291] Processing index 90
[GPU Rank 1 | Producer 297] Processing index 140

[GPU Rank 0 | Producer 294] Processing index 134
[GPU Rank 2] Processed batch 20.
[GPU Rank 3] Processed batch 20.
[GPU Rank 0] Processed batch 20.
[GPU Rank 1] Processed batch 20.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 141
tensor(0.3348, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3769, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2861, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3205, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 291] Processing index 153
[GPU Rank 1 | Producer 297] Processing index 42
[GPU Rank 0 | Producer 294] Processing index 59
[GPU Rank 2 | Producer 299] Processing index 50
Batch processed: 20 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 20 for rank: 0
Batch processed:Batch processed:Queue size for GPU 0: 20 samples 
 20 for rank: 220
 for rank: 1
Queue size for GPU 2: 20 samples
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 296] Processing index 137
[GPU Rank 0 | Producer 302] Processing index 110
[GPU Rank 2 | Producer 295] Processing index 141[GPU Rank 1 | Producer 293] Processing index 158

[GPU Rank 3] Processed batch 21.
[GPU Rank 2] Processed batch 21.
[GPU Rank 0] Processed batch 21.
[GPU Rank 1] Processed batch 21.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3333, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2979, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3118, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2872, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 65
[GPU Rank 2 | Producer 295] Processing index 129
[GPU Rank 1 | Producer 293] Processing index 92
Batch processed: 21 for rank: 2
RAISE StopIteration
Batch processed: 21 for rank: 0Batch processed:
RAISE StopIteration 
21 for rank: 3
RAISE StopIteration
Batch processed: 21 for rank: 1
RAISE StopIteration
Batch processed: 0 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 2 | Producer 299] Processing index 103Batch processed: 0 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 0 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 291] Processing index 65[GPU Rank 1 | Producer 301] Processing index 56:::MLLOG {"namespace": "", "time_ms": 1743705195518, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 106, "epoch_num": 6, "current_lr": 0.48004}}



[GPU Rank 2] Processed batch 1.
[GPU Rank 1] Processed batch 1.
[GPU Rank 3] Processed batch 1.
:::MLLOG {"namespace": "", "time_ms": 1743705195520, "event_type": "INTERVAL_END", "key": "block_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 135, "first_epoch_num": 6, "epoch_count": 1}}
:::MLLOG {"namespace": "", "time_ms": 1743705195521, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 66, "first_epoch_num": 7, "epoch_count": 1}}
:::MLLOG {"namespace": "", "time_ms": 1743705195522, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 68, "epoch_num": 7}}
Batch processed: 0 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 0 | Producer 294] Processing index 8
[GPU Rank 0] Processed batch 1.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 299] Processing index 156
tensor(0.2825, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3101, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5199, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2867, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 82
[GPU Rank 0 | Producer 294] Processing index 6
[GPU Rank 1 | Producer 301] Processing index 167
[GPU Rank 3 | Producer 291] Processing index 154
Batch processed: 1 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 1 Batch processed:for rank: 0
 1 Queue size for GPU 0: 20 samplesfor rank:
 3
Queue size for GPU 3: 20 samples
Batch processed: 1 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 0 | Producer 302] Processing index 97[GPU Rank 2 | Producer 292] Processing index 152

[GPU Rank 1 | Producer 293] Processing index 157
[GPU Rank 2] Processed batch 2.
[GPU Rank 3] Processed batch 2.
[GPU Rank 0] Processed batch 2.
[GPU Rank 1] Processed batch 2.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 3 | Producer 296] Processing index 60
tensor(0.3065, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.4364, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2874, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.4316, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 101
[GPU Rank 3 | Producer 296] Processing index 126
[GPU Rank 1 | Producer 293] Processing index 94
[GPU Rank 2 | Producer 292] Processing index 35
Batch processed:Batch processed:  2 for rank: 0
2 for rank: 3Queue size for GPU 0: 20 samples

Queue size for GPU 3: 20 samples
Batch processed: 2 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 2 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 300] Processing index 19[GPU Rank 2 | Producer 299] Processing index 9
[GPU Rank 1 | Producer 301] Processing index 14
[GPU Rank 0 | Producer 306] Processing index 102

[GPU Rank 2] Processed batch 3.
[GPU Rank 0] Processed batch 3.
[GPU Rank 3] Processed batch 3.
[GPU Rank 1] Processed batch 3.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.4507, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3851, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2632, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.3643, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 51
[GPU Rank 0 | Producer 306] Processing index 152
[GPU Rank 2 | Producer 299] Processing index 26
[GPU Rank 1 | Producer 301] Processing index 145
Batch processed:Batch processed:Batch processed:  33  for rank: for rank:  02
3
 for rank: Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samples3


Queue size for GPU 3: 20 samples
Batch processed: 3 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 295] Processing index 160[GPU Rank 3 | Producer 296] Processing index 87
[GPU Rank 0 | Producer 302] Processing index 68[GPU Rank 1 | Producer 305] Processing index 78


[GPU Rank 2] Processed batch 4.
[GPU Rank 3] Processed batch 4.
[GPU Rank 0] Processed batch 4.
[GPU Rank 1] Processed batch 4.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2714, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2547, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3178, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4722, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 114
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 2 | Producer 295] Processing index 143
[GPU Rank 1 | Producer 305] Processing index 112
Batch processed: 4 for rank: 2
Batch processed: Queue size for GPU 2: 20 samples4
 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 4 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 4 for rank: 1
[GPU Rank 2 | Producer 299] Processing index 104Queue size for GPU 1: 20 samples

[GPU Rank 3 | Producer 300] Processing index 16
[GPU Rank 1 | Producer 301] Processing index 35
[GPU Rank 0 | Producer 306] Processing index 45
[GPU Rank 2] Processed batch 5.
[GPU Rank 0] Processed batch 5.
[GPU Rank 3] Processed batch 5.
[GPU Rank 1] Processed batch 5.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3260, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3178, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3347, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.3544, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 43
[GPU Rank 0 | Producer 306] Processing index 63
[GPU Rank 1 | Producer 301] Processing index 115
[GPU Rank 2 | Producer 299] Processing index 83
Batch processed: 5Batch processed: for rank:  05 
Batch processed:for rank: 2
 Queue size for GPU 0: 20 samples5
 for rank: Queue size for GPU 2: 20 samples3

Queue size for GPU 3: 20 samples
Batch processed: 5 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 296] Processing index 144
[GPU Rank 0 | Producer 302] Processing index 86
[GPU Rank 2 | Producer 295] Processing index 114
[GPU Rank 1 | Producer 305] Processing index 162
[GPU Rank 2] Processed batch 6.
[GPU Rank 3] Processed batch 6.
[GPU Rank 0] Processed batch 6.
[GPU Rank 1] Processed batch 6.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 145
tensor(0.2912, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3016, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3297, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3192, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 26
[GPU Rank 2 | Producer 295] Processing index 41
[GPU Rank 3 | Producer 296] Processing index 35
Batch processed: 6 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 6 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: Batch processed:6  6 for rank: 1for rank: 
0
Queue size for GPU 1: 20 samples
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 304] Processing index 131
[GPU Rank 1 | Producer 301] Processing index 63
[GPU Rank 2 | Producer 299] Processing index 65
[GPU Rank 0 | Producer 306] Processing index 46
[GPU Rank 2] Processed batch 7.
[GPU Rank 3] Processed batch 7.
[GPU Rank 1] Processed batch 7.
[GPU Rank 0] Processed batch 7.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2802, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2925, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3186, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2686, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 301] Processing index 143
[GPU Rank 2 | Producer 299] Processing index 60
[GPU Rank 0 | Producer 306] Processing index 121
Batch processed: 7 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 7 for rank: 2
Batch processed:Batch processed:Queue size for GPU 2: 20 samples
  77 for rank:  for rank:0 
1
Queue size for GPU 0: 20 samples
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 296] Processing index 124
[GPU Rank 2 | Producer 295] Processing index 63[GPU Rank 0 | Producer 294] Processing index 43[GPU Rank 1 | Producer 305] Processing index 8


[GPU Rank 0] Processed batch 8.
[GPU Rank 1] Processed batch 8.
[GPU Rank 3] Processed batch 8.
[GPU Rank 2] Processed batch 8.
[GPU Rank 3 | Producer 304] Processing index 52
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3632, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3242, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2969, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3247, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 47
[GPU Rank 1 | Producer 305] Processing index 64
[GPU Rank 2 | Producer 295] Processing index 107
Batch processed: 8 for rank: 2
Batch processed:Queue size for GPU 2: 20 samples
 8 for rank: Batch processed:3
 8 for rank: 1
Batch processed: Queue size for GPU 3: 20 samples
8 for rank: 0
Queue size for GPU 1: 20 samples
Queue size for GPU 0: 20 samples
[GPU Rank 1 | Producer 301] Processing index 19[GPU Rank 3 | Producer 300] Processing index 8[GPU Rank 0 | Producer 298] Processing index 151
[GPU Rank 2 | Producer 299] Processing index 30


[GPU Rank 2] Processed batch 9.
[GPU Rank 1] Processed batch 9.
[GPU Rank 0] Processed batch 9.
[GPU Rank 3] Processed batch 9.
[GPU Rank 0 | Producer 294] Processing index 75
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3892, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3225, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3204, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4419, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 301] Processing index 141
[GPU Rank 0 | Producer 298] Processing index 76
[GPU Rank 3 | Producer 300] Processing index 29
[GPU Rank 2 | Producer 299] Processing index 50
Batch processed: 9 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 9 for rank: 3Batch processed:
 9 Queue size for GPU 3: 20 samplesfor rank: 
1
Batch processed:Queue size for GPU 1: 20 samples
 9 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 296] Processing index 137
[GPU Rank 0 | Producer 294] Processing index 106
[GPU Rank 1 | Producer 305] Processing index 55
[GPU Rank 2 | Producer 295] Processing index 22
[GPU Rank 0] Processed batch 10.
[GPU Rank 1] Processed batch 10.
[GPU Rank 2] Processed batch 10.
[GPU Rank 3] Processed batch 10.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2823, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3300, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3340, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3130, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 133
[GPU Rank 0 | Producer 294] Processing index 72
[GPU Rank 2 | Producer 295] Processing index 164
Batch processed:Batch processed:  1010  for rank:for rank:  02

Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samples

Batch processed: 10 for rank: Batch processed:1
 10 for rank: Queue size for GPU 1: 20 samples3

Queue size for GPU 3: 20 samples
[GPU Rank 2 | Producer 299] Processing index 103
[GPU Rank 0 | Producer 298] Processing index 93[GPU Rank 1 | Producer 301] Processing index 56
[GPU Rank 3 | Producer 300] Processing index 3

[GPU Rank 1] Processed batch 11.
[GPU Rank 0] Processed batch 11.
[GPU Rank 2] Processed batch 11.
[GPU Rank 3] Processed batch 11.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 299] Processing index 156
tensor(0.2714, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2742, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3018, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2797, device='cuda:2', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 82
[GPU Rank 3 | Producer 300] Processing index 94
[GPU Rank 1 | Producer 301] Processing index 167
[GPU Rank 0 | Producer 298] Processing index 17
Batch processed: 11 for rank: 0
Batch processed: 11Queue size for GPU 0: 20 samples
 Batch processed:for rank: 2
 11 for rank: 3
Batch processed:Queue size for GPU 2: 20 samples
 Queue size for GPU 3: 20 samples
11 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 0 | Producer 294] Processing index 166
[GPU Rank 2 | Producer 292] Processing index 138
[GPU Rank 1 | Producer 293] Processing index 164
[GPU Rank 0] Processed batch 12.
[GPU Rank 3] Processed batch 12.
[GPU Rank 2] Processed batch 12.
[GPU Rank 1] Processed batch 12.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 3 | Producer 300] Processing index 86
tensor(0.4068, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3122, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2841, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3409, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 0
[GPU Rank 1 | Producer 293] Processing index 77
[GPU Rank 2 | Producer 292] Processing index 99
[GPU Rank 0 | Producer 294] Processing index 55
Batch processed: 12Batch processed: for rank:  212
 for rank: 0Batch processed:
Queue size for GPU 2: 20 samplesBatch processed:
  1212  for rank:for rank:  31

Queue size for GPU 0: 20 samples
Queue size for GPU 3: 20 samples
Queue size for GPU 1: 20 samples
[GPU Rank 1 | Producer 305] Processing index 110[GPU Rank 3 | Producer 291] Processing index 54

[GPU Rank 2 | Producer 299] Processing index 9
[GPU Rank 0 | Producer 298] Processing index 4
[GPU Rank 3] Processed batch 13.
[GPU Rank 2] Processed batch 13.
[GPU Rank 1] Processed batch 13.
[GPU Rank 0] Processed batch 13.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2583, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3827, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2950, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3115, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 146
[GPU Rank 3 | Producer 291] Processing index 106
[GPU Rank 2 | Producer 299] Processing index 26
[GPU Rank 0 | Producer 298] Processing index 74
Batch processed:Batch processed:  13 for rank: 213
 for rank: 3
Queue size for GPU 2: 20 samples
Queue size for GPU 3: 20 samples
Batch processed: 13 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 13 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 0 | Producer 294] Processing index 134[GPU Rank 1 | Producer 297] Processing index 23

[GPU Rank 2 | Producer 303] Processing index 108
[GPU Rank 3] Processed batch 14.
[GPU Rank 0] Processed batch 14.
[GPU Rank 2] Processed batch 14.
[GPU Rank 1] Processed batch 14.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 3 | Producer 296] Processing index 60
tensor(0.3030, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.4232, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2660, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3123, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 294] Processing index 59
[GPU Rank 3 | Producer 296] Processing index 126
[GPU Rank 2 | Producer 303] Processing index 137
[GPU Rank 1 | Producer 297] Processing index 127
Batch processed: 14 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 14 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 14 for rank: Batch processed:1 
14 for rank: 0
Queue size for GPU 1: 20 samples
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 299] Processing index 104[GPU Rank 3 | Producer 304] Processing index 32
[GPU Rank 1 | Producer 305] Processing index 78[GPU Rank 0 | Producer 306] Processing index 14


[GPU Rank 1] Processed batch 15.
[GPU Rank 0] Processed batch 15.
[GPU Rank 2] Processed batch 15.
[GPU Rank 3] Processed batch 15.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2197, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3060, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2830, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3087, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 112
[GPU Rank 2 | Producer 299] Processing index 83
[GPU Rank 3 | Producer 304] Processing index 161
Batch processed: 15 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 15 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 15 for rank: 3
Batch processed:Queue size for GPU 3: 20 samples 
15 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 295] Processing index 141[GPU Rank 0 | Producer 294] Processing index 8
[GPU Rank 1 | Producer 293] Processing index 150
[GPU Rank 3 | Producer 296] Processing index 87

[GPU Rank 2] Processed batch 16.
[GPU Rank 0] Processed batch 16.
[GPU Rank 1] Processed batch 16.
[GPU Rank 3] Processed batch 16.
[GPU Rank 0 | Producer 306] Processing index 80
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2734, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3473, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3322, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2534, device='cuda:3', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 0 | Producer 294] Processing index 6
[GPU Rank 2 | Producer 295] Processing index 129
[GPU Rank 1 | Producer 293] Processing index 128
Batch processed: 16 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 16 for rank: 0
Batch processed: 16 for rank: Queue size for GPU 0: 20 samplesBatch processed:3

 16 for rank: 1
Queue size for GPU 3: 20 samples
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 303] Processing index 87
[GPU Rank 0 | Producer 302] Processing index 57[GPU Rank 3 | Producer 291] Processing index 146[GPU Rank 1 | Producer 305] Processing index 162


[GPU Rank 2] Processed batch 17.
[GPU Rank 1] Processed batch 17.
[GPU Rank 3] Processed batch 17.
[GPU Rank 0] Processed batch 17.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3944, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3126, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2796, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2813, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 303] Processing index 136
[GPU Rank 1 | Producer 305] Processing index 26
[GPU Rank 3 | Producer 291] Processing index 46
Batch processed: 17 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: Batch processed:17  for rank: 3
17 for rank: 1
Batch processed: 17Queue size for GPU 3: 20 samples 
for rank: 0
Queue size for GPU 1: 20 samples
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 295] Processing index 160
[GPU Rank 1 | Producer 297] Processing index 136[GPU Rank 3 | Producer 296] Processing index 144

[GPU Rank 2] Processed batch 18.
[GPU Rank 0] Processed batch 18.
[GPU Rank 1] Processed batch 18.
[GPU Rank 3] Processed batch 18.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 141
[GPU Rank 0 | Producer 298] Processing index 111
tensor(0.2953, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3682, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3093, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3103, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 295] Processing index 143
[GPU Rank 3 | Producer 296] Processing index 35
[GPU Rank 1 | Producer 297] Processing index 16
[GPU Rank 0 | Producer 298] Processing index 62
Batch processed: 18 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 18 Batch processed:for rank: Batch processed: 118
  for rank:18 3 for rank:Queue size for GPU 1: 20 samples
 
0
Queue size for GPU 3: 20 samples
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 303] Processing index 113[GPU Rank 1 | Producer 293] Processing index 122
[GPU Rank 3 | Producer 304] Processing index 17

[GPU Rank 0 | Producer 306] Processing index 38
[GPU Rank 2] Processed batch 19.
[GPU Rank 1] Processed batch 19.
[GPU Rank 3] Processed batch 19.
[GPU Rank 0] Processed batch 19.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3194, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3330, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3309, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3291, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 293] Processing index 120
[GPU Rank 2 | Producer 303] Processing index 74
[GPU Rank 3 | Producer 304] Processing index 88
Batch processed: 19 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 19 for rank: 3
Batch processed:Queue size for GPU 3: 20 samples
 19 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 19 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 296] Processing index 124
[GPU Rank 2 | Producer 295] Processing index 114[GPU Rank 0 | Producer 298] Processing index 165

[GPU Rank 1 | Producer 297] Processing index 0
[GPU Rank 1] Processed batch 20.
[GPU Rank 2] Processed batch 20.
[GPU Rank 3] Processed batch 20.
[GPU Rank 0] Processed batch 20.
loss_value in pytorch loss_value in pytorchloss_value in pytorch  loss_value in pytorch [GPU Rank 0 | Producer 306] Processing index 0
tensor(0.2954, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3440, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2640, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3453, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 47
[GPU Rank 2 | Producer 295] Processing index 41
[GPU Rank 1 | Producer 297] Processing index 125
[GPU Rank 0 | Producer 298] Processing index 28
Batch processed: 20 for rank: 2
Batch processed:Queue size for GPU 2: 20 samples 
20 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: Batch processed:20  for rank:20  0for rank:
 3
Queue size for GPU 0: 20 samples
Queue size for GPU 3: 20 samples
[GPU Rank 2 | Producer 303] Processing index 20[GPU Rank 1 | Producer 293] Processing index 158[GPU Rank 3 | Producer 300] Processing index 19

[GPU Rank 0 | Producer 294] Processing index 43

[GPU Rank 2] Processed batch 21.
[GPU Rank 3] Processed batch 21.
[GPU Rank 1] Processed batch 21.
[GPU Rank 0] Processed batch 21.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3097, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3241, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2951, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3835, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 51
[GPU Rank 1 | Producer 293] Processing index 92
Batch processed: 21 for rank: 2
Batch processed:RAISE StopIteration
 21 for rank: 0
RAISE StopIteration
Batch processed: 21 for rank: 3
RAISE StopIteration
Batch processed: 21 for rank: 1
RAISE StopIteration
Batch processed: 0 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 2 | Producer 295] Processing index 63Batch processed: 0 for rank: 3
Queue size for GPU 3: 20 samples
:::MLLOG {"namespace": "", "time_ms": 1743705212064, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 106, "epoch_num": 7, "current_lr": 0.56003}}

Batch processed: 0 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 296] Processing index 137
[GPU Rank 1 | Producer 305] Processing index 8:::MLLOG {"namespace": "", "time_ms": 1743705212065, "event_type": "INTERVAL_END", "key": "block_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 135, "first_epoch_num": 7, "epoch_count": 1}}
[GPU Rank 2] Processed batch 1.

:::MLLOG {"namespace": "", "time_ms": 1743705212065, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 66, "first_epoch_num": 8, "epoch_count": 1}}
:::MLLOG {"namespace": "", "time_ms": 1743705212066, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 68, "epoch_num": 8}}
Batch processed: 0 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 0 | Producer 294] Processing index 75
[GPU Rank 0 | Producer 298] Processing index 151[GPU Rank 1] Processed batch 1.
[GPU Rank 3] Processed batch 1.

[GPU Rank 0] Processed batch 1.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 303] Processing index 49
tensor(0.3248, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2344, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2508, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3723, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 298] Processing index 76
[GPU Rank 1 | Producer 305] Processing index 64
[GPU Rank 2 | Producer 295] Processing index 107
Batch processed: 1 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed:Batch processed:  1 1for rank:  3
for rank: 1
Queue size for GPU 3: 20 samples
Batch processed: Queue size for GPU 1: 20 samples1
 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 299] Processing index 65
[GPU Rank 1 | Producer 301] Processing index 14[GPU Rank 0 | Producer 294] Processing index 106
[GPU Rank 3 | Producer 291] Processing index 11

[GPU Rank 3] Processed batch 2.
[GPU Rank 2] Processed batch 2.
[GPU Rank 0] Processed batch 2.
[GPU Rank 1] Processed batch 2.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2716, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2974, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2777, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3311, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 82
[GPU Rank 3 | Producer 291] Processing index 136
[GPU Rank 0 | Producer 294] Processing index 72
[GPU Rank 2 | Producer 299] Processing index 60
[GPU Rank 1 | Producer 301] Processing index 145
Batch processed: 2 for rank: 2
Batch processed:Queue size for GPU 2: 20 samples
 2 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 2 for rank: 1
Queue size for GPU 1: 20 samplesBatch processed:
 2 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 295] Processing index 22
[GPU Rank 1 | Producer 305] Processing index 55
[GPU Rank 0 | Producer 298] Processing index 93
[GPU Rank 3 | Producer 304] Processing index 158
[GPU Rank 3] Processed batch 3.
[GPU Rank 0] Processed batch 3.
[GPU Rank 2] Processed batch 3.
[GPU Rank 1] Processed batch 3.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2840, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2421, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3844, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3017, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 133
[GPU Rank 0 | Producer 298] Processing index 17
[GPU Rank 2 | Producer 295] Processing index 164
[GPU Rank 3 | Producer 304] Processing index 99
Batch processed: 3 for rank:Batch processed: 3
 3 for rank: 2
Batch processed: Queue size for GPU 3: 20 samples3
 for rank: 1
Batch processed: Queue size for GPU 2: 20 samples3
 for rank: 0Queue size for GPU 1: 20 samples

Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 291] Processing index 90[GPU Rank 2 | Producer 299] Processing index 30
[GPU Rank 1 | Producer 293] Processing index 157

[GPU Rank 0 | Producer 306] Processing index 102
[GPU Rank 3] Processed batch 4.
[GPU Rank 2] Processed batch 4.
[GPU Rank 0] Processed batch 4.
[GPU Rank 1] Processed batch 4.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.4850, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2775, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2125, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2986, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 291] Processing index 153
[GPU Rank 0 | Producer 306] Processing index 152
[GPU Rank 1 | Producer 293] Processing index 94
[GPU Rank 2 | Producer 299] Processing index 50
Batch processed: 4 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 4 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 4 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 4[GPU Rank 3 | Producer 300] Processing index 16 for rank: 
1
Queue size for GPU 1: 20 samples
[GPU Rank 0 | Producer 298] Processing index 4[GPU Rank 2 | Producer 292] Processing index 72

[GPU Rank 1 | Producer 305] Processing index 110
[GPU Rank 2] Processed batch 5.
[GPU Rank 3] Processed batch 5.
[GPU Rank 0] Processed batch 5.
[GPU Rank 1] Processed batch 5.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2450, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3041, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2965, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4571, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 146
[GPU Rank 3 | Producer 300] Processing index 43
[GPU Rank 0 | Producer 298] Processing index 74
[GPU Rank 2 | Producer 292] Processing index 43
Batch processed: 5 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 5 for rank: 3
Queue size for GPU 3: 20 samplesBatch processed:
 5 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 5 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 291] Processing index 65
[GPU Rank 1 | Producer 293] Processing index 164[GPU Rank 2 | Producer 299] Processing index 103[GPU Rank 0 | Producer 306] Processing index 45


[GPU Rank 2] Processed batch 6.
[GPU Rank 3] Processed batch 6.
[GPU Rank 1] Processed batch 6.
[GPU Rank 0] Processed batch 6.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 299] Processing index 156
tensor(0.3541, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2686, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3230, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3385, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 306] Processing index 63
[GPU Rank 1 | Producer 293] Processing index 77
[GPU Rank 3 | Producer 291] Processing index 154
Batch processed: 6 for rank: 2Batch processed:
 6 Queue size for GPU 2: 20 samplesfor rank:
 0
Queue size for GPU 0: 20 samples
Batch processed: 6 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 6 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 0 | Producer 298] Processing index 111[GPU Rank 1 | Producer 305] Processing index 78
[GPU Rank 3 | Producer 300] Processing index 8
[GPU Rank 2 | Producer 303] Processing index 38

[GPU Rank 2] Processed batch 7.
[GPU Rank 0] Processed batch 7.
[GPU Rank 3] Processed batch 7.
[GPU Rank 1] Processed batch 7.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3926, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2558, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2884, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3288, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 29
[GPU Rank 1 | Producer 305] Processing index 112
[GPU Rank 0 | Producer 298] Processing index 62
Batch processed: 7 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: Batch processed:Batch processed:7   7for rank:7   3for rank: 
for rank:1 
0
Queue size for GPU 1: 20 samplesQueue size for GPU 3: 20 samples

Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 292] Processing index 69[GPU Rank 1 | Producer 293] Processing index 150[GPU Rank 0 | Producer 306] Processing index 46


[GPU Rank 3 | Producer 296] Processing index 60
[GPU Rank 2] Processed batch 8.
[GPU Rank 1] Processed batch 8.
[GPU Rank 3] Processed batch 8.
[GPU Rank 0] Processed batch 8.
loss_value in pytorch loss_value in pytorchloss_value in pytorch  loss_value in pytorch [GPU Rank 2 | Producer 303] Processing index 145
tensor(0.3359, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.4591, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.5570, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2312, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 292] Processing index 31
[GPU Rank 3 | Producer 296] Processing index 126
[GPU Rank 1 | Producer 293] Processing index 128
[GPU Rank 0 | Producer 306] Processing index 121
Batch processed: 8 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 8 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 8 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 8 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 1 | Producer 305] Processing index 162[GPU Rank 3 | Producer 300] Processing index 3
[GPU Rank 0 | Producer 298] Processing index 165

[GPU Rank 2 | Producer 295] Processing index 141
[GPU Rank 3] Processed batch 9.
[GPU Rank 0] Processed batch 9.
[GPU Rank 1] Processed batch 9.
[GPU Rank 2] Processed batch 9.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2571, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2109, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3214, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3309, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 26
[GPU Rank 3 | Producer 300] Processing index 94
[GPU Rank 0 | Producer 298] Processing index 28
[GPU Rank 2 | Producer 295] Processing index 129
Batch processed: 9 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 9 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 9Batch processed: for rank:  1
9 for rank: 3
Queue size for GPU 1: 20 samples
Queue size for GPU 3: 20 samples
[GPU Rank 2 | Producer 292] Processing index 125[GPU Rank 1 | Producer 301] Processing index 35
[GPU Rank 3 | Producer 296] Processing index 87

[GPU Rank 2] Processed batch 10.
[GPU Rank 0 | Producer 302] Processing index 110
[GPU Rank 0] Processed batch 10.
[GPU Rank 3] Processed batch 10.
[GPU Rank 1] Processed batch 10.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.4026, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2563, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2756, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 292] Processing index 106
tensor(0.4056, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 0 | Producer 302] Processing index 65
[GPU Rank 1 | Producer 301] Processing index 115
Batch processed: 10 Batch processed:for rank: Batch processed: 2 
10 10for rank: Batch processed: for rank:3  Queue size for GPU 2: 20 samples
0
10
 for rank:Queue size for GPU 3: 20 samples 
1Queue size for GPU 0: 20 samples

Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 300] Processing index 86[GPU Rank 2 | Producer 295] Processing index 160

[GPU Rank 0 | Producer 298] Processing index 151
[GPU Rank 1 | Producer 293] Processing index 122
[GPU Rank 2] Processed batch 11.
[GPU Rank 0] Processed batch 11.
[GPU Rank 3] Processed batch 11.
[GPU Rank 1] Processed batch 11.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2854, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.4353, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1805, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.3385, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 0
[GPU Rank 1 | Producer 293] Processing index 120
[GPU Rank 0 | Producer 298] Processing index 76
[GPU Rank 2 | Producer 295] Processing index 143
Batch processed: 11 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 11 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 11 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 296] Processing index 144
Batch processed: 11 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 1 | Producer 297] Processing index 152
[GPU Rank 2 | Producer 299] Processing index 9
[GPU Rank 0 | Producer 302] Processing index 97
[GPU Rank 3] Processed batch 12.
[GPU Rank 1] Processed batch 12.
[GPU Rank 2] Processed batch 12.
[GPU Rank 0] Processed batch 12.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2823, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3054, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3580, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3215, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 101
[GPU Rank 1 | Producer 297] Processing index 46
[GPU Rank 3 | Producer 296] Processing index 35
[GPU Rank 2 | Producer 299] Processing index 26
Batch processed: 12 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 12 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 12 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 12 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 300] Processing index 19[GPU Rank 1 | Producer 305] Processing index 8[GPU Rank 0 | Producer 298] Processing index 93[GPU Rank 2 | Producer 295] Processing index 114



[GPU Rank 2] Processed batch 13.
[GPU Rank 3] Processed batch 13.
[GPU Rank 1] Processed batch 13.
[GPU Rank 0] Processed batch 13.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3317, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3039, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2824, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4190, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 64
[GPU Rank 3 | Producer 300] Processing index 51
[GPU Rank 2 | Producer 295] Processing index 41
[GPU Rank 0 | Producer 298] Processing index 17
Batch processed: 13 for rank: 2
Batch processed: Queue size for GPU 2: 20 samples13
 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: Batch processed:13  13for rank:  for rank: 31

Queue size for GPU 1: 20 samples
Queue size for GPU 3: 20 samples
[GPU Rank 2 | Producer 292] Processing index 152[GPU Rank 0 | Producer 302] Processing index 68
[GPU Rank 1 | Producer 301] Processing index 63
[GPU Rank 3 | Producer 291] Processing index 54

[GPU Rank 2] Processed batch 14.
[GPU Rank 0] Processed batch 14.
[GPU Rank 3] Processed batch 14.
[GPU Rank 1] Processed batch 14.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3722, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2804, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3470, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4284, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 114
[GPU Rank 1 | Producer 301] Processing index 143
[GPU Rank 3 | Producer 291] Processing index 106
[GPU Rank 2 | Producer 292] Processing index 35
Batch processed: 14 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed:Batch processed: 14  for rank:14  0for rank:
 3
Batch processed:Queue size for GPU 3: 20 samples
 14 for rank: 1
Queue size for GPU 1: 20 samplesQueue size for GPU 0: 20 samples

[GPU Rank 2 | Producer 295] Processing index 63[GPU Rank 3 | Producer 304] Processing index 74

[GPU Rank 1 | Producer 305] Processing index 55[GPU Rank 0 | Producer 298] Processing index 4

[GPU Rank 3] Processed batch 15.
[GPU Rank 1] Processed batch 15.
[GPU Rank 2] Processed batch 15.
[GPU Rank 0] Processed batch 15.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3016, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2637, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2626, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3023, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 133
[GPU Rank 2 | Producer 295] Processing index 107
[GPU Rank 3 | Producer 304] Processing index 23
[GPU Rank 0 | Producer 298] Processing index 74
Batch processed: 15Batch processed: for rank:  315
 for rank: Batch processed:1Queue size for GPU 3: 20 samples

 15 Queue size for GPU 1: 20 samplesfor rank:
 2
Queue size for GPU 2: 20 samples
Batch processed:[GPU Rank 1 | Producer 301] Processing index 19 
15 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 299] Processing index 104
[GPU Rank 3 | Producer 296] Processing index 124
[GPU Rank 0 | Producer 302] Processing index 86
[GPU Rank 3] Processed batch 16.
[GPU Rank 1] Processed batch 16.
[GPU Rank 2] Processed batch 16.
[GPU Rank 0] Processed batch 16.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 145
tensor(0.2158, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2916, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4198, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3474, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 47
[GPU Rank 1 | Producer 301] Processing index 141
[GPU Rank 2 | Producer 299] Processing index 83
Batch processed: 16 for rank: Batch processed:2
 Batch processed:16 Queue size for GPU 2: 20 samples for rank:
 163 for rank:
 0
Queue size for GPU 0: 20 samples
Queue size for GPU 3: 20 samples
Batch processed: 16 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 0 | Producer 298] Processing index 111[GPU Rank 3 | Producer 304] Processing index 131[GPU Rank 2 | Producer 295] Processing index 22

[GPU Rank 1 | Producer 305] Processing index 110

[GPU Rank 3] Processed batch 17.
[GPU Rank 2] Processed batch 17.
[GPU Rank 1] Processed batch 17.
[GPU Rank 0] Processed batch 17.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2995, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.4050, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2438, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3655, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 146
[GPU Rank 0 | Producer 298] Processing index 62
[GPU Rank 2 | Producer 295] Processing index 164
[GPU Rank 3 | Producer 304] Processing index 52
Batch processed: 17 for rank: 2
Batch processed:Queue size for GPU 2: 20 samples
Batch processed: 17  for rank:17  1for rank:
 3
Queue size for GPU 1: 20 samples
Queue size for GPU 3: 20 samples
[GPU Rank 2 | Producer 292] Processing index 138
Batch processed: 17 for rank: 0
[GPU Rank 1 | Producer 301] Processing index 56
[GPU Rank 3 | Producer 296] Processing index 137Queue size for GPU 0: 20 samples

[GPU Rank 0 | Producer 302] Processing index 57
[GPU Rank 1] Processed batch 18.
[GPU Rank 2] Processed batch 18.
[GPU Rank 3] Processed batch 18.
[GPU Rank 0] Processed batch 18.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2761, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3000, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3072, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2562, device='cuda:3', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 301] Processing index 167
[GPU Rank 2 | Producer 292] Processing index 99
Batch processed: 18 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: Batch processed:Batch processed:18   for rank: 0
1818  for rank:for rank:  13

Queue size for GPU 0: 20 samples
Queue size for GPU 3: 20 samples
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 304] Processing index 32
[GPU Rank 0 | Producer 298] Processing index 165
[GPU Rank 1 | Producer 305] Processing index 78
[GPU Rank 2 | Producer 303] Processing index 108
[GPU Rank 2] Processed batch 19.
[GPU Rank 1] Processed batch 19.
[GPU Rank 3] Processed batch 19.
[GPU Rank 0] Processed batch 19.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 141
tensor(0.2951, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2876, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2918, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4761, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 82
[GPU Rank 1 | Producer 305] Processing index 112
[GPU Rank 3 | Producer 304] Processing index 161
[GPU Rank 0 | Producer 298] Processing index 28
[GPU Rank 2 | Producer 303] Processing index 137
Batch processed: 19 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 19Batch processed: for rank:  119
 for rank: 3
Batch processed:Queue size for GPU 1: 20 samples
 Queue size for GPU 3: 20 samples19
 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 0 | Producer 294] Processing index 166[GPU Rank 3 | Producer 291] Processing index 146
[GPU Rank 1 | Producer 297] Processing index 140

[GPU Rank 2 | Producer 299] Processing index 65
[GPU Rank 1] Processed batch 20.
[GPU Rank 3] Processed batch 20.
[GPU Rank 2] Processed batch 20.
[GPU Rank 0] Processed batch 20.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2452, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2932, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2919, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2865, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 297] Processing index 42
[GPU Rank 2 | Producer 299] Processing index 60
[GPU Rank 3 | Producer 291] Processing index 46
[GPU Rank 0 | Producer 294] Processing index 55
Batch processed: 20 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 20 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 20 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 20 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 0 | Producer 302] Processing index 110[GPU Rank 2 | Producer 295] Processing index 141
[GPU Rank 1 | Producer 305] Processing index 162
[GPU Rank 3 | Producer 304] Processing index 17

[GPU Rank 0] Processed batch 21.
[GPU Rank 2] Processed batch 21.
[GPU Rank 1] Processed batch 21.
[GPU Rank 3] Processed batch 21.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3133, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2559, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2912, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2712, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 65
[GPU Rank 1 | Producer 305] Processing index 26
[GPU Rank 3 | Producer 304] Processing index 88
[GPU Rank 2 | Producer 295] Processing index 129
Batch processed: 21 for rank: 2
RAISE StopIteration
Batch processed: Batch processed:21  for rank:21  0for rank:
 1RAISE StopIteration

RAISE StopIteration
Batch processed: 21 for rank: 3
RAISE StopIteration
:::MLLOG {"namespace": "", "time_ms": 1743705228626, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 106, "epoch_num": 8, "current_lr": 0.64002}}
:::MLLOG {"namespace": "", "time_ms": 1743705228628, "event_type": "INTERVAL_START", "key": "eval_start", "value": 8, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 115, "epoch_num": 8}}
Batch processed: 0 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 1 | Producer 309] Processing index 3
[GPU Rank 1] Processed batch 1.
I AM HERe to evaluate
Batch processed: 0 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 3 | Producer 308] Processing index 3
[GPU Rank 3] Processed batch 1.
I AM HERe to evaluate
Batch processed: 0 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 2] Processed batch 1.
I AM HERe to evaluate
Batch processed: 0 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 0 | Producer 310] Processing index 1
[GPU Rank 0] Processed batch 1.
I AM HERe to evaluate
[GPU Rank 2 | Producer 307] Processing index 3
Batch processed: 1 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 1] Processed batch 2.
I AM HERe to evaluate
[GPU Rank 1 | Producer 309] Processing index 4
Batch processed: 1 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 2] Processed batch 2.
I AM HERe to evaluate
[GPU Rank 2 | Producer 307] Processing index 4
Batch processed: 1 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 3] Processed batch 2.
I AM HERe to evaluate
Batch processed: 2 for rank: 2
RAISE StopIteration
[GPU Rank 3 | Producer 308] Processing index 4
Batch processed: 1 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 0] Processed batch 2.
I AM HERe to evaluate
[GPU Rank 0 | Producer 310] Processing index 2
Batch processed: 2 for rank: 1
RAISE StopIteration
Batch processed: 2 for rank: 0
RAISE StopIteration
Batch processed: 2 for rank: 3
RAISE StopIteration
Batch processed: 0 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 2 | Producer 303] Processing index 87
[GPU Rank 2] Processed batch 1.
:::MLLOG {"namespace": "", "time_ms": 1743705251053, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.17531946301460266, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 120, "epoch_num": 8}}
:::MLLOG {"namespace": "", "time_ms": 1743705251055, "event_type": "INTERVAL_END", "key": "eval_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 124, "epoch_num": 8}}
DLL 2025-04-03 18:34:11.056101 - 8.0 epoch : 8.0  L1 dice : 0.306306391954422  L2 dice : 0.04433254525065422  mean_dice : 0.17531946301460266  eval_loss : 0.47337546944618225  train_loss : 0.31513112783432007  TOP_epoch : 8.0  TOP_L1 dice : 0.306306391954422  TOP_L2 dice : 0.04433254525065422  TOP_mean_dice : 0.17531946301460266  TOP_eval_loss : 0.47337546944618225  TOP_train_loss : 0.31513112783432007 
Batch processed: 0 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 1 | Producer 297] Processing index 23
Batch processed: 0 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 3 | Producer 300] Processing index 16
loss_value in pytorch [GPU Rank 3] Processed batch 1.
[GPU Rank 1] Processed batch 1.
:::MLLOG {"namespace": "", "time_ms": 1743705251090, "event_type": "INTERVAL_END", "key": "block_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 135, "first_epoch_num": 8, "epoch_count": 1}}
:::MLLOG {"namespace": "", "time_ms": 1743705251090, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 66, "first_epoch_num": 9, "epoch_count": 1}}
:::MLLOG {"namespace": "", "time_ms": 1743705251091, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 68, "epoch_num": 9}}
Batch processed: 0 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 0 | Producer 306] Processing index 14
[GPU Rank 0] Processed batch 1.
loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3382, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3125, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3896, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2957, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 303] Processing index 136
[GPU Rank 3 | Producer 300] Processing index 43
[GPU Rank 1 | Producer 297] Processing index 127
[GPU Rank 0 | Producer 306] Processing index 80
Batch processed: 1 for rank: 0
Batch processed: 1Queue size for GPU 0: 20 samples 
for rank:Batch processed: 3
 1 for rank: Queue size for GPU 3: 20 samples2

Queue size for GPU 2: 20 samples
Batch processed: 1 for rank: 1
[GPU Rank 0 | Producer 302] Processing index 97Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 304] Processing index 158[GPU Rank 2 | Producer 295] Processing index 160

[GPU Rank 1 | Producer 305] Processing index 8

[GPU Rank 0] Processed batch 2.
[GPU Rank 3] Processed batch 2.
[GPU Rank 2] Processed batch 2.
[GPU Rank 1] Processed batch 2.
loss_value in pytorch loss_value in pytorchloss_value in pytorch  loss_value in pytorch tensor(0.4145, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3742, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2497, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.3053, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 64
[GPU Rank 0 | Producer 302] Processing index 101
[GPU Rank 2 | Producer 295] Processing index 143
[GPU Rank 3 | Producer 304] Processing index 99
Batch processed:Batch processed:  Batch processed:22   for rank:for rank: 2 3 0
for rank:
 2Queue size for GPU 3: 20 samples
Queue size for GPU 0: 20 samples

Queue size for GPU 2: 20 samples
Batch processed: 2 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 303] Processing index 113[GPU Rank 3 | Producer 300] Processing index 8
[GPU Rank 1 | Producer 301] Processing index 14
[GPU Rank 0 | Producer 294] Processing index 134

[GPU Rank 3] Processed batch 3.
[GPU Rank 2] Processed batch 3.
[GPU Rank 0] Processed batch 3.
[GPU Rank 1] Processed batch 3.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1911, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2849, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3275, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3406, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 29
[GPU Rank 2 | Producer 303] Processing index 74
[GPU Rank 0 | Producer 294] Processing index 59
[GPU Rank 1 | Producer 301] Processing index 145
Batch processed:Batch processed:  33  for rank:for rank:  30

Batch processed:Queue size for GPU 0: 20 samplesQueue size for GPU 3: 20 samples

 3 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 0 | Producer 302] Processing index 68
[GPU Rank 3 | Producer 296] Processing index 60
[GPU Rank 2 | Producer 295] Processing index 114Batch processed: 3 for rank: 1
Queue size for GPU 1: 20 samples

[GPU Rank 1 | Producer 305] Processing index 55
[GPU Rank 3] Processed batch 4.
[GPU Rank 0] Processed batch 4.
[GPU Rank 2] Processed batch 4.
[GPU Rank 1] Processed batch 4.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3877, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.4537, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2701, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.4554, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 114
[GPU Rank 1 | Producer 305] Processing index 133
[GPU Rank 2 | Producer 295] Processing index 41
[GPU Rank 3 | Producer 296] Processing index 126
Batch processed:Batch processed:  4 4for rank:  for rank:2 
3
Queue size for GPU 2: 20 samples
Queue size for GPU 3: 20 samples
Batch processed: 4 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 4 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 303] Processing index 20[GPU Rank 3 | Producer 300] Processing index 3
[GPU Rank 0 | Producer 294] Processing index 8
[GPU Rank 1 | Producer 293] Processing index 158

[GPU Rank 3] Processed batch 5.
[GPU Rank 2] Processed batch 5.
[GPU Rank 0] Processed batch 5.
[GPU Rank 1] Processed batch 5.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.4324, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.4291, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3506, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3005, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 294] Processing index 6
[GPU Rank 3 | Producer 300] Processing index 94
[GPU Rank 1 | Producer 293] Processing index 92
Batch processed: 5 Batch processed:for rank: 0 
5 for rank: 3Queue size for GPU 0: 20 samples

Queue size for GPU 3: 20 samples
Batch processed: 5 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 5 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 0 | Producer 302] Processing index 86
[GPU Rank 2 | Producer 295] Processing index 63[GPU Rank 3 | Producer 296] Processing index 87
[GPU Rank 1 | Producer 305] Processing index 110

[GPU Rank 3] Processed batch 6.
[GPU Rank 2] Processed batch 6.
[GPU Rank 0] Processed batch 6.
[GPU Rank 1] Processed batch 6.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 303] Processing index 49
[GPU Rank 0 | Producer 302] Processing index 145
tensor(0.3317, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2921, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3664, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.3584, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 1 | Producer 305] Processing index 146
[GPU Rank 2 | Producer 295] Processing index 107
Batch processed: 6 for rank: 2
Batch processed:Queue size for GPU 2: 20 samples
 Batch processed:6  for rank:6  0for rank:
 3
Queue size for GPU 0: 20 samples
Queue size for GPU 3: 20 samples
Batch processed: 6 [GPU Rank 2 | Producer 299] Processing index 30for rank: 1

Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 300] Processing index 86[GPU Rank 0 | Producer 306] Processing index 38[GPU Rank 1 | Producer 293] Processing index 157


[GPU Rank 2] Processed batch 7.
[GPU Rank 3] Processed batch 7.
[GPU Rank 0] Processed batch 7.
[GPU Rank 1] Processed batch 7.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 3 | Producer 300] Processing index 0
tensor(0.2665, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2364, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2870, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3431, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 293] Processing index 94
[GPU Rank 2 | Producer 299] Processing index 50
Batch processed: 7 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 7 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 7 for rank: 2
Batch processed: Queue size for GPU 2: 20 samples7
 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 296] Processing index 144[GPU Rank 0 | Producer 302] Processing index 57
[GPU Rank 2 | Producer 295] Processing index 22

[GPU Rank 1 | Producer 305] Processing index 78
[GPU Rank 3] Processed batch 8.
[GPU Rank 0] Processed batch 8.
[GPU Rank 2] Processed batch 8.
[GPU Rank 1] Processed batch 8.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 306] Processing index 0
tensor(0.2443, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2772, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3371, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.5060, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 112
[GPU Rank 3 | Producer 296] Processing index 35
[GPU Rank 2 | Producer 295] Processing index 164
Batch processed: 8 for rank: 2
Batch processed:Batch processed:Queue size for GPU 2: 20 samples
  88  for rank:for rank:  30

Queue size for GPU 3: 20 samplesQueue size for GPU 0: 20 samples

Batch processed: 8 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 292] Processing index 72[GPU Rank 1 | Producer 297] Processing index 136[GPU Rank 0 | Producer 306] Processing index 102
[GPU Rank 3 | Producer 291] Processing index 11


[GPU Rank 3] Processed batch 9.
[GPU Rank 1] Processed batch 9.
[GPU Rank 2] Processed batch 9.
[GPU Rank 0] Processed batch 9.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 141
tensor(0.2492, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2588, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3211, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2918, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 306] Processing index 152
[GPU Rank 3 | Producer 291] Processing index 136
[GPU Rank 1 | Producer 297] Processing index 16
[GPU Rank 2 | Producer 292] Processing index 43
Batch processed:Batch processed:  99  for rank:for rank:  30

Queue size for GPU 3: 20 samplesQueue size for GPU 0: 20 samples

Batch processed: 9 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 9 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 0 | Producer 298] Processing index 151
[GPU Rank 3 | Producer 296] Processing index 124
[GPU Rank 2 | Producer 303] Processing index 38
[GPU Rank 1 | Producer 305] Processing index 162
[GPU Rank 3] Processed batch 10.
[GPU Rank 2] Processed batch 10.
[GPU Rank 1] Processed batch 10.
[GPU Rank 0] Processed batch 10.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3504, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2561, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2667, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3288, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 47
[GPU Rank 1 | Producer 305] Processing index 26
[GPU Rank 0 | Producer 298] Processing index 76
Batch processed:Batch processed: Batch processed:10  10for rank:   for rank:310 
 0for rank:
 2Queue size for GPU 3: 20 samples

Queue size for GPU 0: 20 samples
Queue size for GPU 2: 20 samples
Batch processed: 10 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 299] Processing index 103[GPU Rank 3 | Producer 291] Processing index 90[GPU Rank 0 | Producer 302] Processing index 110[GPU Rank 1 | Producer 297] Processing index 0



[GPU Rank 3] Processed batch 11.
[GPU Rank 2] Processed batch 11.
[GPU Rank 1] Processed batch 11.
[GPU Rank 0] Processed batch 11.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 303] Processing index 145
tensor(0.2275, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.4207, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2632, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3263, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 291] Processing index 153
[GPU Rank 2 | Producer 299] Processing index 156
[GPU Rank 0 | Producer 302] Processing index 65
[GPU Rank 1 | Producer 297] Processing index 125
Batch processed: 11 for rank: 3Batch processed:
 11Queue size for GPU 3: 20 samples 
for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 11 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 11 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 296] Processing index 137[GPU Rank 2 | Producer 292] Processing index 69[GPU Rank 0 | Producer 298] Processing index 93


[GPU Rank 1 | Producer 305] Processing index 8
[GPU Rank 3] Processed batch 12.
[GPU Rank 2] Processed batch 12.
[GPU Rank 1] Processed batch 12.
[GPU Rank 0] Processed batch 12.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.4261, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3001, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2782, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2425, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 64
[GPU Rank 2 | Producer 292] Processing index 31
[GPU Rank 0 | Producer 298] Processing index 17
Batch processed: 12 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed:Batch processed:  12 12for rank:  for rank:0 3

Queue size for GPU 0: 20 samples
Queue size for GPU 3: 20 samples
Batch processed: 12 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 303] Processing index 108[GPU Rank 1 | Producer 301] Processing index 35

[GPU Rank 3 | Producer 291] Processing index 65[GPU Rank 0 | Producer 306] Processing index 45

[GPU Rank 2] Processed batch 13.
[GPU Rank 0] Processed batch 13.
[GPU Rank 3] Processed batch 13.
[GPU Rank 1] Processed batch 13.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2914, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5805, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3282, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2676, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 82
[GPU Rank 0 | Producer 306] Processing index 63
[GPU Rank 2 | Producer 303] Processing index 137
[GPU Rank 3 | Producer 291] Processing index 154
[GPU Rank 1 | Producer 301] Processing index 115
Batch processed: 13 for rank: Batch processed:3
 Queue size for GPU 3: 20 samples
13 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 13 for rank: 0
Batch processed: Queue size for GPU 0: 20 samples
13 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 292] Processing index 125[GPU Rank 3 | Producer 304] Processing index 74

[GPU Rank 1 | Producer 305] Processing index 55
[GPU Rank 0 | Producer 298] Processing index 4
[GPU Rank 2] Processed batch 14.
[GPU Rank 3] Processed batch 14.
[GPU Rank 0] Processed batch 14.
[GPU Rank 1] Processed batch 14.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2172, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2949, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2553, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2794, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 292] Processing index 106
[GPU Rank 1 | Producer 305] Processing index 133
[GPU Rank 3 | Producer 304] Processing index 23
[GPU Rank 0 | Producer 298] Processing index 74
Batch processed: 14 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 14 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 14 for rank: 0
Batch processed:Queue size for GPU 0: 20 samples 
14 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 296] Processing index 60
[GPU Rank 0 | Producer 302] Processing index 97[GPU Rank 1 | Producer 293] Processing index 164
[GPU Rank 2 | Producer 299] Processing index 9

[GPU Rank 1] Processed batch 15.
[GPU Rank 3] Processed batch 15.
[GPU Rank 2] Processed batch 15.
[GPU Rank 0] Processed batch 15.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2399, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2868, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2935, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3572, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 101
[GPU Rank 3 | Producer 296] Processing index 126
[GPU Rank 1 | Producer 293] Processing index 77
[GPU Rank 2 | Producer 299] Processing index 26
Batch processed: 15 for rank: 2
Batch processed:Queue size for GPU 2: 20 samples
 15 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 15Batch processed: for rank:  015
 for rank: 1
Queue size for GPU 1: 20 samplesQueue size for GPU 0: 20 samples

[GPU Rank 2 | Producer 303] Processing index 87
[GPU Rank 3 | Producer 300] Processing index 19[GPU Rank 1 | Producer 297] Processing index 152

[GPU Rank 0 | Producer 294] Processing index 43
[GPU Rank 2] Processed batch 16.[GPU Rank 3] Processed batch 16.

[GPU Rank 1] Processed batch 16.
[GPU Rank 0] Processed batch 16.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2948, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.4238, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2966, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2994, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 303] Processing index 136
[GPU Rank 3 | Producer 300] Processing index 51
[GPU Rank 1 | Producer 297] Processing index 46
Batch processed: 16 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 16 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 16 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: [GPU Rank 3 | Producer 296] Processing index 8716 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 299] Processing index 104[GPU Rank 1 | Producer 293] Processing index 150
[GPU Rank 0 | Producer 306] Processing index 46


[GPU Rank 2] Processed batch 17.
[GPU Rank 3] Processed batch 17.
[GPU Rank 0] Processed batch 17.
[GPU Rank 1] Processed batch 17.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 294] Processing index 75
tensor(0.2652, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2674, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1996, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3021, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 2 | Producer 299] Processing index 83
[GPU Rank 1 | Producer 293] Processing index 128
Batch processed: 17 for rank: Batch processed:2
 17 Queue size for GPU 2: 20 samplesfor rank: 
3
Queue size for GPU 3: 20 samples
Batch processed: 17 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 295] Processing index 141[GPU Rank 3 | Producer 300] Processing index 16
Batch processed: 17 for rank: 0
Queue size for GPU 0: 20 samples

[GPU Rank 1 | Producer 305] Processing index 110
[GPU Rank 0 | Producer 298] Processing index 111
[GPU Rank 3] Processed batch 18.
[GPU Rank 2] Processed batch 18.
[GPU Rank 1] Processed batch 18.
[GPU Rank 0] Processed batch 18.
[GPU Rank 0 | Producer 306] Processing index 121
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2880, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3271, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3173, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3762, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 43
[GPU Rank 1 | Producer 305] Processing index 146
[GPU Rank 0 | Producer 298] Processing index 62
[GPU Rank 2 | Producer 295] Processing index 129
Batch processed:Batch processed:  18 for rank: 2
18 for rank: Queue size for GPU 2: 20 samples3

Queue size for GPU 3: 20 samples
Batch processed: 18Batch processed: for rank:  1
18 for rank: 0
Queue size for GPU 1: 20 samples
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 299] Processing index 65
[GPU Rank 3 | Producer 296] Processing index 144
[GPU Rank 1 | Producer 301] Processing index 63[GPU Rank 0 | Producer 302] Processing index 68

[GPU Rank 3] Processed batch 19.
[GPU Rank 2] Processed batch 19.
[GPU Rank 0] Processed batch 19.
[GPU Rank 1] Processed batch 19.
loss_value in pytorchloss_value in pytorch  loss_value in pytorch loss_value in pytorch tensor(0.3712, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2395, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3114, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3331, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 114
[GPU Rank 1 | Producer 301] Processing index 143
[GPU Rank 3 | Producer 296] Processing index 35
[GPU Rank 2 | Producer 299] Processing index 60
Batch processed: 19 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed:Batch processed:  1919  for rank: for rank: 2
0
Queue size for GPU 2: 20 samples
Queue size for GPU 0: 20 samples
Batch processed: 19 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 304] Processing index 131
[GPU Rank 2 | Producer 303] Processing index 113[GPU Rank 1 | Producer 293] Processing index 122[GPU Rank 0 | Producer 294] Processing index 106


[GPU Rank 0] Processed batch 20.
[GPU Rank 2] Processed batch 20.
[GPU Rank 3] Processed batch 20.
[GPU Rank 1] Processed batch 20.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2481, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2240, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2712, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2884, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 293] Processing index 120
[GPU Rank 2 | Producer 303] Processing index 74
[GPU Rank 0 | Producer 294] Processing index 72
[GPU Rank 3 | Producer 304] Processing index 52
Batch processed:Batch processed:  20 for rank: 220
 for rank: 3
Queue size for GPU 2: 20 samples
Queue size for GPU 3: 20 samples
Batch processed: 20 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 20 for rank: 1
[GPU Rank 3 | Producer 296] Processing index 124Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 299] Processing index 30

[GPU Rank 1 | Producer 301] Processing index 19[GPU Rank 0 | Producer 306] Processing index 14

[GPU Rank 3] Processed batch 21.
[GPU Rank 2] Processed batch 21.
[GPU Rank 0] Processed batch 21.
[GPU Rank 1] Processed batch 21.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3696, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3171, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3093, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2803, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 47
[GPU Rank 1 | Producer 301] Processing index 141
[GPU Rank 2 | Producer 299] Processing index 50
[GPU Rank 0 | Producer 306] Processing index 80
Batch processed:Batch processed:  21 for rank:21  2for rank:
 3RAISE StopIteration

RAISE StopIteration
Batch processed: 21 for rank: 0
RAISE StopIteration
Batch processed: 21 for rank: 1
RAISE StopIteration
Batch processed: 0 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 2 | Producer 303] Processing index 20Batch processed: 0 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 0 for rank: 3
Queue size for GPU 3: 20 samples
:::MLLOG {"namespace": "", "time_ms": 1743705267582, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 106, "epoch_num": 9, "current_lr": 0.72001}}
[GPU Rank 1 | Producer 293] Processing index 158[GPU Rank 3 | Producer 300] Processing index 8


:::MLLOG {"namespace": "", "time_ms": 1743705267584, "event_type": "INTERVAL_END", "key": "block_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 135, "first_epoch_num": 9, "epoch_count": 1}}
[GPU Rank 2] Processed batch 1.
:::MLLOG {"namespace": "", "time_ms": 1743705267584, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 66, "first_epoch_num": 10, "epoch_count": 1}}
:::MLLOG {"namespace": "", "time_ms": 1743705267584, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 68, "epoch_num": 10}}
[GPU Rank 1] Processed batch 1.
Batch processed: 0 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3] Processed batch 1.
[GPU Rank 0 | Producer 298] Processing index 165
[GPU Rank 0] Processed batch 1.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2802, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3522, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3001, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3375, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 29
[GPU Rank 0 | Producer 298] Processing index 28
[GPU Rank 1 | Producer 293] Processing index 92
Batch processed: 1 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed:Batch processed: 1  for rank:1  0for rank:
 2
Queue size for GPU 2: 20 samples
Queue size for GPU 0: 20 samples
Batch processed: 1 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 296] Processing index 137[GPU Rank 2 | Producer 299] Processing index 103
[GPU Rank 0 | Producer 306] Processing index 38
[GPU Rank 1 | Producer 301] Processing index 56

[GPU Rank 2] Processed batch 2.
[GPU Rank 3] Processed batch 2.
[GPU Rank 0] Processed batch 2.
[GPU Rank 1] Processed batch 2.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 303] Processing index 49
[GPU Rank 2 | Producer 299] Processing index 156
tensor(0.3880, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2941, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2454, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3214, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 301] Processing index 167
Batch processed: 2 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 2 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 2 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 2 | Producer 295] Processing index 160Batch processed: 2 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 1 | Producer 305] Processing index 78[GPU Rank 3 | Producer 300] Processing index 3


[GPU Rank 0 | Producer 294] Processing index 166
[GPU Rank 3] Processed batch 3.
[GPU Rank 2] Processed batch 3.
[GPU Rank 1] Processed batch 3.
[GPU Rank 0] Processed batch 3.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 306] Processing index 0
tensor(0.2845, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2531, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3438, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2608, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 82
[GPU Rank 3 | Producer 300] Processing index 94
[GPU Rank 1 | Producer 305] Processing index 112
[GPU Rank 2 | Producer 295] Processing index 143
[GPU Rank 0 | Producer 294] Processing index 55
Batch processed: Batch processed:3 for rank:  2
3 for rank: Queue size for GPU 2: 20 samples0

Batch processed:Queue size for GPU 0: 20 samples 
3 for rank: 3
Queue size for GPU 3: 20 samplesBatch processed:
 3 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 1 | Producer 301] Processing index 14
[GPU Rank 3 | Producer 291] Processing index 54[GPU Rank 2 | Producer 303] Processing index 38

[GPU Rank 0 | Producer 306] Processing index 102
[GPU Rank 0] Processed batch 4.
[GPU Rank 1] Processed batch 4.
[GPU Rank 2] Processed batch 4.
[GPU Rank 3] Processed batch 4.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2753, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2780, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2466, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2232, device='cuda:3', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 306] Processing index 152
[GPU Rank 3 | Producer 291] Processing index 106
[GPU Rank 1 | Producer 301] Processing index 145
Batch processed: 4 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 4 for rank: 3
Queue size for GPU 3: 20 samplesBatch processed:
 Batch processed:4 for rank: 0
 Queue size for GPU 0: 20 samples
4 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 300] Processing index 86[GPU Rank 0 | Producer 294] Processing index 134[GPU Rank 1 | Producer 305] Processing index 162[GPU Rank 2 | Producer 295] Processing index 114



[GPU Rank 0] Processed batch 5.
[GPU Rank 3] Processed batch 5.
[GPU Rank 2] Processed batch 5.
[GPU Rank 1] Processed batch 5.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 303] Processing index 145
[GPU Rank 3 | Producer 300] Processing index 0
tensor(0.2170, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3126, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.4649, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3109, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 26
[GPU Rank 0 | Producer 294] Processing index 59
[GPU Rank 2 | Producer 295] Processing index 41
Batch processed: 5 for rank: 2
Batch processed:Queue size for GPU 2: 20 samples
 5 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 5 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 5 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 2 | Producer 299] Processing index 9[GPU Rank 0 | Producer 306] Processing index 45
[GPU Rank 1 | Producer 301] Processing index 35[GPU Rank 3 | Producer 291] Processing index 146


[GPU Rank 1] Processed batch 6.
[GPU Rank 2] Processed batch 6.
[GPU Rank 0] Processed batch 6.[GPU Rank 3] Processed batch 6.

loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2705, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3320, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4580, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2872, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 306] Processing index 63
[GPU Rank 3 | Producer 291] Processing index 46
[GPU Rank 1 | Producer 301] Processing index 115
[GPU Rank 2 | Producer 299] Processing index 26
Batch processed: 6 Batch processed:for rank: 3 
Batch processed:6  for rank:6  2
for rank: Queue size for GPU 3: 20 samples1

Queue size for GPU 1: 20 samplesQueue size for GPU 2: 20 samples

Batch processed: 6 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 0 | Producer 294] Processing index 8
[GPU Rank 3 | Producer 296] Processing index 60[GPU Rank 1 | Producer 293] Processing index 157

[GPU Rank 2 | Producer 295] Processing index 63
[GPU Rank 0] Processed batch 7.
[GPU Rank 1] Processed batch 7.
[GPU Rank 3] Processed batch 7.
[GPU Rank 2] Processed batch 7.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2486, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2728, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.4732, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2933, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 294] Processing index 6
[GPU Rank 3 | Producer 296] Processing index 126
[GPU Rank 2 | Producer 295] Processing index 107
[GPU Rank 1 | Producer 293] Processing index 94
Batch processed: 7 for rank: 2
Batch processed: Queue size for GPU 2: 20 samples
7 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: Batch processed:7  7 for rank:for rank: 3
 1
Queue size for GPU 3: 20 samples
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 292] Processing index 152
[GPU Rank 3 | Producer 291] Processing index 11[GPU Rank 0 | Producer 306] Processing index 46
[GPU Rank 1 | Producer 301] Processing index 63

[GPU Rank 1] Processed batch 8.
[GPU Rank 2] Processed batch 8.
[GPU Rank 0] Processed batch 8.
[GPU Rank 3] Processed batch 8.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2809, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.4432, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2431, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2737, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 291] Processing index 136
[GPU Rank 1 | Producer 301] Processing index 143
[GPU Rank 2 | Producer 292] Processing index 35
[GPU Rank 0 | Producer 306] Processing index 121
Batch processed: 8 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed:Batch processed:  88  for rank:for rank:  03

Queue size for GPU 3: 20 samples
Queue size for GPU 0: 20 samples
Batch processed: 8 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 295] Processing index 22
[GPU Rank 3 | Producer 296] Processing index 87[GPU Rank 0 | Producer 302] Processing index 86
[GPU Rank 1 | Producer 305] Processing index 8

[GPU Rank 2] Processed batch 9.
[GPU Rank 3] Processed batch 9.
[GPU Rank 0] Processed batch 9.
[GPU Rank 1] Processed batch 9.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 145
tensor(0.3068, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2635, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2460, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2819, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 1 | Producer 305] Processing index 64
[GPU Rank 2 | Producer 295] Processing index 164
Batch processed: 9 for rank: 2
Batch processed:Batch processed:Queue size for GPU 2: 20 samples  
99  for rank:for rank:  01

Queue size for GPU 1: 20 samples
Queue size for GPU 0: 20 samples
Batch processed: 9 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 2 | Producer 299] Processing index 104[GPU Rank 0 | Producer 306] Processing index 14[GPU Rank 1 | Producer 301] Processing index 19
[GPU Rank 3 | Producer 291] Processing index 90


[GPU Rank 1] Processed batch 10.
[GPU Rank 0] Processed batch 10.
[GPU Rank 2] Processed batch 10.
[GPU Rank 3] Processed batch 10.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.4106, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2735, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3240, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2887, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 291] Processing index 153
[GPU Rank 1 | Producer 301] Processing index 141
[GPU Rank 2 | Producer 299] Processing index 83
[GPU Rank 0 | Producer 306] Processing index 80
Batch processed: 10Batch processed: for rank:  010
 for rank: Queue size for GPU 0: 20 samples3

Queue size for GPU 3: 20 samples
Batch processed: 10 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 10 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 296] Processing index 144
[GPU Rank 2 | Producer 295] Processing index 141
[GPU Rank 0 | Producer 298] Processing index 151[GPU Rank 1 | Producer 297] Processing index 140

[GPU Rank 2] Processed batch 11.
[GPU Rank 1] Processed batch 11.
[GPU Rank 3] Processed batch 11.
[GPU Rank 0] Processed batch 11.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3457, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3075, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2779, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3221, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 297] Processing index 42
[GPU Rank 0 | Producer 298] Processing index 76
[GPU Rank 2 | Producer 295] Processing index 129
[GPU Rank 3 | Producer 296] Processing index 35
Batch processed: 11 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed:Batch processed:  11 for rank: 011
 for rank: 3Batch processed:
Queue size for GPU 0: 20 samples
 11 for rank: 1
Queue size for GPU 3: 20 samples
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 299] Processing index 65
[GPU Rank 1 | Producer 301] Processing index 56[GPU Rank 3 | Producer 291] Processing index 65
[GPU Rank 0 | Producer 306] Processing index 38

[GPU Rank 2] Processed batch 12.
[GPU Rank 1] Processed batch 12.
[GPU Rank 0] Processed batch 12.
[GPU Rank 3] Processed batch 12.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2556, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2461, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3028, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2436, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 301] Processing index 167
[GPU Rank 3 | Producer 291] Processing index 154
[GPU Rank 2 | Producer 299] Processing index 60
Batch processed: 12 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 12 for rank:Batch processed: 1 
Queue size for GPU 1: 20 samples
12 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 12 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 295] Processing index 160
[GPU Rank 0 | Producer 298] Processing index 93[GPU Rank 1 | Producer 297] Processing index 23

[GPU Rank 3 | Producer 304] Processing index 32
[GPU Rank 2] Processed batch 13.
[GPU Rank 1] Processed batch 13.
[GPU Rank 0] Processed batch 13.
[GPU Rank 3] Processed batch 13.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 306] Processing index 0
tensor(0.2244, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1988, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2446, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2946, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 295] Processing index 143
[GPU Rank 0 | Producer 298] Processing index 17
[GPU Rank 3 | Producer 304] Processing index 161
[GPU Rank 1 | Producer 297] Processing index 127
Batch processed:Batch processed:  Batch processed:1313 Batch processed:  for rank:for rank:13    2131for rank:
  
for rank:0 
3Queue size for GPU 2: 20 samples

Queue size for GPU 1: 20 samples
Queue size for GPU 0: 20 samples
Queue size for GPU 3: 20 samples
[GPU Rank 0 | Producer 294] Processing index 43[GPU Rank 1 | Producer 301] Processing index 14
[GPU Rank 2 | Producer 292] Processing index 138

[GPU Rank 3 | Producer 300] Processing index 19
[GPU Rank 1] Processed batch 14.
[GPU Rank 2] Processed batch 14.
[GPU Rank 0] Processed batch 14.
[GPU Rank 3] Processed batch 14.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2939, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1850, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2932, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3181, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 51
[GPU Rank 2 | Producer 292] Processing index 99
[GPU Rank 1 | Producer 301] Processing index 145
Batch processed: 14 for rank: 2
Batch processed:Batch processed: Queue size for GPU 2: 20 samples 
1414  for rank:for rank:  30

Queue size for GPU 3: 20 samples
Queue size for GPU 0: 20 samples
Batch processed: 14 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 295] Processing index 114
[GPU Rank 3 | Producer 296] Processing index 124[GPU Rank 1 | Producer 305] Processing index 55

[GPU Rank 0 | Producer 298] Processing index 4
[GPU Rank 3] Processed batch 15.
[GPU Rank 2] Processed batch 15.
[GPU Rank 0] Processed batch 15.
[GPU Rank 1] Processed batch 15.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 294] Processing index 75
tensor(0.2712, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2314, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2438, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2404, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 47
[GPU Rank 2 | Producer 295] Processing index 41
[GPU Rank 1 | Producer 305] Processing index 133
[GPU Rank 0 | Producer 298] Processing index 74
Batch processed:Batch processed:  1515 for rank:  for rank:2 
0
Queue size for GPU 2: 20 samples
Queue size for GPU 0: 20 samples
Batch processed: 15 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 15 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 299] Processing index 30[GPU Rank 0 | Producer 306] Processing index 102

[GPU Rank 3 | Producer 300] Processing index 16
[GPU Rank 1 | Producer 301] Processing index 35
[GPU Rank 1] Processed batch 16.
[GPU Rank 3] Processed batch 16.
[GPU Rank 0] Processed batch 16.
[GPU Rank 2] Processed batch 16.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2585, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2819, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2687, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2886, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 43
[GPU Rank 0 | Producer 306] Processing index 152
[GPU Rank 1 | Producer 301] Processing index 115
[GPU Rank 2 | Producer 299] Processing index 50
Batch processed: 16 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed:Batch processed: 16  for rank:16  2for rank: 3

Queue size for GPU 3: 20 samplesQueue size for GPU 2: 20 samples

Batch processed: 16 for rank: 1
[GPU Rank 0 | Producer 298] Processing index 111
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 296] Processing index 137[GPU Rank 2 | Producer 295] Processing index 63[GPU Rank 1 | Producer 293] Processing index 164


[GPU Rank 3] Processed batch 17.
[GPU Rank 1] Processed batch 17.
[GPU Rank 2] Processed batch 17.
[GPU Rank 0] Processed batch 17.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3806, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3094, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3194, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4599, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 293] Processing index 77
[GPU Rank 2 | Producer 295] Processing index 107
[GPU Rank 0 | Producer 298] Processing index 62
Batch processed:Batch processed:Batch processed:   171717  for rank: for rank: for rank: 3 0
2

Queue size for GPU 3: 20 samplesQueue size for GPU 0: 20 samples

Queue size for GPU 2: 20 samples
Batch processed: 17 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 291] Processing index 54
[GPU Rank 0 | Producer 306] Processing index 45
[GPU Rank 2 | Producer 303] Processing index 108[GPU Rank 1 | Producer 305] Processing index 110

[GPU Rank 2] Processed batch 18.
[GPU Rank 3] Processed batch 18.
[GPU Rank 0] Processed batch 18.
[GPU Rank 1] Processed batch 18.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2471, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2558, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2942, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3129, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 82
[GPU Rank 1 | Producer 305] Processing index 146
[GPU Rank 0 | Producer 306] Processing index 63
[GPU Rank 3 | Producer 291] Processing index 106
[GPU Rank 2 | Producer 303] Processing index 137
Batch processed: Batch processed:18 for rank:  2
18 for rank: 0Queue size for GPU 2: 20 samples

Batch processed: Queue size for GPU 0: 20 samples
18 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 18 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 295] Processing index 22[GPU Rank 0 | Producer 298] Processing index 165[GPU Rank 3 | Producer 304] Processing index 17
[GPU Rank 1 | Producer 297] Processing index 136


[GPU Rank 2] Processed batch 19.
[GPU Rank 0] Processed batch 19.
[GPU Rank 3] Processed batch 19.
[GPU Rank 1] Processed batch 19.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2945, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3165, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2764, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2862, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 304] Processing index 88
[GPU Rank 0 | Producer 298] Processing index 28
[GPU Rank 1 | Producer 297] Processing index 16
[GPU Rank 2 | Producer 295] Processing index 164
Batch processed:Batch processed:  1919  for rank:for rank:  30

Queue size for GPU 0: 20 samples
Queue size for GPU 3: 20 samples
Batch processed: 19 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 19 for rank: 1
[GPU Rank 3 | Producer 296] Processing index 60Queue size for GPU 1: 20 samples
[GPU Rank 0 | Producer 306] Processing index 46[GPU Rank 2 | Producer 292] Processing index 72


[GPU Rank 1 | Producer 305] Processing index 78
[GPU Rank 2] Processed batch 20.
[GPU Rank 0] Processed batch 20.
[GPU Rank 3] Processed batch 20.
[GPU Rank 1] Processed batch 20.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3077, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2525, device='cuda:3', grad_fn=<DivBackward0>)tensor(0.2698, device='cuda:0', grad_fn=<DivBackward0>)

tensor(0.2494, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 112
[GPU Rank 3 | Producer 296] Processing index 126
[GPU Rank 2 | Producer 292] Processing index 43
[GPU Rank 0 | Producer 306] Processing index 121
Batch processed: 20 for rank: 2Batch processed:
 Queue size for GPU 2: 20 samples20
 for rank: 0
Batch processed:Queue size for GPU 0: 20 samples 
20 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 20 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 303] Processing index 87[GPU Rank 3 | Producer 304] Processing index 158[GPU Rank 1 | Producer 297] Processing index 0

[GPU Rank 0 | Producer 298] Processing index 151

[GPU Rank 3] Processed batch 21.
[GPU Rank 1] Processed batch 21.
[GPU Rank 2] Processed batch 21.
[GPU Rank 0] Processed batch 21.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2503, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2361, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.5303, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2740, device='cuda:2', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 303] Processing index 136
[GPU Rank 1 | Producer 297] Processing index 125
[GPU Rank 0 | Producer 298] Processing index 76
[GPU Rank 3 | Producer 304] Processing index 99
Batch processed:Batch processed: Batch processed: 21 21 21 for rank: for rank: for rank: 0 23


RAISE StopIteration
RAISE StopIterationRAISE StopIteration

Batch processed: 21 for rank: 1
RAISE StopIteration
Batch processed: 0 for rank: 2
Batch processed:Queue size for GPU 2: 20 samples
 0 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 2 | Producer 299] Processing index 103[GPU Rank 3 | Producer 296] Processing index 87
:::MLLOG {"namespace": "", "time_ms": 1743705284149, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 106, "epoch_num": 10, "current_lr": 0.8}}

:::MLLOG {"namespace": "", "time_ms": 1743705284151, "event_type": "INTERVAL_END", "key": "block_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 135, "first_epoch_num": 10, "epoch_count": 1}}
Batch processed: 0 for rank: 1
Queue size for GPU 1: 20 samples
:::MLLOG {"namespace": "", "time_ms": 1743705284151, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 66, "first_epoch_num": 11, "epoch_count": 1}}
:::MLLOG {"namespace": "", "time_ms": 1743705284152, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 68, "epoch_num": 11}}
[GPU Rank 1 | Producer 305] Processing index 162Batch processed: 0 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 0 | Producer 302] Processing index 57
[GPU Rank 3] Processed batch 1.
[GPU Rank 2] Processed batch 1.

[GPU Rank 1] Processed batch 1.
[GPU Rank 0] Processed batch 1.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2586, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3905, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2312, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2695, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 299] Processing index 156
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 1 | Producer 305] Processing index 26
Batch processed: 1 for rank:Batch processed: 0Batch processed: 
1  for rank:1Queue size for GPU 0: 20 samples 
3 
for rank: 2
Queue size for GPU 3: 20 samples
Queue size for GPU 2: 20 samples
Batch processed: 1 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 304] Processing index 74[GPU Rank 0 | Producer 298] Processing index 93[GPU Rank 2 | Producer 303] Processing index 113


[GPU Rank 1 | Producer 293] Processing index 150
[GPU Rank 3] Processed batch 2.
[GPU Rank 0] Processed batch 2.
[GPU Rank 2] Processed batch 2.
[GPU Rank 1] Processed batch 2.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 141
tensor(0.2731, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3272, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3527, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2458, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 303] Processing index 74
[GPU Rank 3 | Producer 304] Processing index 23
[GPU Rank 0 | Producer 298] Processing index 17
[GPU Rank 1 | Producer 293] Processing index 128
Batch processed: 2 for rank: 0
Batch processed:Queue size for GPU 0: 20 samples
 2 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 2 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed:[GPU Rank 0 | Producer 294] Processing index 106 2 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 296] Processing index 144
[GPU Rank 2 | Producer 299] Processing index 9
[GPU Rank 1 | Producer 305] Processing index 8

[GPU Rank 3] Processed batch 3.
[GPU Rank 0] Processed batch 3.
[GPU Rank 2] Processed batch 3.
[GPU Rank 1] Processed batch 3.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.4291, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3461, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2604, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2824, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 64
[GPU Rank 3 | Producer 296] Processing index 35
[GPU Rank 2 | Producer 299] Processing index 26
[GPU Rank 0 | Producer 294] Processing index 72
Batch processed:Batch processed:  Batch processed:33   3for rank:for rank:   for rank:02 
3

Queue size for GPU 0: 20 samples
Queue size for GPU 2: 20 samples
Queue size for GPU 3: 20 samples
Batch processed: 3 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 0 | Producer 302] Processing index 110
[GPU Rank 3 | Producer 304] Processing index 131[GPU Rank 1 | Producer 293] Processing index 122
[GPU Rank 2 | Producer 292] Processing index 69

[GPU Rank 2] Processed batch 4.
[GPU Rank 3] Processed batch 4.
[GPU Rank 0] Processed batch 4.
[GPU Rank 1] Processed batch 4.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2904, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2954, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2575, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2674, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 65
[GPU Rank 1 | Producer 293] Processing index 120
[GPU Rank 2 | Producer 292] Processing index 31
[GPU Rank 3 | Producer 304] Processing index 52
Batch processed: Batch processed:4 for rank: 0 
4 for rank: Queue size for GPU 0: 20 samples2

Batch processed:Queue size for GPU 2: 20 samples
 4 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 4 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 299] Processing index 104
[GPU Rank 0 | Producer 306] Processing index 14[GPU Rank 1 | Producer 305] Processing index 55

[GPU Rank 3 | Producer 300] Processing index 8
[GPU Rank 3] Processed batch 5.
[GPU Rank 2] Processed batch 5.
[GPU Rank 0] Processed batch 5.
[GPU Rank 1] Processed batch 5.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3443, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2151, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2772, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.3131, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 29
[GPU Rank 1 | Producer 305] Processing index 133
[GPU Rank 2 | Producer 299] Processing index 83
[GPU Rank 0 | Producer 306] Processing index 80
Batch processed: 5 for rank: 2Batch processed:
 5 Queue size for GPU 2: 20 samplesfor rank:
 3
Batch processed: Queue size for GPU 3: 20 samples5
 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 5 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 303] Processing index 20[GPU Rank 3 | Producer 304] Processing index 32
[GPU Rank 0 | Producer 298] Processing index 4

[GPU Rank 1 | Producer 293] Processing index 158
[GPU Rank 3] Processed batch 6.
[GPU Rank 0] Processed batch 6.
[GPU Rank 2] Processed batch 6.
[GPU Rank 1] Processed batch 6.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2861, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2879, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2603, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2906, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 304] Processing index 161
[GPU Rank 1 | Producer 293] Processing index 92
[GPU Rank 0 | Producer 298] Processing index 74
Batch processed: 6 Batch processed:for rank: 3 
6 for rank: Queue size for GPU 3: 20 samples2

Queue size for GPU 2: 20 samplesBatch processed:
 6 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 291] Processing index 146[GPU Rank 2 | Producer 299] Processing index 65
[GPU Rank 0 | Producer 306] Processing index 38
Batch processed: 6 for rank: 1

Queue size for GPU 1: 20 samples
[GPU Rank 2] Processed batch 7.
[GPU Rank 1 | Producer 301] Processing index 63
[GPU Rank 3] Processed batch 7.
[GPU Rank 0] Processed batch 7.
[GPU Rank 1] Processed batch 7.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1977, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3642, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2642, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2369, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 303] Processing index 49
[GPU Rank 3 | Producer 291] Processing index 46
[GPU Rank 2 | Producer 299] Processing index 60
[GPU Rank 1 | Producer 301] Processing index 143
Batch processed: 7Batch processed:  for rank: 73 
for rank: 2
Queue size for GPU 3: 20 samples
Queue size for GPU 2: 20 samples
Batch processed: 7 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 7 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 304] Processing index 17[GPU Rank 0 | Producer 302] Processing index 97[GPU Rank 2 | Producer 295] Processing index 141[GPU Rank 1 | Producer 293] Processing index 157



[GPU Rank 3] Processed batch 8.
[GPU Rank 0] Processed batch 8.[GPU Rank 2] Processed batch 8.

[GPU Rank 1] Processed batch 8.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 306] Processing index 0
tensor(0.2734, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2692, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2580, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.3072, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 101
[GPU Rank 3 | Producer 304] Processing index 88
[GPU Rank 1 | Producer 293] Processing index 94
[GPU Rank 2 | Producer 295] Processing index 129
Batch processed:Batch processed:  88  for rank:for rank:  23

Queue size for GPU 2: 20 samples
Queue size for GPU 3: 20 samples
Batch processed: 8 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 8 for rank: 1
[GPU Rank 3 | Producer 300] Processing index 3
[GPU Rank 2 | Producer 303] Processing index 38Queue size for GPU 1: 20 samples
[GPU Rank 0 | Producer 294] Processing index 166

[GPU Rank 1 | Producer 297] Processing index 152
[GPU Rank 3] Processed batch 9.
[GPU Rank 2] Processed batch 9.
[GPU Rank 0] Processed batch 9.
[GPU Rank 1] Processed batch 9.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2467, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2483, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.4593, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3976, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 94
[GPU Rank 1 | Producer 297] Processing index 46
[GPU Rank 0 | Producer 294] Processing index 55
Batch processed: 9 for rank: 3
Batch processed: 9 for rank:Queue size for GPU 3: 20 samples 
2
Queue size for GPU 2: 20 samples
Batch processed: 9 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 9 for rank: 1
[GPU Rank 0 | Producer 302] Processing index 68
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 304] Processing index 158[GPU Rank 2 | Producer 295] Processing index 160

[GPU Rank 1 | Producer 293] Processing index 164
[GPU Rank 3] Processed batch 10.
[GPU Rank 2] Processed batch 10.
[GPU Rank 0] Processed batch 10.
[GPU Rank 1] Processed batch 10.
[GPU Rank 2 | Producer 303] Processing index 145
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2721, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2429, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2825, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.3485, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 114
[GPU Rank 1 | Producer 293] Processing index 77
[GPU Rank 2 | Producer 295] Processing index 143
[GPU Rank 3 | Producer 304] Processing index 99
Batch processed:Batch processed: 10 for rank: 2
 Batch processed:10 Queue size for GPU 2: 20 samplesfor rank: 
 103 
for rank: 0
Queue size for GPU 3: 20 samples
Queue size for GPU 0: 20 samples
Batch processed: [GPU Rank 2 | Producer 299] Processing index 30
10 for rank: 1
[GPU Rank 3 | Producer 296] Processing index 124Queue size for GPU 1: 20 samples

[GPU Rank 1 | Producer 301] Processing index 19[GPU Rank 0 | Producer 294] Processing index 134

[GPU Rank 3] Processed batch 11.
[GPU Rank 0] Processed batch 11.
[GPU Rank 2] Processed batch 11.
[GPU Rank 1] Processed batch 11.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.4507, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2946, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2300, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2746, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 301] Processing index 141
[GPU Rank 3 | Producer 296] Processing index 47
[GPU Rank 0 | Producer 294] Processing index 59
[GPU Rank 2 | Producer 299] Processing index 50
Batch processed:Batch processed: 11 for rank:  2
11 for rank: Queue size for GPU 2: 20 samples3

Queue size for GPU 3: 20 samples
Batch processed: 11 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 304] Processing index 74[GPU Rank 2 | Producer 295] Processing index 114Batch processed: 11 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 0 | Producer 302] Processing index 86


[GPU Rank 1 | Producer 293] Processing index 150
[GPU Rank 0] Processed batch 12.
[GPU Rank 2] Processed batch 12.
[GPU Rank 3] Processed batch 12.
[GPU Rank 1] Processed batch 12.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 145
tensor(0.5719, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.4663, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4784, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2820, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 295] Processing index 41
[GPU Rank 3 | Producer 304] Processing index 23
[GPU Rank 1 | Producer 293] Processing index 128
Batch processed: 12 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: Batch processed:12Batch processed:   for rank:12  122for rank:  
for rank:0 
1
Queue size for GPU 2: 20 samples
Queue size for GPU 0: 20 samplesQueue size for GPU 1: 20 samples

[GPU Rank 3 | Producer 300] Processing index 86
[GPU Rank 0 | Producer 294] Processing index 8
[GPU Rank 2 | Producer 303] Processing index 108
[GPU Rank 1 | Producer 301] Processing index 56
[GPU Rank 2] Processed batch 13.
[GPU Rank 3] Processed batch 13.
[GPU Rank 1] Processed batch 13.
[GPU Rank 0] Processed batch 13.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2865, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3299, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2977, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2849, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 0
[GPU Rank 0 | Producer 294] Processing index 6
[GPU Rank 1 | Producer 301] Processing index 167
[GPU Rank 2 | Producer 303] Processing index 137
Batch processed: 13 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed:Batch processed:  1313  for rank:for rank:  01

Queue size for GPU 0: 20 samples
Queue size for GPU 1: 20 samples
Batch processed: 13 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 2 | Producer 295] Processing index 63[GPU Rank 0 | Producer 302] Processing index 57
[GPU Rank 1 | Producer 293] Processing index 122
[GPU Rank 3 | Producer 304] Processing index 131

[GPU Rank 0] Processed batch 14.
[GPU Rank 1] Processed batch 14.
[GPU Rank 3] Processed batch 14.
[GPU Rank 2] Processed batch 14.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3783, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2547, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3456, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2672, device='cuda:2', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 293] Processing index 120
[GPU Rank 2 | Producer 295] Processing index 107
[GPU Rank 3 | Producer 304] Processing index 52
Batch processed: 14 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 14 Batch processed:for rank:  0
14 Queue size for GPU 0: 20 samplesfor rank:
 3
Queue size for GPU 3: 20 samples
Batch processed: 14 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 1 | Producer 301] Processing index 14[GPU Rank 3 | Producer 296] Processing index 137
[GPU Rank 2 | Producer 299] Processing index 103[GPU Rank 0 | Producer 306] Processing index 102


[GPU Rank 3] Processed batch 15.
[GPU Rank 1] Processed batch 15.
[GPU Rank 0] Processed batch 15.
[GPU Rank 2] Processed batch 15.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 141
tensor(0.3669, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2882, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3570, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2338, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 299] Processing index 156
[GPU Rank 0 | Producer 306] Processing index 152
[GPU Rank 1 | Producer 301] Processing index 145
Batch processed: 15 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 15 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 15 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 15 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 2 | Producer 303] Processing index 87[GPU Rank 0 | Producer 298] Processing index 111[GPU Rank 3 | Producer 304] Processing index 32


[GPU Rank 1 | Producer 293] Processing index 158
[GPU Rank 2] Processed batch 16.
[GPU Rank 3] Processed batch 16.
[GPU Rank 0] Processed batch 16.
[GPU Rank 1] Processed batch 16.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2296, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2767, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3620, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3073, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 303] Processing index 136
[GPU Rank 3 | Producer 296] Processing index 82
[GPU Rank 3 | Producer 304] Processing index 161
[GPU Rank 1 | Producer 293] Processing index 92
[GPU Rank 0 | Producer 298] Processing index 62
Batch processed: 16 for rank: 2
Queue size for GPU 2: 20 samplesBatch processed:
Batch processed:  1616  for rank:for rank:  01

Queue size for GPU 0: 20 samplesQueue size for GPU 1: 20 samples

Batch processed: 16 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 0 | Producer 302] Processing index 110[GPU Rank 1 | Producer 305] Processing index 110
[GPU Rank 3 | Producer 291] Processing index 11

[GPU Rank 2 | Producer 299] Processing index 9
[GPU Rank 0] Processed batch 17.
[GPU Rank 2] Processed batch 17.
[GPU Rank 1] Processed batch 17.
[GPU Rank 3] Processed batch 17.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2201, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2981, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2216, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.3007, device='cuda:3', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 65
[GPU Rank 1 | Producer 305] Processing index 146
[GPU Rank 3 | Producer 291] Processing index 136
[GPU Rank 2 | Producer 299] Processing index 26
Batch processed:Batch processed:  1717Batch processed:  for rank:for rank:   0117

 for rank: 2
Queue size for GPU 0: 20 samplesQueue size for GPU 1: 20 samples
Batch processed:
Queue size for GPU 2: 20 samples 
17 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 3 | Producer 304] Processing index 17[GPU Rank 1 | Producer 293] Processing index 157[GPU Rank 2 | Producer 295] Processing index 22
[GPU Rank 0 | Producer 294] Processing index 43


[GPU Rank 1] Processed batch 18.
[GPU Rank 0] Processed batch 18.
[GPU Rank 3] Processed batch 18.
[GPU Rank 2] Processed batch 18.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2417, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2671, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2359, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.4325, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 304] Processing index 88
[GPU Rank 1 | Producer 293] Processing index 94
[GPU Rank 2 | Producer 295] Processing index 164
Batch processed: 18 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed:Batch processed:  1818  for rank:for rank:  01

Queue size for GPU 0: 20 samplesQueue size for GPU 1: 20 samples

Batch processed: 18 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 2 | Producer 292] Processing index 125[GPU Rank 1 | Producer 305] Processing index 78

[GPU Rank 0 | Producer 306] Processing index 45
[GPU Rank 3 | Producer 291] Processing index 90
[GPU Rank 1] Processed batch 19.
[GPU Rank 0] Processed batch 19.
[GPU Rank 2] Processed batch 19.
[GPU Rank 3] Processed batch 19.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 294] Processing index 75
tensor(0.2740, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 292] Processing index 106
tensor(0.2185, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3490, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2856, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 291] Processing index 153
[GPU Rank 1 | Producer 305] Processing index 112
[GPU Rank 0 | Producer 306] Processing index 63
Batch processed:Batch processed:  1919  for rank:for rank:  01

Queue size for GPU 0: 20 samplesQueue size for GPU 1: 20 samples

Batch processed: 19 for rank: 2
Batch processed: Queue size for GPU 2: 20 samples19
 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 1 | Producer 293] Processing index 164
[GPU Rank 2 | Producer 303] Processing index 113
[GPU Rank 0 | Producer 294] Processing index 106
[GPU Rank 3 | Producer 296] Processing index 60
[GPU Rank 1] Processed batch 20.
[GPU Rank 0] Processed batch 20.
[GPU Rank 2] Processed batch 20.
[GPU Rank 3] Processed batch 20.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2695, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3846, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2527, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2494, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 303] Processing index 74
[GPU Rank 1 | Producer 293] Processing index 77
[GPU Rank 3 | Producer 296] Processing index 126
[GPU Rank 0 | Producer 294] Processing index 72
Batch processed: 20 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 20 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 20 for rank:Batch processed: 0
 20 for rank: 3
Queue size for GPU 0: 20 samplesQueue size for GPU 3: 20 samples

[GPU Rank 2 | Producer 292] Processing index 152
[GPU Rank 1 | Producer 305] Processing index 162
[GPU Rank 3 | Producer 291] Processing index 65[GPU Rank 0 | Producer 302] Processing index 97

[GPU Rank 2] Processed batch 21.
[GPU Rank 1] Processed batch 21.
[GPU Rank 3] Processed batch 21.
[GPU Rank 0] Processed batch 21.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3848, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3137, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2836, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2740, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 26
[GPU Rank 0 | Producer 302] Processing index 101
[GPU Rank 2 | Producer 292] Processing index 35
[GPU Rank 3 | Producer 291] Processing index 154
Batch processed: 21 Batch processed:for rank: 2 
RAISE StopIteration
21 for rank: 1
RAISE StopIteration
Batch processed: Batch processed:21  for rank:21  0for rank:
 3RAISE StopIteration

RAISE StopIteration
Batch processed: 0 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 0 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 303] Processing index 20
Batch processed: 0 for rank: 3
Queue size for GPU 3: 20 samples
:::MLLOG {"namespace": "", "time_ms": 1743705300717, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 106, "epoch_num": 11, "current_lr": 0.8}}
[GPU Rank 1 | Producer 293] Processing index 150
[GPU Rank 3 | Producer 296] Processing index 87
:::MLLOG {"namespace": "", "time_ms": 1743705300718, "event_type": "INTERVAL_END", "key": "block_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 135, "first_epoch_num": 11, "epoch_count": 1}}
:::MLLOG {"namespace": "", "time_ms": 1743705300719, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 66, "first_epoch_num": 12, "epoch_count": 1}}
:::MLLOG {"namespace": "", "time_ms": 1743705300719, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 68, "epoch_num": 12}}
[GPU Rank 3] Processed batch 1.
Batch processed: 0 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 2] Processed batch 1.
[GPU Rank 0 | Producer 298] Processing index 165[GPU Rank 1] Processed batch 1.

[GPU Rank 0] Processed batch 1.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2550, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2406, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2572, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3357, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 0 | Producer 298] Processing index 28
[GPU Rank 1 | Producer 293] Processing index 128
Batch processed:Batch processed:  11  for rank:for rank: 2 
1
Queue size for GPU 1: 20 samples
Queue size for GPU 2: 20 samples
Batch processed: 1 for rank: 0
Batch processed: 1 for rank: 3
Queue size for GPU 0: 20 samples
Queue size for GPU 3: 20 samples
[GPU Rank 1 | Producer 305] Processing index 8
[GPU Rank 2 | Producer 299] Processing index 104
[GPU Rank 3 | Producer 304] Processing index 158
[GPU Rank 0 | Producer 306] Processing index 46
[GPU Rank 1] Processed batch 2.
[GPU Rank 0] Processed batch 2.
[GPU Rank 2] Processed batch 2.
[GPU Rank 3] Processed batch 2.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 303] Processing index 49
tensor(0.2695, device='cuda:1', grad_fn=<DivBackward0>)tensor(0.2287, device='cuda:3', grad_fn=<DivBackward0>)

tensor(0.2712, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2709, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 64
[GPU Rank 2 | Producer 299] Processing index 83
[GPU Rank 3 | Producer 304] Processing index 99
[GPU Rank 0 | Producer 306] Processing index 121
Batch processed:Batch processed:  22  for rank:for rank:  21

Queue size for GPU 2: 20 samples
Queue size for GPU 1: 20 samples
Batch processed: 2 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 2 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 295] Processing index 141[GPU Rank 1 | Producer 293] Processing index 122[GPU Rank 3 | Producer 296] Processing index 144
[GPU Rank 0 | Producer 294] Processing index 166


[GPU Rank 3] Processed batch 3.
[GPU Rank 2] Processed batch 3.
[GPU Rank 1] Processed batch 3.
[GPU Rank 0] Processed batch 3.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2108, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2396, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3573, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2913, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 293] Processing index 120
[GPU Rank 3 | Producer 296] Processing index 35
[GPU Rank 2 | Producer 295] Processing index 129
[GPU Rank 0 | Producer 294] Processing index 55
Batch processed: 3 for rank: 1
Batch processed: Queue size for GPU 1: 20 samples3Batch processed:
 for rank:  23
 for rank: 3Queue size for GPU 2: 20 samples

Batch processed:Queue size for GPU 3: 20 samples
 3 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 1 | Producer 305] Processing index 55
[GPU Rank 2 | Producer 292] Processing index 138[GPU Rank 3 | Producer 291] Processing index 54
[GPU Rank 0 | Producer 302] Processing index 68

[GPU Rank 2] Processed batch 4.
[GPU Rank 0] Processed batch 4.
[GPU Rank 3] Processed batch 4.
[GPU Rank 1] Processed batch 4.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2854, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2809, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2279, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2688, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 133
[GPU Rank 0 | Producer 302] Processing index 114
[GPU Rank 3 | Producer 291] Processing index 106
[GPU Rank 2 | Producer 292] Processing index 99
Batch processed: 4 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 4 for rank: 1
Batch processed:Queue size for GPU 1: 20 samples
 4 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 4 for rank: 0
[GPU Rank 2 | Producer 295] Processing index 160Queue size for GPU 0: 20 samples
[GPU Rank 1 | Producer 293] Processing index 158[GPU Rank 3 | Producer 300] Processing index 19


[GPU Rank 0 | Producer 294] Processing index 134
[GPU Rank 2] Processed batch 5.
[GPU Rank 3] Processed batch 5.
[GPU Rank 1] Processed batch 5.
[GPU Rank 0] Processed batch 5.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2655, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5091, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2416, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2921, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 294] Processing index 59
[GPU Rank 2 | Producer 295] Processing index 143
[GPU Rank 3 | Producer 300] Processing index 51
[GPU Rank 1 | Producer 293] Processing index 92
Batch processed: 5 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 5 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 5 for rank: 1
Batch processed: 5 for rank: 0
Queue size for GPU 1: 20 samples
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 303] Processing index 38[GPU Rank 0 | Producer 302] Processing index 86[GPU Rank 1 | Producer 297] Processing index 140


[GPU Rank 3 | Producer 291] Processing index 146
[GPU Rank 2] Processed batch 6.
[GPU Rank 1] Processed batch 6.
[GPU Rank 3] Processed batch 6.
[GPU Rank 0] Processed batch 6.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 145
tensor(0.3398, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2551, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2995, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2709, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 297] Processing index 42
[GPU Rank 3 | Producer 291] Processing index 46
Batch processed: 6 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 6 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 6 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 6 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 2 | Producer 295] Processing index 114[GPU Rank 0 | Producer 294] Processing index 8[GPU Rank 3 | Producer 300] Processing index 16

[GPU Rank 1 | Producer 305] Processing index 110

[GPU Rank 1] Processed batch 7.
[GPU Rank 0] Processed batch 7.
[GPU Rank 2] Processed batch 7.
[GPU Rank 3] Processed batch 7.
[GPU Rank 2 | Producer 303] Processing index 145
loss_value in pytorch loss_value in pytorchloss_value in pytorch  loss_value in pytorch tensor(0.2493, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2462, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2231, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3852, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 294] Processing index 6
[GPU Rank 3 | Producer 300] Processing index 43
[GPU Rank 1 | Producer 305] Processing index 146
[GPU Rank 2 | Producer 295] Processing index 41
Batch processed: 7 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 7 for rank: Batch processed:0
 7 for rank: 1
Queue size for GPU 0: 20 samples
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 292] Processing index 72Batch processed: 7 for rank: 3
Queue size for GPU 3: 20 samples

[GPU Rank 1 | Producer 301] Processing index 35
[GPU Rank 0 | Producer 306] Processing index 14
[GPU Rank 3 | Producer 304] Processing index 74
[GPU Rank 2] Processed batch 8.
[GPU Rank 1] Processed batch 8.
[GPU Rank 0] Processed batch 8.
[GPU Rank 3] Processed batch 8.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2912, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2810, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2673, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1685, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 304] Processing index 23
[GPU Rank 1 | Producer 301] Processing index 115
[GPU Rank 2 | Producer 292] Processing index 43
[GPU Rank 0 | Producer 306] Processing index 80
Batch processed: 8 for rank: 2
Batch processed:Batch processed: Queue size for GPU 2: 20 samples8
  for rank:8  1for rank:
 0
Queue size for GPU 1: 20 samples
Queue size for GPU 0: 20 samples
Batch processed: 8 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 2 | Producer 295] Processing index 63[GPU Rank 1 | Producer 305] Processing index 78
[GPU Rank 0 | Producer 298] Processing index 151[GPU Rank 3 | Producer 296] Processing index 124


[GPU Rank 3] Processed batch 9.
[GPU Rank 1] Processed batch 9.
[GPU Rank 0] Processed batch 9.[GPU Rank 2] Processed batch 9.

loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2119, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3993, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3167, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2670, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 112
[GPU Rank 3 | Producer 296] Processing index 47
[GPU Rank 0 | Producer 298] Processing index 76
[GPU Rank 2 | Producer 295] Processing index 107
Batch processed: 9 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 9 for rank:Batch processed: 1
 9Batch processed:  for rank: 39
 for rank: 0Queue size for GPU 1: 20 samples

Queue size for GPU 3: 20 samples
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 299] Processing index 65
[GPU Rank 1 | Producer 297] Processing index 23[GPU Rank 0 | Producer 306] Processing index 38
[GPU Rank 3 | Producer 304] Processing index 131

[GPU Rank 1] Processed batch 10.
[GPU Rank 0] Processed batch 10.
[GPU Rank 2] Processed batch 10.
[GPU Rank 3] Processed batch 10.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2598, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2393, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2832, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2807, device='cuda:3', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 299] Processing index 60
[GPU Rank 1 | Producer 297] Processing index 127
[GPU Rank 3 | Producer 304] Processing index 52
Batch processed: 10 for rank: 2
Batch processed:Batch processed:Queue size for GPU 2: 20 samples  
1010  for rank:for rank:  01

Queue size for GPU 0: 20 samples
Queue size for GPU 1: 20 samples
Batch processed: 10 for rank: 3
[GPU Rank 2 | Producer 292] Processing index 69[GPU Rank 0 | Producer 298] Processing index 93Queue size for GPU 3: 20 samples

[GPU Rank 1 | Producer 305] Processing index 162
[GPU Rank 3 | Producer 296] Processing index 137

[GPU Rank 2] Processed batch 11.
[GPU Rank 1] Processed batch 11.
[GPU Rank 0] Processed batch 11.
[GPU Rank 3] Processed batch 11.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 306] Processing index 0
tensor(0.2890, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2787, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1619, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2940, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 26
[GPU Rank 2 | Producer 292] Processing index 31
[GPU Rank 0 | Producer 298] Processing index 17
Batch processed: 11 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: Batch processed: 1111  for rank:for rank:  1
3
Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

Batch processed: 11 for rank: 0
Queue size for GPU 0: 20 samples[GPU Rank 2 | Producer 299] Processing index 30
[GPU Rank 3 | Producer 291] Processing index 11[GPU Rank 1 | Producer 297] Processing index 136

[GPU Rank 0 | Producer 294] Processing index 43

[GPU Rank 2] Processed batch 12.
[GPU Rank 1] Processed batch 12.
[GPU Rank 3] Processed batch 12.
[GPU Rank 0] Processed batch 12.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2555, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2780, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2943, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.3293, device='cuda:3', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 82
[GPU Rank 3 | Producer 291] Processing index 136
[GPU Rank 1 | Producer 297] Processing index 16
[GPU Rank 2 | Producer 299] Processing index 50
Batch processed: 12 for rank: 0Batch processed:
 Batch processed:12Queue size for GPU 0: 20 samples  
for rank: 1
12 for rank: 3
Queue size for GPU 1: 20 samplesBatch processed:
 12 for rank: Queue size for GPU 3: 20 samples2

Queue size for GPU 2: 20 samples
[GPU Rank 3 | Producer 300] Processing index 8
[GPU Rank 2 | Producer 292] Processing index 125
[GPU Rank 0 | Producer 298] Processing index 4
[GPU Rank 1 | Producer 293] Processing index 157
[GPU Rank 0] Processed batch 13.
[GPU Rank 3] Processed batch 13.
[GPU Rank 2] Processed batch 13.
[GPU Rank 1] Processed batch 13.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 294] Processing index 75
tensor(0.2895, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2321, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2509, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2925, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 292] Processing index 106
[GPU Rank 3 | Producer 300] Processing index 29
[GPU Rank 1 | Producer 293] Processing index 94
[GPU Rank 0 | Producer 298] Processing index 74
Batch processed: 13 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 13 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 13 for rank:Batch processed: 3
 13 for rank: Queue size for GPU 3: 20 samples0

Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 303] Processing index 108[GPU Rank 1 | Producer 297] Processing index 0
[GPU Rank 3 | Producer 296] Processing index 60[GPU Rank 0 | Producer 294] Processing index 106


[GPU Rank 2] Processed batch 14.
[GPU Rank 1] Processed batch 14.
[GPU Rank 3] Processed batch 14.
[GPU Rank 0] Processed batch 14.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.4398, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2529, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3164, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2284, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 297] Processing index 125
[GPU Rank 3 | Producer 296] Processing index 126
[GPU Rank 2 | Producer 303] Processing index 137
[GPU Rank 0 | Producer 294] Processing index 72
Batch processed: 14 for rank: 2
Batch processed:Queue size for GPU 2: 20 samples
 14 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: Batch processed: 14 for rank: 314
 for rank: 1
Queue size for GPU 3: 20 samples
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 295] Processing index 22[GPU Rank 0 | Producer 302] Processing index 57[GPU Rank 3 | Producer 300] Processing index 3
[GPU Rank 1 | Producer 305] Processing index 8


[GPU Rank 0] Processed batch 15.
[GPU Rank 2] Processed batch 15.
[GPU Rank 1] Processed batch 15.
[GPU Rank 3] Processed batch 15.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.4323, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1691, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2468, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3541, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 64
[GPU Rank 3 | Producer 300] Processing index 94
[GPU Rank 2 | Producer 295] Processing index 164
Batch processed: 15Batch processed: for rank:  2
15 for rank:Batch processed: Queue size for GPU 2: 20 samples0

 15 for rank:Queue size for GPU 0: 20 samples 
1
Batch processed:Queue size for GPU 1: 20 samples
 15 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 2 | Producer 299] Processing index 103
[GPU Rank 0 | Producer 306] Processing index 102
[GPU Rank 3 | Producer 296] Processing index 87
[GPU Rank 1 | Producer 301] Processing index 63
[GPU Rank 1] Processed batch 16.
[GPU Rank 3] Processed batch 16.
[GPU Rank 2] Processed batch 16.
[GPU Rank 0] Processed batch 16.
loss_value in pytorchloss_value in pytorch  loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 141
tensor(0.2269, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3259, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2921, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2631, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 299] Processing index 156
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 0 | Producer 306] Processing index 152
[GPU Rank 1 | Producer 301] Processing index 143
Batch processed:Batch processed:  Batch processed:1616  16 for rank: for rank: for rank:  123


Queue size for GPU 1: 20 samplesQueue size for GPU 3: 20 samplesQueue size for GPU 2: 20 samples


Batch processed: 16 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 300] Processing index 86[GPU Rank 2 | Producer 292] Processing index 152
[GPU Rank 1 | Producer 305] Processing index 55

[GPU Rank 0 | Producer 298] Processing index 111
[GPU Rank 1] Processed batch 17.[GPU Rank 3] Processed batch 17.

[GPU Rank 2] Processed batch 17.
[GPU Rank 0] Processed batch 17.
loss_value in pytorch loss_value in pytorchloss_value in pytorch  loss_value in pytorch [GPU Rank 3 | Producer 300] Processing index 0
tensor(0.2838, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2378, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2399, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3376, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 133
[GPU Rank 2 | Producer 292] Processing index 35
[GPU Rank 0 | Producer 298] Processing index 62
Batch processed: Batch processed:17 for rank:  217
 for rank: 0Queue size for GPU 2: 20 samples

Batch processed: Queue size for GPU 0: 20 samples
Batch processed:17  for rank: 3
17 for rank: 1
Queue size for GPU 3: 20 samples
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 299] Processing index 9
[GPU Rank 0 | Producer 306] Processing index 45
[GPU Rank 1 | Producer 301] Processing index 19[GPU Rank 3 | Producer 296] Processing index 144

[GPU Rank 2] Processed batch 18.
[GPU Rank 1] Processed batch 18.
[GPU Rank 3] Processed batch 18.
[GPU Rank 0] Processed batch 18.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2547, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2122, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2865, device='cuda:1', grad_fn=<DivBackward0>)tensor(0.2395, device='cuda:2', grad_fn=<DivBackward0>)

[GPU Rank 1 | Producer 301] Processing index 141
[GPU Rank 0 | Producer 306] Processing index 63
[GPU Rank 3 | Producer 296] Processing index 35
[GPU Rank 2 | Producer 299] Processing index 26
Batch processed:Batch processed:Batch processed:Batch processed:    181818   for rank:for rank:18for rank:    30for rank:1

 
2
Queue size for GPU 0: 20 samples
Queue size for GPU 3: 20 samples
Queue size for GPU 1: 20 samplesQueue size for GPU 2: 20 samples

[GPU Rank 2 | Producer 303] Processing index 87
[GPU Rank 0 | Producer 302] Processing index 110[GPU Rank 3 | Producer 291] Processing index 90

[GPU Rank 1 | Producer 293] Processing index 164
[GPU Rank 0] Processed batch 19.
[GPU Rank 3] Processed batch 19.
[GPU Rank 2] Processed batch 19.
[GPU Rank 1] Processed batch 19.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1864, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2891, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3526, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3087, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 65
[GPU Rank 3 | Producer 291] Processing index 153
[GPU Rank 2 | Producer 303] Processing index 136
[GPU Rank 1 | Producer 293] Processing index 77
Batch processed:Batch processed: Batch processed: Batch processed: 19 19 for rank:19  for rank:19 0  for rank:3for rank:
  
12Queue size for GPU 0: 20 samples


Queue size for GPU 3: 20 samples
Queue size for GPU 1: 20 samples
Queue size for GPU 2: 20 samples
[GPU Rank 2 | Producer 299] Processing index 104
[GPU Rank 3 | Producer 304] Processing index 32[GPU Rank 0 | Producer 306] Processing index 46
[GPU Rank 1 | Producer 301] Processing index 56

[GPU Rank 3] Processed batch 20.[GPU Rank 1] Processed batch 20.[GPU Rank 2] Processed batch 20.


[GPU Rank 0] Processed batch 20.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2827, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2669, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2565, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1789, device='cuda:2', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 301] Processing index 167
[GPU Rank 2 | Producer 299] Processing index 83
[GPU Rank 3 | Producer 304] Processing index 161
[GPU Rank 0 | Producer 306] Processing index 121
Batch processed: 20 for rank: 0
Batch processed: Queue size for GPU 0: 20 samples
20 Batch processed:for rank:  1
20Queue size for GPU 1: 20 samples 
for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 20 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 1 | Producer 293] Processing index 150[GPU Rank 0 | Producer 302] Processing index 97
[GPU Rank 2 | Producer 303] Processing index 113[GPU Rank 3 | Producer 291] Processing index 65


[GPU Rank 0] Processed batch 21.
[GPU Rank 3] Processed batch 21.
[GPU Rank 1] Processed batch 21.
[GPU Rank 2] Processed batch 21.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2192, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2725, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2399, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5274, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 101
[GPU Rank 2 | Producer 303] Processing index 74
[GPU Rank 3 | Producer 291] Processing index 154
[GPU Rank 1 | Producer 293] Processing index 128
Batch processed: 21 for rank: 2Batch processed:
Batch processed:RAISE StopIteration 
 2121  for rank:for rank:  30
Batch processed:
RAISE StopIterationRAISE StopIteration 

21 for rank: 1
RAISE StopIteration
:::MLLOG {"namespace": "", "time_ms": 1743705317267, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 106, "epoch_num": 12, "current_lr": 0.8}}
:::MLLOG {"namespace": "", "time_ms": 1743705317268, "event_type": "INTERVAL_START", "key": "eval_start", "value": 12, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 115, "epoch_num": 12}}
Batch processed: 0 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 3 | Producer 308] Processing index 5
[GPU Rank 3] Processed batch 1.
I AM HERe to evaluate
Batch processed: 0 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 0] Processed batch 1.
I AM HERe to evaluate
Batch processed: 0 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 1] Processed batch 1.
I AM HERe to evaluate
Batch processed: 0 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 2 | Producer 307] Processing index 5
[GPU Rank 2] Processed batch 1.
I AM HERe to evaluate
[GPU Rank 1 | Producer 309] Processing index 5
[GPU Rank 0 | Producer 310] Processing index 3
Batch processed: 1 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 1] Processed batch 2.
I AM HERe to evaluate
[GPU Rank 1 | Producer 309] Processing index 6
Batch processed: 1 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 0 | Producer 310] Processing index 4
[GPU Rank 0] Processed batch 2.
I AM HERe to evaluate
Batch processed: 2 for rank: 1
RAISE StopIteration
Batch processed: 2 for rank: 0
RAISE StopIteration
Batch processed: 1 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 3] Processed batch 2.
I AM HERe to evaluate
[GPU Rank 3 | Producer 308] Processing index 6
Batch processed: 1 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 2 | Producer 307] Processing index 6
[GPU Rank 2] Processed batch 2.
I AM HERe to evaluate
Batch processed: 2 for rank: 3
RAISE StopIteration
Batch processed: 2 for rank: 2
RAISE StopIteration
Batch processed: 0 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 0 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 1 | Producer 297] Processing index 152
[GPU Rank 3 | Producer 291] Processing index 54
[GPU Rank 1] Processed batch 1.
[GPU Rank 3] Processed batch 1.
:::MLLOG {"namespace": "", "time_ms": 1743705341917, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.27674537897109985, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 120, "epoch_num": 12}}
:::MLLOG {"namespace": "", "time_ms": 1743705341919, "event_type": "INTERVAL_END", "key": "eval_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 124, "epoch_num": 12}}
DLL 2025-04-03 18:35:41.920169 - 12.0 epoch : 12.0  L1 dice : 0.4454832077026367  L2 dice : 0.1080075204372406  mean_dice : 0.27674537897109985  eval_loss : 0.42987167835235596  train_loss : 0.2785760760307312  TOP_epoch : 12.0  TOP_L1 dice : 0.4454832077026367  TOP_L2 dice : 0.1080075204372406  TOP_mean_dice : 0.27674537897109985  TOP_eval_loss : 0.42987167835235596  TOP_train_loss : 0.2785760760307312 
Batch processed: 0 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 2 | Producer 303] Processing index 20
[GPU Rank 2] Processed batch 1.
:::MLLOG {"namespace": "", "time_ms": 1743705341940, "event_type": "INTERVAL_END", "key": "block_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 135, "first_epoch_num": 12, "epoch_count": 1}}
:::MLLOG {"namespace": "", "time_ms": 1743705341941, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 66, "first_epoch_num": 13, "epoch_count": 1}}
:::MLLOG {"namespace": "", "time_ms": 1743705341941, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 68, "epoch_num": 13}}
Batch processed: 0 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 0 | Producer 302] Processing index 68
[GPU Rank 0] Processed batch 1.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2529, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3486, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2459, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2742, device='cuda:2', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 114
[GPU Rank 3 | Producer 291] Processing index 106
[GPU Rank 1 | Producer 297] Processing index 46
Batch processed:Batch processed:  11  for rank:for rank:  20

Queue size for GPU 0: 20 samples
Queue size for GPU 2: 20 samples
Batch processed: 1 Batch processed:for rank:  31
 for rank: 1
Queue size for GPU 3: 20 samples
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 299] Processing index 65[GPU Rank 0 | Producer 294] Processing index 166
[GPU Rank 3 | Producer 296] Processing index 124[GPU Rank 1 | Producer 293] Processing index 122


[GPU Rank 2] Processed batch 2.
[GPU Rank 0] Processed batch 2.
[GPU Rank 3] Processed batch 2.
[GPU Rank 1] Processed batch 2.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 303] Processing index 49
tensor(0.2894, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2612, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2151, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1587, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 47
[GPU Rank 1 | Producer 293] Processing index 120
[GPU Rank 2 | Producer 299] Processing index 60
[GPU Rank 0 | Producer 294] Processing index 55
Batch processed:Batch processed:  22  for rank:for rank:  Batch processed:13

 2 Queue size for GPU 3: 20 samplesfor rank:Queue size for GPU 1: 20 samples
 Batch processed:
0
 2 for rank: Queue size for GPU 0: 20 samples2

Queue size for GPU 2: 20 samples
[GPU Rank 1 | Producer 305] Processing index 110[GPU Rank 0 | Producer 302] Processing index 86

[GPU Rank 3 | Producer 291] Processing index 146
[GPU Rank 2 | Producer 295] Processing index 141
[GPU Rank 2] Processed batch 3.
[GPU Rank 3] Processed batch 3.
[GPU Rank 0] Processed batch 3.
[GPU Rank 1] Processed batch 3.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 145
tensor(0.4010, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1564, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2423, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3181, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 146
[GPU Rank 3 | Producer 291] Processing index 46
[GPU Rank 2 | Producer 295] Processing index 129
Batch processed:Batch processed: 3  3for rank:  3for rank:Batch processed: 
1
 Queue size for GPU 3: 20 samples3
 for rank: Queue size for GPU 1: 20 samples0

Queue size for GPU 0: 20 samples
Batch processed: 3 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 3 | Producer 296] Processing index 137[GPU Rank 1 | Producer 293] Processing index 158[GPU Rank 0 | Producer 306] Processing index 14[GPU Rank 2 | Producer 303] Processing index 38



[GPU Rank 0] Processed batch 4.
[GPU Rank 3] Processed batch 4.
[GPU Rank 1] Processed batch 4.
[GPU Rank 2] Processed batch 4.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3225, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2120, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2256, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2816, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 293] Processing index 92
[GPU Rank 0 | Producer 306] Processing index 80
Batch processed:Batch processed:  44  for rank:for rank:  31

Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

Batch processed:Batch processed: 4  4for rank:  for rank:2 
0
Queue size for GPU 2: 20 samplesQueue size for GPU 0: 20 samples

[GPU Rank 3 | Producer 291] Processing index 11
[GPU Rank 1 | Producer 305] Processing index 78[GPU Rank 0 | Producer 298] Processing index 165

[GPU Rank 2 | Producer 292] Processing index 138
[GPU Rank 2] Processed batch 5.
[GPU Rank 1] Processed batch 5.
[GPU Rank 3] Processed batch 5.
[GPU Rank 0] Processed batch 5.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 303] Processing index 145
tensor(0.2784, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3070, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2848, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2789, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 82
[GPU Rank 1 | Producer 305] Processing index 112
[GPU Rank 3 | Producer 291] Processing index 136
[GPU Rank 2 | Producer 292] Processing index 99
[GPU Rank 0 | Producer 298] Processing index 28
Batch processed:Batch processed:  55  for rank:for rank:  31

Batch processed:Queue size for GPU 1: 20 samplesQueue size for GPU 3: 20 samples

 Batch processed:5  5for rank:  for rank:0 
2
Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samples

[GPU Rank 1 | Producer 301] Processing index 14
[GPU Rank 3 | Producer 304] Processing index 17
[GPU Rank 2 | Producer 299] Processing index 30[GPU Rank 0 | Producer 294] Processing index 134

[GPU Rank 3] Processed batch 6.
[GPU Rank 1] Processed batch 6.
[GPU Rank 2] Processed batch 6.
[GPU Rank 0] Processed batch 6.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.4404, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3092, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2550, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2772, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 294] Processing index 59
[GPU Rank 3 | Producer 304] Processing index 88
[GPU Rank 2 | Producer 299] Processing index 50
[GPU Rank 1 | Producer 301] Processing index 145
Batch processed: 6 for rank: Batch processed:1
 6 Batch processed:for rank:Queue size for GPU 1: 20 samples 
3
 6 for rank: Batch processed:0
 Queue size for GPU 3: 20 samples
6Queue size for GPU 0: 20 samples 
for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 0 | Producer 298] Processing index 151[GPU Rank 1 | Producer 305] Processing index 162[GPU Rank 2 | Producer 295] Processing index 160
[GPU Rank 3 | Producer 291] Processing index 90


[GPU Rank 2] Processed batch 7.
[GPU Rank 1] Processed batch 7.
[GPU Rank 0] Processed batch 7.
[GPU Rank 3] Processed batch 7.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2403, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3321, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2302, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 291] Processing index 153
tensor(0.3187, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 26
[GPU Rank 0 | Producer 298] Processing index 76
[GPU Rank 2 | Producer 295] Processing index 143
Batch processed: 7 for rank: 3
Batch processed:Batch processed:Queue size for GPU 3: 20 samples 
 7 7for rank:  for rank:1 
0
Queue size for GPU 1: 20 samples
Queue size for GPU 0: 20 samples
Batch processed: 7 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 3 | Producer 304] Processing index 158[GPU Rank 1 | Producer 293] Processing index 157
[GPU Rank 0 | Producer 294] Processing index 8
[GPU Rank 2 | Producer 299] Processing index 103

[GPU Rank 0] Processed batch 8.[GPU Rank 1] Processed batch 8.

[GPU Rank 3] Processed batch 8.
[GPU Rank 2] Processed batch 8.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 299] Processing index 156
tensor(0.2663, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3914, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2496, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3073, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 294] Processing index 6
[GPU Rank 1 | Producer 293] Processing index 94
[GPU Rank 3 | Producer 304] Processing index 99
Batch processed:Batch processed:Batch processed:   888   for rank:for rank: for rank: 1 3
0

Queue size for GPU 1: 20 samples
Queue size for GPU 0: 20 samplesQueue size for GPU 3: 20 samples

Batch processed: 8 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 1 | Producer 305] Processing index 8
[GPU Rank 3 | Producer 291] Processing index 65[GPU Rank 0 | Producer 298] Processing index 93[GPU Rank 2 | Producer 295] Processing index 114


[GPU Rank 0] Processed batch 9.
[GPU Rank 1] Processed batch 9.
[GPU Rank 3] Processed batch 9.
[GPU Rank 2] Processed batch 9.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2775, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2815, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2849, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.3130, device='cuda:2', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 64
[GPU Rank 2 | Producer 295] Processing index 41
[GPU Rank 0 | Producer 298] Processing index 17
[GPU Rank 3 | Producer 291] Processing index 154
Batch processed:Batch processed:  99  for rank:for rank:  20

Batch processed:Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samples

 9 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 9 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 299] Processing index 9[GPU Rank 0 | Producer 306] Processing index 38[GPU Rank 3 | Producer 300] Processing index 19
[GPU Rank 1 | Producer 293] Processing index 164


[GPU Rank 0] Processed batch 10.
[GPU Rank 2] Processed batch 10.
[GPU Rank 3] Processed batch 10.
[GPU Rank 1] Processed batch 10.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2788, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2377, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2223, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2633, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 293] Processing index 77
[GPU Rank 3 | Producer 300] Processing index 51
[GPU Rank 2 | Producer 299] Processing index 26
Batch processed:Batch processed:  1010  for rank:for rank:  20

Queue size for GPU 2: 20 samplesQueue size for GPU 0: 20 samples

Batch processed: 10 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 10 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 2 | Producer 295] Processing index 63[GPU Rank 1 | Producer 305] Processing index 55[GPU Rank 0 | Producer 298] Processing index 4[GPU Rank 3 | Producer 296] Processing index 60



[GPU Rank 2] Processed batch 11.
[GPU Rank 3] Processed batch 11.
[GPU Rank 1] Processed batch 11.
[GPU Rank 0] Processed batch 11.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 306] Processing index 0
tensor(0.2713, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3592, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2266, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2701, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 133
[GPU Rank 2 | Producer 295] Processing index 107
[GPU Rank 3 | Producer 296] Processing index 126
[GPU Rank 0 | Producer 298] Processing index 74
Batch processed: 11 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 11Batch processed: for rank:  111
 for rank: 2
Queue size for GPU 1: 20 samples
Queue size for GPU 2: 20 samples
Batch processed: 11 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 299] Processing index 104
[GPU Rank 1 | Producer 293] Processing index 150[GPU Rank 0 | Producer 302] Processing index 57
[GPU Rank 3 | Producer 300] Processing index 16

[GPU Rank 2] Processed batch 12.
[GPU Rank 0] Processed batch 12.
[GPU Rank 3] Processed batch 12.
[GPU Rank 1] Processed batch 12.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1626, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2268, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3400, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.3285, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 43
[GPU Rank 2 | Producer 299] Processing index 83
[GPU Rank 1 | Producer 293] Processing index 128
Batch processed:Batch processed:  1212  for rank:for rank:  31

Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

Batch processed:Batch processed:  12 for rank:12  0for rank: 
2
Queue size for GPU 0: 20 samples
Queue size for GPU 2: 20 samples
[GPU Rank 3 | Producer 296] Processing index 87
[GPU Rank 1 | Producer 297] Processing index 140
[GPU Rank 2 | Producer 295] Processing index 22
[GPU Rank 0 | Producer 294] Processing index 43
[GPU Rank 2] Processed batch 13.
[GPU Rank 3] Processed batch 13.
[GPU Rank 1] Processed batch 13.
[GPU Rank 0] Processed batch 13.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 141
tensor(0.2452, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2973, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2475, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2720, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 297] Processing index 42
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 2 | Producer 295] Processing index 164
Batch processed: 13 for rank: 3
Queue size for GPU 3: 20 samplesBatch processed:
 13 for rank: 2
Batch processed: 13 for rank:Queue size for GPU 2: 20 samples 
1
Queue size for GPU 1: 20 samples
Batch processed: 13 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 303] Processing index 108
[GPU Rank 1 | Producer 301] Processing index 35[GPU Rank 3 | Producer 300] Processing index 8
[GPU Rank 0 | Producer 306] Processing index 102

[GPU Rank 1] Processed batch 14.
[GPU Rank 0] Processed batch 14.
[GPU Rank 2] Processed batch 14.
[GPU Rank 3] Processed batch 14.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 294] Processing index 75
tensor(0.2354, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2732, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2396, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2861, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 29
[GPU Rank 0 | Producer 306] Processing index 152
[GPU Rank 2 | Producer 303] Processing index 137
[GPU Rank 1 | Producer 301] Processing index 115
Batch processed: 14 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 14 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 14 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 14 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 296] Processing index 144[GPU Rank 0 | Producer 302] Processing index 110[GPU Rank 2 | Producer 292] Processing index 72

[GPU Rank 1 | Producer 293] Processing index 122

[GPU Rank 2] Processed batch 15.
[GPU Rank 0] Processed batch 15.
[GPU Rank 3] Processed batch 15.
[GPU Rank 1] Processed batch 15.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2216, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1737, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3950, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2019, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 293] Processing index 120
[GPU Rank 0 | Producer 302] Processing index 65
[GPU Rank 3 | Producer 296] Processing index 35
[GPU Rank 2 | Producer 292] Processing index 43
Batch processed: 15 for rank:Batch processed: Batch processed:3 
 1515  for rank:for rank:Queue size for GPU 3: 20 samples  
02

Queue size for GPU 0: 20 samples
Queue size for GPU 2: 20 samples
Batch processed: 15 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 299] Processing index 65[GPU Rank 0 | Producer 306] Processing index 45[GPU Rank 3 | Producer 300] Processing index 3


[GPU Rank 1 | Producer 301] Processing index 63
[GPU Rank 2] Processed batch 16.
[GPU Rank 3] Processed batch 16.
[GPU Rank 0] Processed batch 16.
[GPU Rank 1] Processed batch 16.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2971, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1992, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2116, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3499, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 94
[GPU Rank 0 | Producer 306] Processing index 63
[GPU Rank 1 | Producer 301] Processing index 143
[GPU Rank 2 | Producer 299] Processing index 60
Batch processed: 16 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed:Batch processed:  1616  Batch processed:for rank:for rank:   20

16 for rank: 1Queue size for GPU 0: 20 samples
Queue size for GPU 2: 20 samples

Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 296] Processing index 124
[GPU Rank 0 | Producer 302] Processing index 97
[GPU Rank 2 | Producer 303] Processing index 87
[GPU Rank 1 | Producer 293] Processing index 158
[GPU Rank 2] Processed batch 17.
[GPU Rank 3] Processed batch 17.
[GPU Rank 0] Processed batch 17.
[GPU Rank 1] Processed batch 17.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2280, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2802, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2353, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2682, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 47
[GPU Rank 2 | Producer 303] Processing index 136
[GPU Rank 0 | Producer 302] Processing index 101
[GPU Rank 1 | Producer 293] Processing index 92
Batch processed: 17 for rank: 3
Batch processed:Queue size for GPU 3: 20 samples
 17 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed:Batch processed:  1717  for rank: 1
for rank: 0
Queue size for GPU 1: 20 samples
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 292] Processing index 69[GPU Rank 0 | Producer 306] Processing index 46[GPU Rank 1 | Producer 301] Processing index 19[GPU Rank 3 | Producer 300] Processing index 86



[GPU Rank 2] Processed batch 18.
[GPU Rank 3] Processed batch 18.
[GPU Rank 1] Processed batch 18.
[GPU Rank 0] Processed batch 18.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 3 | Producer 300] Processing index 0
tensor(0.2082, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3736, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2662, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3157, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 301] Processing index 141
[GPU Rank 2 | Producer 292] Processing index 31
[GPU Rank 0 | Producer 306] Processing index 121
Batch processed: 18 for rank: 3
Batch processed: Queue size for GPU 3: 20 samples18
 for rank: 2
Queue size for GPU 2: 20 samplesBatch processed:
 18 for rank: 1
Batch processed: Queue size for GPU 1: 20 samples
18 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 296] Processing index 137
[GPU Rank 2 | Producer 303] Processing index 113[GPU Rank 1 | Producer 293] Processing index 157

[GPU Rank 0 | Producer 302] Processing index 68
[GPU Rank 3] Processed batch 19.
[GPU Rank 2] Processed batch 19.
[GPU Rank 0] Processed batch 19.
[GPU Rank 1] Processed batch 19.
loss_value in pytorch loss_value in pytorchloss_value in pytorch  loss_value in pytorch tensor(0.3764, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2246, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2990, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2160, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 114
[GPU Rank 2 | Producer 303] Processing index 74
[GPU Rank 1 | Producer 293] Processing index 94
Batch processed: 19 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed:Batch processed:Batch processed:   1919  19for rank:for rank:   02for rank:

 1
Queue size for GPU 1: 20 samples
Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samples

[GPU Rank 3 | Producer 304] Processing index 74[GPU Rank 2 | Producer 292] Processing index 125
[GPU Rank 1 | Producer 301] Processing index 56[GPU Rank 0 | Producer 306] Processing index 14


[GPU Rank 3] Processed batch 20.
[GPU Rank 2] Processed batch 20.
[GPU Rank 0] Processed batch 20.
[GPU Rank 1] Processed batch 20.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2752, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2503, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2795, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3178, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 292] Processing index 106
[GPU Rank 3 | Producer 296] Processing index 82
[GPU Rank 1 | Producer 301] Processing index 167
[GPU Rank 3 | Producer 304] Processing index 23
[GPU Rank 0 | Producer 306] Processing index 80
Batch processed: 20 for rank: 3Batch processed:
 20Queue size for GPU 3: 20 samples 
for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 20 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 20 for rank: 0
[GPU Rank 3 | Producer 291] Processing index 54Queue size for GPU 0: 20 samples
[GPU Rank 1 | Producer 293] Processing index 164
[GPU Rank 0 | Producer 302] Processing index 86
[GPU Rank 2 | Producer 303] Processing index 20

[GPU Rank 2] Processed batch 21.
[GPU Rank 3] Processed batch 21.[GPU Rank 1] Processed batch 21.

[GPU Rank 0] Processed batch 21.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 145
tensor(0.3617, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2171, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2346, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2667, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 293] Processing index 77
[GPU Rank 3 | Producer 291] Processing index 106
Batch processed: 21 Batch processed:for rank: 3 
Batch processed:21Batch processed:RAISE StopIteration 
  for rank:21 21 2 for rank:for rank:
  RAISE StopIteration10


RAISE StopIterationRAISE StopIteration

Batch processed: 0 for rank:Batch processed: 0 for rank: 2
 Queue size for GPU 2: 20 samples3

Queue size for GPU 3: 20 samples
Batch processed: 0 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 299] Processing index 30
[GPU Rank 1 | Producer 301] Processing index 14
[GPU Rank 3 | Producer 296] Processing index 60
:::MLLOG {"namespace": "", "time_ms": 1743705358480, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 106, "epoch_num": 13, "current_lr": 0.8}}
:::MLLOG {"namespace": "", "time_ms": 1743705358482, "event_type": "INTERVAL_END", "key": "block_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 135, "first_epoch_num": 13, "epoch_count": 1}}
[GPU Rank 1] Processed batch 1.
[GPU Rank 2] Processed batch 1.
:::MLLOG {"namespace": "", "time_ms": 1743705358482, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 66, "first_epoch_num": 14, "epoch_count": 1}}
:::MLLOG {"namespace": "", "time_ms": 1743705358482, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 68, "epoch_num": 14}}
Batch processed: 0 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3] Processed batch 1.
[GPU Rank 0 | Producer 306] Processing index 38
[GPU Rank 0] Processed batch 1.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 303] Processing index 49
tensor(0.1973, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2946, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3897, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1425, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 126
[GPU Rank 1 | Producer 301] Processing index 145
[GPU Rank 2 | Producer 299] Processing index 50
Batch processed: 1 Batch processed:for rank: 3 
1 for rank: Queue size for GPU 3: 20 samples2

Queue size for GPU 2: 20 samples
Batch processed: 1 for rank: 0
Batch processed: 1 Queue size for GPU 0: 20 samples
for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 291] Processing index 146[GPU Rank 2 | Producer 295] Processing index 141
[GPU Rank 0 | Producer 298] Processing index 111
[GPU Rank 1 | Producer 293] Processing index 150

[GPU Rank 3] Processed batch 2.
[GPU Rank 1] Processed batch 2.
[GPU Rank 2] Processed batch 2.
[GPU Rank 0] Processed batch 2.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 306] Processing index 0
tensor(0.1703, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1897, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3358, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2436, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 291] Processing index 46
[GPU Rank 2 | Producer 295] Processing index 129
[GPU Rank 1 | Producer 293] Processing index 128
[GPU Rank 0 | Producer 298] Processing index 62
Batch processed: 2 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 2 Batch processed:for rank: 1 
2Batch processed: for rank:  Queue size for GPU 1: 20 samples20
 
for rank: 2
Queue size for GPU 0: 20 samples
Queue size for GPU 2: 20 samples
[GPU Rank 3 | Producer 296] Processing index 87
[GPU Rank 1 | Producer 297] Processing index 23[GPU Rank 0 | Producer 306] Processing index 102

[GPU Rank 2 | Producer 292] Processing index 152
[GPU Rank 1] Processed batch 3.
[GPU Rank 2] Processed batch 3.
[GPU Rank 3] Processed batch 3.
[GPU Rank 0] Processed batch 3.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2578, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2094, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2954, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3295, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 306] Processing index 152
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 2 | Producer 292] Processing index 35
[GPU Rank 1 | Producer 297] Processing index 127
Batch processed: 3 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 3 Batch processed:for rank: Batch processed:3 
 33  for rank:Queue size for GPU 3: 20 samples 
0for rank:
 1
Queue size for GPU 1: 20 samples
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 295] Processing index 160
[GPU Rank 3 | Producer 300] Processing index 19[GPU Rank 1 | Producer 305] Processing index 110
[GPU Rank 0 | Producer 294] Processing index 106

[GPU Rank 2] Processed batch 4.
[GPU Rank 3] Processed batch 4.
[GPU Rank 0] Processed batch 4.
[GPU Rank 1] Processed batch 4.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2223, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3994, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3070, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4584, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 295] Processing index 143
[GPU Rank 3 | Producer 300] Processing index 51
[GPU Rank 1 | Producer 305] Processing index 146
[GPU Rank 0 | Producer 294] Processing index 72
Batch processed: 4 for rank:Batch processed: 3Batch processed: 
 4 4 for rank: for rank:Queue size for GPU 3: 20 samples 0
2

Queue size for GPU 0: 20 samples
Queue size for GPU 2: 20 samples
Batch processed: 4 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 296] Processing index 144[GPU Rank 0 | Producer 298] Processing index 165
[GPU Rank 2 | Producer 303] Processing index 38[GPU Rank 1 | Producer 293] Processing index 122


[GPU Rank 3] Processed batch 5.
[GPU Rank 1] Processed batch 5.
[GPU Rank 2] Processed batch 5.
[GPU Rank 0] Processed batch 5.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3010, device='cuda:3', grad_fn=<DivBackward0>)tensor(0.2934, device='cuda:1', grad_fn=<DivBackward0>)

tensor(0.3021, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.4742, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 293] Processing index 120
[GPU Rank 3 | Producer 296] Processing index 35
[GPU Rank 0 | Producer 298] Processing index 28
Batch processed: 5 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed:Batch processed:  55  for rank: for rank:2 1

Queue size for GPU 1: 20 samples
Queue size for GPU 2: 20 samples
Batch processed: 5 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 300] Processing index 16[GPU Rank 1 | Producer 305] Processing index 78
[GPU Rank 2 | Producer 295] Processing index 114[GPU Rank 0 | Producer 294] Processing index 166


[GPU Rank 3] Processed batch 6.
[GPU Rank 0] Processed batch 6.
[GPU Rank 1] Processed batch 6.
[GPU Rank 2] Processed batch 6.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 303] Processing index 145
tensor(0.3055, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2568, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1808, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2787, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 43
[GPU Rank 1 | Producer 305] Processing index 112
[GPU Rank 2 | Producer 295] Processing index 41
[GPU Rank 0 | Producer 294] Processing index 55
Batch processed: 6 for rank: 2
Batch processed:Queue size for GPU 2: 20 samples
 6 for rank: 3
Batch processed:Queue size for GPU 3: 20 samples 
6 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 6 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 304] Processing index 131
[GPU Rank 2 | Producer 292] Processing index 138[GPU Rank 0 | Producer 306] Processing index 45[GPU Rank 1 | Producer 293] Processing index 158


[GPU Rank 2] Processed batch 7.
[GPU Rank 3] Processed batch 7.
[GPU Rank 1] Processed batch 7.
[GPU Rank 0] Processed batch 7.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3744, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2235, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3828, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3122, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 306] Processing index 63
[GPU Rank 2 | Producer 292] Processing index 99
[GPU Rank 1 | Producer 293] Processing index 92
Batch processed: 7 for rank: 3
Batch processed:Queue size for GPU 3: 20 samples 
7Batch processed: for rank:  17
 for rank: 2Queue size for GPU 1: 20 samples

Queue size for GPU 2: 20 samples
Batch processed: 7 for rank:[GPU Rank 3 | Producer 291] Processing index 11 0
Queue size for GPU 0: 20 samples

[GPU Rank 1 | Producer 305] Processing index 162
[GPU Rank 0 | Producer 294] Processing index 134
[GPU Rank 2 | Producer 295] Processing index 63
[GPU Rank 1] Processed batch 8.
[GPU Rank 3] Processed batch 8.
[GPU Rank 0] Processed batch 8.
[GPU Rank 2] Processed batch 8.
[GPU Rank 3 | Producer 304] Processing index 52
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2869, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.3067, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3215, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2767, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 26
[GPU Rank 0 | Producer 294] Processing index 59
[GPU Rank 3 | Producer 291] Processing index 136
[GPU Rank 2 | Producer 295] Processing index 107
Batch processed: 8Batch processed: for rank:  2
8 for rank: Queue size for GPU 2: 20 samples3
Batch processed:
 8 Queue size for GPU 3: 20 samplesfor rank:
 1
Queue size for GPU 1: 20 samples
Batch processed: 8 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 296] Processing index 124
[GPU Rank 1 | Producer 293] Processing index 157
[GPU Rank 0 | Producer 306] Processing index 46
[GPU Rank 2 | Producer 299] Processing index 103
[GPU Rank 3] Processed batch 9.
[GPU Rank 2] Processed batch 9.
[GPU Rank 1] Processed batch 9.
[GPU Rank 0] Processed batch 9.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 299] Processing index 156
tensor(0.2435, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3585, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2356, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2592, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 47
[GPU Rank 1 | Producer 293] Processing index 94
[GPU Rank 0 | Producer 306] Processing index 121
Batch processed: 9 for rank: 2
Batch processed: Queue size for GPU 2: 20 samples9
 for rank: 3
Queue size for GPU 3: 20 samplesBatch processed:
 9 for rank: 1
Batch processed: 9 for rank: 0Queue size for GPU 1: 20 samples

Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 291] Processing index 90
[GPU Rank 1 | Producer 305] Processing index 8
[GPU Rank 0 | Producer 294] Processing index 8
[GPU Rank 2 | Producer 295] Processing index 22
[GPU Rank 3] Processed batch 10.
[GPU Rank 0] Processed batch 10.
[GPU Rank 2] Processed batch 10.
[GPU Rank 1] Processed batch 10.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3667, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1614, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2983, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2910, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 291] Processing index 153
[GPU Rank 1 | Producer 305] Processing index 64
[GPU Rank 0 | Producer 294] Processing index 6
[GPU Rank 2 | Producer 295] Processing index 164
Batch processed: 10 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 10 for rank: 2
Batch processed:Queue size for GPU 2: 20 samples
 10 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 10 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 296] Processing index 137[GPU Rank 0 | Producer 302] Processing index 57
[GPU Rank 1 | Producer 297] Processing index 136
[GPU Rank 2 | Producer 299] Processing index 9

[GPU Rank 3] Processed batch 11.
[GPU Rank 1] Processed batch 11.
[GPU Rank 0] Processed batch 11.
[GPU Rank 2] Processed batch 11.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3027, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2604, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2265, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3056, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 299] Processing index 26
[GPU Rank 1 | Producer 297] Processing index 16
Batch processed:Batch processed:  1111  for rank: 2
Batch processed:for rank:Batch processed:  3Queue size for GPU 2: 20 samples11 

 11for rank:  for rank:0Queue size for GPU 3: 20 samples 
1

Queue size for GPU 1: 20 samples
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 295] Processing index 141
[GPU Rank 3 | Producer 291] Processing index 65
[GPU Rank 1 | Producer 305] Processing index 55
[GPU Rank 3] Processed batch 12.
[GPU Rank 1] Processed batch 12.
[GPU Rank 2] Processed batch 12.
[GPU Rank 0] Processed batch 12.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 141
tensor(0.2153, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3388, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2059, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2112, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 298] Processing index 151
[GPU Rank 3 | Producer 296] Processing index 82
[GPU Rank 1 | Producer 305] Processing index 133
[GPU Rank 3 | Producer 291] Processing index 154
[GPU Rank 2 | Producer 295] Processing index 129
[GPU Rank 0 | Producer 298] Processing index 76
Batch processed: Batch processed:12  for rank: 112
 for rank: 3
Queue size for GPU 1: 20 samples
Queue size for GPU 3: 20 samples
Batch processed: 12 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 12 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 1 | Producer 301] Processing index 35[GPU Rank 3 | Producer 304] Processing index 32[GPU Rank 2 | Producer 292] Processing index 72
[GPU Rank 0 | Producer 306] Processing index 14


[GPU Rank 3] Processed batch 13.
[GPU Rank 2] Processed batch 13.
[GPU Rank 1] Processed batch 13.
[GPU Rank 0] Processed batch 13.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2375, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2261, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2010, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1870, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 304] Processing index 161
[GPU Rank 1 | Producer 301] Processing index 115
[GPU Rank 2 | Producer 292] Processing index 43
[GPU Rank 0 | Producer 306] Processing index 80
Batch processed: 13 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: Batch processed:13 for rank:  213
 for rank: 1
Queue size for GPU 2: 20 samples
Queue size for GPU 1: 20 samples
Batch processed:[GPU Rank 3 | Producer 300] Processing index 8 13
 for rank: 0
[GPU Rank 2 | Producer 295] Processing index 160Queue size for GPU 0: 20 samples
[GPU Rank 1 | Producer 305] Processing index 110

[GPU Rank 0 | Producer 302] Processing index 110
[GPU Rank 3] Processed batch 14.
[GPU Rank 2] Processed batch 14.
[GPU Rank 1] Processed batch 14.
[GPU Rank 0] Processed batch 14.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2483, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3977, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2029, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2582, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 146
[GPU Rank 0 | Producer 302] Processing index 65
[GPU Rank 2 | Producer 295] Processing index 143
[GPU Rank 3 | Producer 300] Processing index 29
Batch processed: 14 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 14 for rank: 1
Batch processed:Queue size for GPU 1: 20 samples
 14 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 1 | Producer 297] Processing index 0
Batch processed: 14 for rank: 0[GPU Rank 2 | Producer 303] Processing index 108

Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 304] Processing index 17
[GPU Rank 3] Processed batch 15.
[GPU Rank 0 | Producer 306] Processing index 38
[GPU Rank 1] Processed batch 15.
[GPU Rank 2] Processed batch 15.
[GPU Rank 0] Processed batch 15.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1767, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2875, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2688, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2908, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 304] Processing index 88
[GPU Rank 1 | Producer 297] Processing index 125
[GPU Rank 2 | Producer 303] Processing index 137
Batch processed:Batch processed:Batch processed:   151515   for rank:for rank:for rank:   312


Queue size for GPU 1: 20 samples
Queue size for GPU 2: 20 samplesQueue size for GPU 3: 20 samples

Batch processed: 15 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 292] Processing index 69[GPU Rank 3 | Producer 296] Processing index 60[GPU Rank 1 | Producer 305] Processing index 78
[GPU Rank 0 | Producer 302] Processing index 97


[GPU Rank 2] Processed batch 16.
[GPU Rank 1] Processed batch 16.
[GPU Rank 3] Processed batch 16.
[GPU Rank 0] Processed batch 16.
[GPU Rank 0 | Producer 306] Processing index 0
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1873, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1815, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2281, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2724, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 101
[GPU Rank 1 | Producer 305] Processing index 112
[GPU Rank 2 | Producer 292] Processing index 31
[GPU Rank 3 | Producer 296] Processing index 126
Batch processed:Batch processed:  1616  for rank:for rank:  32

Batch processed: 16 for rank: 1Queue size for GPU 3: 20 samples
Queue size for GPU 2: 20 samples

Queue size for GPU 1: 20 samples
Batch processed: 16 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 299] Processing index 104
[GPU Rank 1 | Producer 297] Processing index 152
[GPU Rank 0 | Producer 294] Processing index 43
[GPU Rank 2] Processed batch 17.
[GPU Rank 3] Processed batch 17.
[GPU Rank 1] Processed batch 17.
[GPU Rank 0] Processed batch 17.
loss_value in pytorch loss_value in pytorch [GPU Rank 3 | Producer 300] Processing index 3
loss_value in pytorch loss_value in pytorch tensor(0.2396, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2000, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2756, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2982, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 94
[GPU Rank 2 | Producer 299] Processing index 83
[GPU Rank 1 | Producer 297] Processing index 46
Batch processed: 17 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 17 for rank: 2Batch processed:
 Batch processed:Queue size for GPU 2: 20 samples 17
17  for rank:for rank:  01

Queue size for GPU 0: 20 samples
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 296] Processing index 87[GPU Rank 2 | Producer 292] Processing index 125
[GPU Rank 0 | Producer 302] Processing index 68[GPU Rank 1 | Producer 305] Processing index 162


[GPU Rank 2] Processed batch 18.
[GPU Rank 1] Processed batch 18.
[GPU Rank 3] Processed batch 18.
[GPU Rank 0] Processed batch 18.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 294] Processing index 75
[GPU Rank 2 | Producer 292] Processing index 106
tensor(0.2578, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2330, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1988, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3076, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 114
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 1 | Producer 305] Processing index 26
Batch processed:Batch processed:  18 for rank: 3
Queue size for GPU 3: 20 samples
18 for rank: 2
Batch processed: Queue size for GPU 2: 20 samples18
 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 18 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 300] Processing index 86[GPU Rank 2 | Producer 299] Processing index 65[GPU Rank 0 | Producer 306] Processing index 102[GPU Rank 1 | Producer 293] Processing index 164



[GPU Rank 2] Processed batch 19.
[GPU Rank 3] Processed batch 19.
[GPU Rank 1] Processed batch 19.
[GPU Rank 0] Processed batch 19.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 3 | Producer 300] Processing index 0
tensor(0.1388, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1563, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2434, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2599, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 306] Processing index 152
[GPU Rank 1 | Producer 293] Processing index 77
[GPU Rank 2 | Producer 299] Processing index 60
Batch processed: 19 for rank: 2
Batch processed:Queue size for GPU 2: 20 samples
 19 for rank: 1
Batch processed: Queue size for GPU 1: 20 samples
19 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 2 | Producer 303] Processing index 87Batch processed: 19 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 296] Processing index 144

[GPU Rank 1 | Producer 305] Processing index 8
[GPU Rank 0 | Producer 298] Processing index 93
[GPU Rank 1] Processed batch 20.
[GPU Rank 3] Processed batch 20.
[GPU Rank 2] Processed batch 20.
[GPU Rank 0] Processed batch 20.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.4064, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2632, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3927, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2441, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 64
[GPU Rank 2 | Producer 303] Processing index 136
[GPU Rank 3 | Producer 296] Processing index 35
[GPU Rank 0 | Producer 298] Processing index 17
Batch processed:Batch processed:  Batch processed:2020   for rank:for rank:20  2 0
for rank:
 1
Queue size for GPU 2: 20 samples
Queue size for GPU 0: 20 samples
Queue size for GPU 1: 20 samples
Batch processed: 20 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 2 | Producer 299] Processing index 30
[GPU Rank 0 | Producer 306] Processing index 45[GPU Rank 1 | Producer 293] Processing index 150

[GPU Rank 1] Processed batch 21.
[GPU Rank 3] Processed batch 21.
[GPU Rank 0] Processed batch 21.
[GPU Rank 2] Processed batch 21.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 3 | Producer 291] Processing index 54
tensor(0.1915, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2766, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2902, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2663, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 306] Processing index 63
[GPU Rank 3 | Producer 291] Processing index 106
[GPU Rank 1 | Producer 293] Processing index 128
[GPU Rank 2 | Producer 299] Processing index 50
Batch processed:Batch processed:Batch processed:   2121  21for rank:for rank:   for rank:01 

2RAISE StopIteration
RAISE StopIteration

RAISE StopIteration
Batch processed: 21 for rank: 3
RAISE StopIteration
Batch processed: 0 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 0 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 292] Processing index 152[GPU Rank 1 | Producer 305] Processing index 55Batch processed: 0 :::MLLOG {"namespace": "", "time_ms": 1743705374986, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 106, "epoch_num": 14, "current_lr": 0.8}}
for rank: 3
Queue size for GPU 3: 20 samples


[GPU Rank 3 | Producer 296] Processing index 124:::MLLOG {"namespace": "", "time_ms": 1743705374987, "event_type": "INTERVAL_END", "key": "block_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 135, "first_epoch_num": 14, "epoch_count": 1}}

:::MLLOG {"namespace": "", "time_ms": 1743705374987, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 66, "first_epoch_num": 15, "epoch_count": 1}}
:::MLLOG {"namespace": "", "time_ms": 1743705374988, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 68, "epoch_num": 15}}
[GPU Rank 1] Processed batch 1.
[GPU Rank 2] Processed batch 1.
Batch processed: 0 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3] Processed batch 1.
[GPU Rank 0 | Producer 298] Processing index 4
[GPU Rank 0] Processed batch 1.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3203, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2099, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2044, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3477, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 47
[GPU Rank 1 | Producer 305] Processing index 133
[GPU Rank 2 | Producer 292] Processing index 35
[GPU Rank 0 | Producer 298] Processing index 74
Batch processed:Batch processed:Batch processed: 1   11for rank:   for rank:2for rank:  0
1

Queue size for GPU 0: 20 samplesQueue size for GPU 1: 20 samples

Queue size for GPU 2: 20 samples
Batch processed: 1 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 0 | Producer 306] Processing index 46[GPU Rank 2 | Producer 299] Processing index 103[GPU Rank 3 | Producer 291] Processing index 146

[GPU Rank 1 | Producer 301] Processing index 63

[GPU Rank 1] Processed batch 2.
[GPU Rank 2] Processed batch 2.
[GPU Rank 3] Processed batch 2.
[GPU Rank 0] Processed batch 2.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 299] Processing index 156
tensor(0.2586, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2639, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2933, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2277, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 291] Processing index 46
[GPU Rank 1 | Producer 301] Processing index 143
[GPU Rank 0 | Producer 306] Processing index 121
Batch processed:Batch processed:  22  Batch processed:for rank:for rank:  20 

2 for rank: 1Queue size for GPU 2: 20 samples

Queue size for GPU 0: 20 samples
Queue size for GPU 1: 20 samples
Batch processed: 2 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 2 | Producer 295] Processing index 114[GPU Rank 1 | Producer 305] Processing index 110

[GPU Rank 0 | Producer 298] Processing index 111
[GPU Rank 3 | Producer 296] Processing index 137
[GPU Rank 0] Processed batch 3.[GPU Rank 3] Processed batch 3.

[GPU Rank 2] Processed batch 3.
[GPU Rank 1] Processed batch 3.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2588, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2291, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.4132, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3027, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 146
[GPU Rank 2 | Producer 295] Processing index 41
[GPU Rank 0 | Producer 298] Processing index 62
Batch processed: 3 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 3 for rank: Batch processed:1Batch processed:
  3 3for rank:  Queue size for GPU 1: 20 samples0
for rank:
 Queue size for GPU 0: 20 samples3

Queue size for GPU 3: 20 samples
[GPU Rank 2 | Producer 299] Processing index 9
[GPU Rank 1 | Producer 297] Processing index 140[GPU Rank 0 | Producer 294] Processing index 106

[GPU Rank 3 | Producer 291] Processing index 11
[GPU Rank 2] Processed batch 4.
[GPU Rank 1] Processed batch 4.
[GPU Rank 0] Processed batch 4.
[GPU Rank 3] Processed batch 4.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2423, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2370, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3771, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2077, device='cuda:3', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 82
[GPU Rank 1 | Producer 297] Processing index 42
[GPU Rank 3 | Producer 291] Processing index 136
[GPU Rank 2 | Producer 299] Processing index 26
[GPU Rank 0 | Producer 294] Processing index 72
Batch processed:Batch processed:  44  for rank:for rank:  20

Queue size for GPU 0: 20 samples
Queue size for GPU 2: 20 samples
Batch processed:Batch processed:  44  for rank: for rank:1 3

Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

[GPU Rank 0 | Producer 298] Processing index 165[GPU Rank 2 | Producer 303] Processing index 113[GPU Rank 1 | Producer 305] Processing index 78
[GPU Rank 3 | Producer 304] Processing index 158


[GPU Rank 2] Processed batch 5.
[GPU Rank 3] Processed batch 5.
[GPU Rank 0] Processed batch 5.
[GPU Rank 1] Processed batch 5.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2233, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1728, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3097, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1176, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 112
[GPU Rank 2 | Producer 303] Processing index 74
[GPU Rank 0 | Producer 298] Processing index 28
[GPU Rank 3 | Producer 304] Processing index 99
Batch processed: 5Batch processed: for rank:  25
 for rank: 1Queue size for GPU 2: 20 samples

Queue size for GPU 1: 20 samples
Batch processed: 5 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 5 [GPU Rank 2 | Producer 299] Processing index 104for rank: 
0
Queue size for GPU 0: 20 samples
[GPU Rank 1 | Producer 297] Processing index 23[GPU Rank 3 | Producer 291] Processing index 90
[GPU Rank 0 | Producer 306] Processing index 14

[GPU Rank 1] Processed batch 6.
[GPU Rank 2] Processed batch 6.
[GPU Rank 3] Processed batch 6.
[GPU Rank 0] Processed batch 6.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2627, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1986, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2476, device='cuda:3', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 291] Processing index 153
tensor(0.2253, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 299] Processing index 83
[GPU Rank 1 | Producer 297] Processing index 127
[GPU Rank 0 | Producer 306] Processing index 80
Batch processed: 6Batch processed: for rank: 2 
6 for rank: 1Queue size for GPU 2: 20 samples

Queue size for GPU 1: 20 samples
Batch processed: 6 for rank: 3
Batch processed: 6 for rank:Queue size for GPU 3: 20 samples 
0
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 295] Processing index 63
[GPU Rank 1 | Producer 305] Processing index 162
[GPU Rank 3 | Producer 300] Processing index 19[GPU Rank 0 | Producer 298] Processing index 151

[GPU Rank 0] Processed batch 7.
[GPU Rank 1] Processed batch 7.
[GPU Rank 3] Processed batch 7.
[GPU Rank 2] Processed batch 7.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2111, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2702, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2998, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2971, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 26
[GPU Rank 0 | Producer 298] Processing index 76
[GPU Rank 3 | Producer 300] Processing index 51
[GPU Rank 2 | Producer 295] Processing index 107
Batch processed:Batch processed:  7 for rank: 0
7Queue size for GPU 0: 20 samplesBatch processed: 
for rank:  27
 for rank: 1
Queue size for GPU 2: 20 samples
Queue size for GPU 1: 20 samples
Batch processed: 7 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 2 | Producer 299] Processing index 65
[GPU Rank 0 | Producer 302] Processing index 86
[GPU Rank 1 | Producer 301] Processing index 19
[GPU Rank 3 | Producer 291] Processing index 65
[GPU Rank 0] Processed batch 8.
[GPU Rank 1] Processed batch 8.
[GPU Rank 3] Processed batch 8.
[GPU Rank 2] Processed batch 8.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2734, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4085, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1871, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2055, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 145
[GPU Rank 1 | Producer 301] Processing index 141
[GPU Rank 3 | Producer 291] Processing index 154
[GPU Rank 2 | Producer 299] Processing index 60
Batch processed:Batch processed:  88  for rank:for rank:  02

Queue size for GPU 2: 20 samplesQueue size for GPU 0: 20 samples

Batch processed: Batch processed:8  for rank: 83 
for rank: 1Queue size for GPU 3: 20 samples

Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 300] Processing index 16
[GPU Rank 2 | Producer 292] Processing index 138
[GPU Rank 1 | Producer 305] Processing index 8[GPU Rank 0 | Producer 298] Processing index 93

[GPU Rank 0] Processed batch 9.
[GPU Rank 2] Processed batch 9.
[GPU Rank 3] Processed batch 9.
[GPU Rank 1] Processed batch 9.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1756, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2474, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1935, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2545, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 64
[GPU Rank 3 | Producer 300] Processing index 43
[GPU Rank 0 | Producer 298] Processing index 17
[GPU Rank 2 | Producer 292] Processing index 99
Batch processed:Batch processed:Batch processed:   999   for rank:for rank:for rank:   102


Queue size for GPU 0: 20 samplesQueue size for GPU 1: 20 samplesQueue size for GPU 2: 20 samples


Batch processed: 9 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 2 | Producer 299] Processing index 30
[GPU Rank 1 | Producer 301] Processing index 56[GPU Rank 0 | Producer 302] Processing index 57

[GPU Rank 3 | Producer 296] Processing index 60
[GPU Rank 1] Processed batch 10.
[GPU Rank 2] Processed batch 10.
[GPU Rank 0] Processed batch 10.
[GPU Rank 3] Processed batch 10.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2601, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1964, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1991, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2074, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 301] Processing index 167
[GPU Rank 3 | Producer 296] Processing index 126
[GPU Rank 2 | Producer 299] Processing index 50
Batch processed:Batch processed:Batch processed:   1010  10for rank:for rank:   0for rank:1 

2
Queue size for GPU 0: 20 samples
Batch processed:Queue size for GPU 1: 20 samples 
Queue size for GPU 2: 20 samples
10 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 1 | Producer 305] Processing index 55[GPU Rank 3 | Producer 304] Processing index 74
[GPU Rank 2 | Producer 303] Processing index 20
[GPU Rank 0 | Producer 298] Processing index 4

[GPU Rank 2] Processed batch 11.
[GPU Rank 3] Processed batch 11.
[GPU Rank 1] Processed batch 11.
[GPU Rank 0] Processed batch 11.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 141
tensor(0.2647, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1947, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2435, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2880, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 133
[GPU Rank 3 | Producer 304] Processing index 23
[GPU Rank 0 | Producer 298] Processing index 74
Batch processed: 11 for rank: 2
Batch processed: Queue size for GPU 2: 20 samples
11 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 11 for rank: 1
Batch processed:Queue size for GPU 1: 20 samples 
11 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 2 | Producer 299] Processing index 103
[GPU Rank 1 | Producer 297] Processing index 136
[GPU Rank 3 | Producer 296] Processing index 87
[GPU Rank 0 | Producer 306] Processing index 38
[GPU Rank 2] Processed batch 12.
[GPU Rank 0] Processed batch 12.
[GPU Rank 1] Processed batch 12.
[GPU Rank 3] Processed batch 12.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 299] Processing index 156
tensor(0.4414, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2760, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2537, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2359, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 303] Processing index 49
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 1 | Producer 297] Processing index 16
Batch processed:Batch processed:Batch processed:  1212  for rank:for rank:   1012

 for rank: 2
Queue size for GPU 0: 20 samplesQueue size for GPU 1: 20 samples

Queue size for GPU 2: 20 samples
Batch processed: 12 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 0 | Producer 298] Processing index 111[GPU Rank 1 | Producer 305] Processing index 110

[GPU Rank 2 | Producer 292] Processing index 72
[GPU Rank 3 | Producer 300] Processing index 8
[GPU Rank 0] Processed batch 13.[GPU Rank 2] Processed batch 13.

[GPU Rank 1] Processed batch 13.
[GPU Rank 3] Processed batch 13.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 306] Processing index 0
tensor(0.2129, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2872, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2856, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2046, device='cuda:3', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 146
[GPU Rank 3 | Producer 300] Processing index 29
[GPU Rank 0 | Producer 298] Processing index 62
[GPU Rank 2 | Producer 292] Processing index 43
Batch processed: 13 for rank: 0
Batch processed:Queue size for GPU 0: 20 samples
 Batch processed:13 for rank: Batch processed: 132  
for rank: 133 
for rank: 1
Queue size for GPU 3: 20 samplesQueue size for GPU 2: 20 samples

Queue size for GPU 1: 20 samples
[GPU Rank 0 | Producer 294] Processing index 166[GPU Rank 1 | Producer 297] Processing index 0

[GPU Rank 3 | Producer 296] Processing index 144[GPU Rank 2 | Producer 299] Processing index 9

[GPU Rank 3] Processed batch 14.
[GPU Rank 0] Processed batch 14.
[GPU Rank 2] Processed batch 14.
[GPU Rank 1] Processed batch 14.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2675, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2753, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1945, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2421, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 297] Processing index 125
[GPU Rank 3 | Producer 296] Processing index 35
[GPU Rank 2 | Producer 299] Processing index 26
[GPU Rank 0 | Producer 294] Processing index 55
Batch processed: 14 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 14 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed:Batch processed:  1414  for rank: for rank:1 
3
Queue size for GPU 1: 20 samplesQueue size for GPU 3: 20 samples

[GPU Rank 2 | Producer 292] Processing index 69[GPU Rank 0 | Producer 298] Processing index 165

[GPU Rank 1 | Producer 305] Processing index 78
[GPU Rank 3 | Producer 300] Processing index 3
[GPU Rank 0] Processed batch 15.
[GPU Rank 2] Processed batch 15.
[GPU Rank 1] Processed batch 15.
[GPU Rank 3] Processed batch 15.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3019, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2425, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1411, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2821, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 112
[GPU Rank 3 | Producer 300] Processing index 94
[GPU Rank 2 | Producer 292] Processing index 31
[GPU Rank 0 | Producer 298] Processing index 28
Batch processed:Batch processed:  1515  for rank:for rank:  20

Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samples

Batch processed: 15 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 15 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 0 | Producer 294] Processing index 134[GPU Rank 2 | Producer 303] Processing index 38
[GPU Rank 3 | Producer 291] Processing index 54
[GPU Rank 1 | Producer 301] Processing index 14

[GPU Rank 2] Processed batch 16.
[GPU Rank 3] Processed batch 16.
[GPU Rank 1] Processed batch 16.
[GPU Rank 0] Processed batch 16.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2376, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2326, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2289, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2211, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 294] Processing index 59
[GPU Rank 3 | Producer 291] Processing index 106
[GPU Rank 1 | Producer 301] Processing index 145
Batch processed: 16 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 16 for rank: 3
Batch processed:Queue size for GPU 3: 20 samplesBatch processed:
  16 16for rank: for rank:  21

Queue size for GPU 2: 20 samples
Queue size for GPU 1: 20 samples
[GPU Rank 0 | Producer 298] Processing index 151[GPU Rank 3 | Producer 300] Processing index 86
[GPU Rank 2 | Producer 292] Processing index 125[GPU Rank 1 | Producer 305] Processing index 162


[GPU Rank 0] Processed batch 17.
[GPU Rank 3] Processed batch 17.
[GPU Rank 2] Processed batch 17.
[GPU Rank 1] Processed batch 17.
[GPU Rank 2 | Producer 303] Processing index 145
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 3 | Producer 300] Processing index 0
tensor(0.2125, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2193, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2479, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2104, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 292] Processing index 106
[GPU Rank 1 | Producer 305] Processing index 26
[GPU Rank 0 | Producer 298] Processing index 76
Batch processed: 17 for rank: 2
Batch processed:Queue size for GPU 2: 20 samples
 17 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 17 for rank: 3
Batch processed:Queue size for GPU 3: 20 samples
 17 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 299] Processing index 104
[GPU Rank 0 | Producer 294] Processing index 8[GPU Rank 1 | Producer 293] Processing index 122
[GPU Rank 3 | Producer 296] Processing index 124

[GPU Rank 0] Processed batch 18.
[GPU Rank 3] Processed batch 18.
[GPU Rank 2] Processed batch 18.
[GPU Rank 1] Processed batch 18.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2902, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2915, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2324, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2141, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 294] Processing index 6
[GPU Rank 3 | Producer 296] Processing index 47
[GPU Rank 1 | Producer 293] Processing index 120
[GPU Rank 2 | Producer 299] Processing index 83
Batch processed: Batch processed:18  for rank: 180 
for rank: 2
Queue size for GPU 0: 20 samples
Queue size for GPU 2: 20 samples
Batch processed:Batch processed:  18 for rank: 183 
for rank: 1
Queue size for GPU 3: 20 samples
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 292] Processing index 152[GPU Rank 0 | Producer 298] Processing index 93
[GPU Rank 3 | Producer 304] Processing index 131
[GPU Rank 1 | Producer 305] Processing index 8

[GPU Rank 2] Processed batch 19.
[GPU Rank 3] Processed batch 19.
[GPU Rank 0] Processed batch 19.
[GPU Rank 1] Processed batch 19.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2286, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1843, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2111, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2256, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 64
[GPU Rank 0 | Producer 298] Processing index 17
[GPU Rank 2 | Producer 292] Processing index 35
[GPU Rank 3 | Producer 304] Processing index 52
Batch processed: 19 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: Batch processed:19  for rank: 1
19 for rank: 3
Queue size for GPU 1: 20 samples
Queue size for GPU 3: 20 samples
Batch processed: 19 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 1 | Producer 293] Processing index 158[GPU Rank 3 | Producer 296] Processing index 137
[GPU Rank 0 | Producer 302] Processing index 110
[GPU Rank 2 | Producer 299] Processing index 65

[GPU Rank 3] Processed batch 20.
[GPU Rank 2] Processed batch 20.
[GPU Rank 0] Processed batch 20.
[GPU Rank 1] Processed batch 20.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3002, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2046, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2190, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1787, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 65
[GPU Rank 2 | Producer 299] Processing index 60
[GPU Rank 1 | Producer 293] Processing index 92
Batch processed: 20 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: Batch processed:20 for rank:  120 
for rank: 3
Queue size for GPU 1: 20 samples
Queue size for GPU 3: 20 samplesBatch processed:
 20 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 1 | Producer 305] Processing index 55[GPU Rank 3 | Producer 304] Processing index 32
[GPU Rank 0 | Producer 298] Processing index 4[GPU Rank 2 | Producer 292] Processing index 138


[GPU Rank 3] Processed batch 21.
[GPU Rank 2] Processed batch 21.
[GPU Rank 1] Processed batch 21.
[GPU Rank 0] Processed batch 21.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2036, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1249, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1532, device='cuda:2', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 82
tensor(0.2097, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 133
[GPU Rank 3 | Producer 304] Processing index 161
[GPU Rank 2 | Producer 292] Processing index 99
[GPU Rank 0 | Producer 298] Processing index 74
Batch processed: 21 for rank: 2
RAISE StopIteration
Batch processed: Batch processed:Batch processed:21   for rank: 213 
for rank:21 RAISE StopIteration 
1for rank: 
0RAISE StopIteration

RAISE StopIteration
Batch processed: 0 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 0 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 0 for rank: [GPU Rank 2 | Producer 299] Processing index 301

Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 291] Processing index 146
[GPU Rank 1 | Producer 293] Processing index 157
[GPU Rank 1] Processed batch 1.
[GPU Rank 2] Processed batch 1.
:::MLLOG {"namespace": "", "time_ms": 1743705391499, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 106, "epoch_num": 15, "current_lr": 0.8}}
[GPU Rank 3] Processed batch 1.
:::MLLOG {"namespace": "", "time_ms": 1743705391501, "event_type": "INTERVAL_END", "key": "block_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 135, "first_epoch_num": 15, "epoch_count": 1}}
:::MLLOG {"namespace": "", "time_ms": 1743705391502, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 66, "first_epoch_num": 16, "epoch_count": 1}}
:::MLLOG {"namespace": "", "time_ms": 1743705391502, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 68, "epoch_num": 16}}
Batch processed: 0 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 0 | Producer 302] Processing index 97
[GPU Rank 0] Processed batch 1.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2460, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2332, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2776, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2025, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 101
[GPU Rank 1 | Producer 293] Processing index 94
[GPU Rank 3 | Producer 291] Processing index 46
[GPU Rank 2 | Producer 299] Processing index 50
Batch processed: 1 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed:Batch processed:  11  for rank: 1for rank:
 3
Queue size for GPU 1: 20 samples
Batch processed: 1 for rank: 0Queue size for GPU 3: 20 samples

Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 292] Processing index 72[GPU Rank 1 | Producer 297] Processing index 152
[GPU Rank 3 | Producer 304] Processing index 17[GPU Rank 0 | Producer 294] Processing index 43


[GPU Rank 1] Processed batch 2.
[GPU Rank 3] Processed batch 2.
[GPU Rank 2] Processed batch 2.
[GPU Rank 0] Processed batch 2.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2416, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2493, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2537, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2545, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 304] Processing index 88
[GPU Rank 1 | Producer 297] Processing index 46
[GPU Rank 2 | Producer 292] Processing index 43
Batch processed: 2 for rank:Batch processed: Batch processed:0  
22  for rank:Batch processed:for rank:  32Queue size for GPU 0: 20 samples 


2Queue size for GPU 2: 20 samples
 for rank:Queue size for GPU 3: 20 samples 
1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 295] Processing index 22[GPU Rank 0 | Producer 302] Processing index 68
[GPU Rank 1 | Producer 301] Processing index 35

[GPU Rank 3 | Producer 300] Processing index 19
[GPU Rank 2] Processed batch 3.
[GPU Rank 3] Processed batch 3.
[GPU Rank 0] Processed batch 3.
[GPU Rank 1] Processed batch 3.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 294] Processing index 75
tensor(0.3028, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2351, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1448, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2138, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 114
[GPU Rank 3 | Producer 300] Processing index 51
[GPU Rank 1 | Producer 301] Processing index 115
[GPU Rank 2 | Producer 295] Processing index 164
Batch processed: 3 for rank: 2Batch processed:
 Queue size for GPU 2: 20 samples
3 for rank: 3
Queue size for GPU 3: 20 samplesBatch processed:
 3 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 3 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 292] Processing index 69[GPU Rank 3 | Producer 296] Processing index 60
[GPU Rank 0 | Producer 298] Processing index 111
[GPU Rank 1 | Producer 305] Processing index 110

[GPU Rank 2] Processed batch 4.
[GPU Rank 3] Processed batch 4.
[GPU Rank 0] Processed batch 4.
[GPU Rank 1] Processed batch 4.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2174, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2321, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1686, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2465, device='cuda:3', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 146
[GPU Rank 3 | Producer 296] Processing index 126
[GPU Rank 2 | Producer 292] Processing index 31
[GPU Rank 0 | Producer 298] Processing index 62
Batch processed: 4 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 4 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 4 for rank: 3Batch processed:
 4 for rank: 0
Queue size for GPU 3: 20 samples
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 303] Processing index 108[GPU Rank 1 | Producer 293] Processing index 164[GPU Rank 3 | Producer 300] Processing index 16


[GPU Rank 0 | Producer 302] Processing index 86
[GPU Rank 2] Processed batch 5.
[GPU Rank 1] Processed batch 5.
[GPU Rank 0] Processed batch 5.
[GPU Rank 3] Processed batch 5.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 145
tensor(0.2693, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3847, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2080, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2138, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 43
[GPU Rank 1 | Producer 293] Processing index 77
[GPU Rank 2 | Producer 303] Processing index 137
Batch processed: 5 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 5 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed:Batch processed:  55  for rank: for rank:3 
1
Queue size for GPU 3: 20 samples
Queue size for GPU 1: 20 samples
[GPU Rank 0 | Producer 294] Processing index 106[GPU Rank 1 | Producer 305] Processing index 78
[GPU Rank 2 | Producer 292] Processing index 125

[GPU Rank 3 | Producer 296] Processing index 87
[GPU Rank 2] Processed batch 6.
[GPU Rank 0] Processed batch 6.
[GPU Rank 1] Processed batch 6.
[GPU Rank 3] Processed batch 6.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2428, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2442, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2794, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 292] Processing index 106
tensor(0.2305, device='cuda:3', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 1 | Producer 305] Processing index 112
[GPU Rank 0 | Producer 294] Processing index 72
Batch processed:Batch processed:  6 for rank: 2
6 for rank: 1
Queue size for GPU 1: 20 samplesQueue size for GPU 2: 20 samples

Batch processed: 6 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 1 | Producer 293] Processing index 150[GPU Rank 2 | Producer 299] Processing index 103
Batch processed: 6 for rank: 3
Queue size for GPU 3: 20 samples

[GPU Rank 0 | Producer 302] Processing index 57
[GPU Rank 3 | Producer 300] Processing index 8
[GPU Rank 1] Processed batch 7.
[GPU Rank 2] Processed batch 7.
[GPU Rank 3] Processed batch 7.
[GPU Rank 0] Processed batch 7.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3656, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1748, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3339, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1932, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 299] Processing index 156
[GPU Rank 3 | Producer 300] Processing index 29
[GPU Rank 1 | Producer 293] Processing index 128
Batch processed: 7 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 7 for rank:Batch processed: 3
 7 Batch processed:for rank: 1 
7 Queue size for GPU 3: 20 samplesfor rank:
 0Queue size for GPU 1: 20 samples

Queue size for GPU 0: 20 samples
[GPU Rank 1 | Producer 305] Processing index 162[GPU Rank 3 | Producer 296] Processing index 144[GPU Rank 0 | Producer 294] Processing index 166
[GPU Rank 2 | Producer 292] Processing index 152


[GPU Rank 3] Processed batch 8.
[GPU Rank 2] Processed batch 8.
[GPU Rank 1] Processed batch 8.
[GPU Rank 0] Processed batch 8.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 141
tensor(0.3217, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2267, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2381, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2990, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 26
[GPU Rank 2 | Producer 292] Processing index 35
[GPU Rank 3 | Producer 296] Processing index 35
[GPU Rank 0 | Producer 294] Processing index 55
Batch processed:Batch processed:  88Batch processed:   for rank:for rank: 8 1 3for rank:

 2
Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

Queue size for GPU 2: 20 samples
Batch processed: 8 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 300] Processing index 3[GPU Rank 2 | Producer 295] Processing index 141[GPU Rank 1 | Producer 301] Processing index 63[GPU Rank 0 | Producer 306] Processing index 102



[GPU Rank 2] Processed batch 9.
[GPU Rank 3] Processed batch 9.
[GPU Rank 1] Processed batch 9.
[GPU Rank 0] Processed batch 9.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2163, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2156, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1627, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1777, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 306] Processing index 152
[GPU Rank 3 | Producer 300] Processing index 94
[GPU Rank 1 | Producer 301] Processing index 143
[GPU Rank 2 | Producer 295] Processing index 129
Batch processed: 9 for rank: Batch processed:3
 9 Queue size for GPU 3: 20 samplesfor rank:
 2
Queue size for GPU 2: 20 samplesBatch processed:
 9 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 9 for rank: 0
[GPU Rank 2 | Producer 303] Processing index 87Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 296] Processing index 124
[GPU Rank 1 | Producer 293] Processing index 122
[GPU Rank 0 | Producer 302] Processing index 110

[GPU Rank 3] Processed batch 10.
[GPU Rank 1] Processed batch 10.
[GPU Rank 2] Processed batch 10.
[GPU Rank 0] Processed batch 10.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1745, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1509, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2755, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2609, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 47
[GPU Rank 1 | Producer 293] Processing index 120
[GPU Rank 0 | Producer 302] Processing index 65
[GPU Rank 2 | Producer 303] Processing index 136
Batch processed: 10 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 10 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 10 for rank: 2
Batch processed: Queue size for GPU 2: 20 samples10
 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 299] Processing index 9[GPU Rank 1 | Producer 301] Processing index 19
[GPU Rank 3 | Producer 300] Processing index 86

[GPU Rank 0 | Producer 306] Processing index 45
[GPU Rank 3] Processed batch 11.
[GPU Rank 1] Processed batch 11.
[GPU Rank 2] Processed batch 11.
[GPU Rank 0] Processed batch 11.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 3 | Producer 300] Processing index 0
tensor(0.2981, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2087, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3658, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2941, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 301] Processing index 141
[GPU Rank 0 | Producer 306] Processing index 63
[GPU Rank 2 | Producer 299] Processing index 26
Batch processed: 11 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 11 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: Batch processed:11  11for rank:  for rank:0 
1
Queue size for GPU 1: 20 samples
Queue size for GPU 0: 20 samples
[GPU Rank 1 | Producer 293] Processing index 158
[GPU Rank 0 | Producer 302] Processing index 97
[GPU Rank 3 | Producer 296] Processing index 137
[GPU Rank 2 | Producer 303] Processing index 113
[GPU Rank 3] Processed batch 12.
[GPU Rank 2] Processed batch 12.
[GPU Rank 1] Processed batch 12.
[GPU Rank 0] Processed batch 12.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2755, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2946, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3394, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3108, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 101
[GPU Rank 2 | Producer 303] Processing index 74
[GPU Rank 1 | Producer 293] Processing index 92
Batch processed: Batch processed:12  for rank: Batch processed:123 
 for rank: 122 
for rank:Queue size for GPU 3: 20 samples 
1
Queue size for GPU 2: 20 samples
Queue size for GPU 1: 20 samples
Batch processed: 12 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 291] Processing index 11
[GPU Rank 1 | Producer 301] Processing index 56[GPU Rank 0 | Producer 306] Processing index 46
[GPU Rank 2 | Producer 295] Processing index 160

[GPU Rank 3] Processed batch 13.
[GPU Rank 2] Processed batch 13.
[GPU Rank 1] Processed batch 13.
[GPU Rank 0] Processed batch 13.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 3 | Producer 296] Processing index 82
tensor(0.1863, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1816, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2539, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1044, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 295] Processing index 143
[GPU Rank 1 | Producer 301] Processing index 167
[GPU Rank 3 | Producer 291] Processing index 136
[GPU Rank 0 | Producer 306] Processing index 121
Batch processed:Batch processed:  1313  Batch processed:for rank:for rank:  30 

13 for rank: Queue size for GPU 0: 20 samplesQueue size for GPU 3: 20 samples2


Batch processed: Queue size for GPU 2: 20 samples13
 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 303] Processing index 20[GPU Rank 3 | Producer 300] Processing index 19

[GPU Rank 0 | Producer 302] Processing index 68
[GPU Rank 1 | Producer 305] Processing index 8
[GPU Rank 2] Processed batch 14.
[GPU Rank 0] Processed batch 14.
[GPU Rank 3] Processed batch 14.
[GPU Rank 1] Processed batch 14.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1508, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2077, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3070, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3586, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 114
[GPU Rank 3 | Producer 300] Processing index 51
[GPU Rank 1 | Producer 305] Processing index 64
Batch processed: Batch processed:Batch processed:14   1414for rank:   for rank:for rank:3  
20

Queue size for GPU 3: 20 samples
Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samples

Batch processed: 14 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 299] Processing index 104[GPU Rank 3 | Producer 291] Processing index 90
[GPU Rank 1 | Producer 301] Processing index 14
[GPU Rank 0 | Producer 306] Processing index 14

[GPU Rank 2] Processed batch 15.
[GPU Rank 0] Processed batch 15.
[GPU Rank 3] Processed batch 15.
[GPU Rank 1] Processed batch 15.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 303] Processing index 49
[GPU Rank 3 | Producer 291] Processing index 153
tensor(0.2960, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2173, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2519, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3246, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 299] Processing index 83
[GPU Rank 1 | Producer 301] Processing index 145
[GPU Rank 0 | Producer 306] Processing index 80
Batch processed:Batch processed:  15Batch processed:15 for rank:   for rank:015 
 2for rank:
 1
Queue size for GPU 2: 20 samples
Queue size for GPU 1: 20 samplesQueue size for GPU 0: 20 samples

Batch processed: 15 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 2 | Producer 292] Processing index 138
[GPU Rank 3 | Producer 291] Processing index 65
[GPU Rank 1 | Producer 293] Processing index 157[GPU Rank 0 | Producer 302] Processing index 86

[GPU Rank 1] Processed batch 16.
[GPU Rank 0] Processed batch 16.
[GPU Rank 3] Processed batch 16.
[GPU Rank 2] Processed batch 16.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 145
tensor(0.2918, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2295, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.1301, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2436, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 291] Processing index 154
[GPU Rank 1 | Producer 293] Processing index 94
[GPU Rank 2 | Producer 292] Processing index 99
Batch processed: 16 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed:Batch processed: Batch processed:16   for rank:16  016for rank:
  for rank:1 
3
Queue size for GPU 0: 20 samples
Queue size for GPU 1: 20 samples
Queue size for GPU 3: 20 samples
[GPU Rank 2 | Producer 303] Processing index 38[GPU Rank 1 | Producer 301] Processing index 35
[GPU Rank 3 | Producer 296] Processing index 60

[GPU Rank 0 | Producer 306] Processing index 38
[GPU Rank 2] Processed batch 17.
[GPU Rank 0] Processed batch 17.
[GPU Rank 1] Processed batch 17.
[GPU Rank 3] Processed batch 17.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2146, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2727, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2790, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2714, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 126
[GPU Rank 1 | Producer 301] Processing index 115
Batch processed:Batch processed:Batch processed:   171717  for rank:for rank:   03for rank:
 
2
Queue size for GPU 3: 20 samplesQueue size for GPU 0: 20 samples

Queue size for GPU 2: 20 samples
Batch processed: 17 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 292] Processing index 72[GPU Rank 3 | Producer 291] Processing index 54
[GPU Rank 0 | Producer 294] Processing index 134[GPU Rank 1 | Producer 305] Processing index 55


[GPU Rank 3] Processed batch 18.
[GPU Rank 0] Processed batch 18.
[GPU Rank 2] Processed batch 18.
[GPU Rank 1] Processed batch 18.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 306] Processing index 0
[GPU Rank 2 | Producer 303] Processing index 145
tensor(0.2120, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1538, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2396, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2786, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 133
[GPU Rank 3 | Producer 291] Processing index 106
[GPU Rank 0 | Producer 294] Processing index 59
[GPU Rank 2 | Producer 292] Processing index 43
Batch processed: 18 Batch processed:Batch processed:for rank:  2 
1818  for rank:for rank:  Queue size for GPU 2: 20 samples0
3

Queue size for GPU 0: 20 samplesQueue size for GPU 3: 20 samples

Batch processed: 18 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 295] Processing index 114
[GPU Rank 0 | Producer 306] Processing index 102[GPU Rank 1 | Producer 301] Processing index 63
[GPU Rank 3 | Producer 296] Processing index 87

[GPU Rank 2] Processed batch 19.
[GPU Rank 0] Processed batch 19.
[GPU Rank 1] Processed batch 19.
[GPU Rank 3] Processed batch 19.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2776, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3862, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2713, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2417, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 306] Processing index 152
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 1 | Producer 301] Processing index 143
[GPU Rank 2 | Producer 295] Processing index 41
Batch processed:Batch processed:Batch processed:   191919   for rank:for rank:for rank:   320


Queue size for GPU 3: 20 samplesQueue size for GPU 2: 20 samplesQueue size for GPU 0: 20 samples


Batch processed: 19 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 292] Processing index 69
[GPU Rank 3 | Producer 291] Processing index 146
[GPU Rank 0 | Producer 294] Processing index 8
[GPU Rank 1 | Producer 297] Processing index 140
[GPU Rank 0] Processed batch 20.
[GPU Rank 3] Processed batch 20.
[GPU Rank 2] Processed batch 20.
[GPU Rank 1] Processed batch 20.
loss_value in pytorch loss_value in pytorchloss_value in pytorch  loss_value in pytorch tensor(0.3188, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2356, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1343, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2221, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 294] Processing index 6
[GPU Rank 1 | Producer 297] Processing index 42
[GPU Rank 2 | Producer 292] Processing index 31
[GPU Rank 3 | Producer 291] Processing index 46
Batch processed: 20 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 20 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 20 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: [GPU Rank 2 | Producer 295] Processing index 6320 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 1 | Producer 301] Processing index 19

[GPU Rank 0 | Producer 306] Processing index 45[GPU Rank 3 | Producer 296] Processing index 144

[GPU Rank 2] Processed batch 21.
[GPU Rank 3] Processed batch 21.
[GPU Rank 1] Processed batch 21.
[GPU Rank 0] Processed batch 21.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1996, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2535, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3674, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2457, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 301] Processing index 141
[GPU Rank 0 | Producer 306] Processing index 63
[GPU Rank 2 | Producer 295] Processing index 107
[GPU Rank 3 | Producer 296] Processing index 35
Batch processed: 21 for rank: 2
RAISE StopIteration
Batch processed: 21 for rank: 3
RAISE StopIteration
Batch processed: 21 for rank: 0
RAISE StopIteration
Batch processed: 21 for rank: 1
RAISE StopIteration
:::MLLOG {"namespace": "", "time_ms": 1743705408008, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 106, "epoch_num": 16, "current_lr": 0.8}}
:::MLLOG {"namespace": "", "time_ms": 1743705408009, "event_type": "INTERVAL_START", "key": "eval_start", "value": 16, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 115, "epoch_num": 16}}
Batch processed: 0 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 3 | Producer 308] Processing index 7Batch processed: 0 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 1 | Producer 309] Processing index 7

[GPU Rank 3] Processed batch 1.
I AM HERe to evaluate
[GPU Rank 1] Processed batch 1.
I AM HERe to evaluate
Batch processed: 0 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 2 | Producer 307] Processing index 7
[GPU Rank 2] Processed batch 1.
I AM HERe to evaluate
Batch processed: 0 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 0 | Producer 310] Processing index 5
[GPU Rank 0] Processed batch 1.
I AM HERe to evaluate
Batch processed: 1 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 2] Processed batch 2.
I AM HERe to evaluate
[GPU Rank 2 | Producer 307] Processing index 8
Batch processed: 1 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 1] Processed batch 2.
I AM HERe to evaluate
[GPU Rank 1 | Producer 309] Processing index 8
Batch processed: 2 for rank: 2
RAISE StopIteration
Batch processed: 1 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 3] Processed batch 2.
I AM HERe to evaluate
[GPU Rank 3 | Producer 308] Processing index 8
Batch processed: 2 for rank: 1
RAISE StopIteration
Batch processed: 1 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 0 | Producer 310] Processing index 6
[GPU Rank 0] Processed batch 2.
I AM HERe to evaluate
Batch processed: 2 for rank: 0
RAISE StopIteration
Batch processed: 2 for rank: 3
RAISE StopIteration
:::MLLOG {"namespace": "", "time_ms": 1743705427225, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.28758469223976135, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 120, "epoch_num": 16}}
:::MLLOG {"namespace": "", "time_ms": 1743705427228, "event_type": "INTERVAL_END", "key": "eval_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 124, "epoch_num": 16}}
DLL 2025-04-03 18:37:07.229473 - 16.0 epoch : 16.0  L1 dice : 0.47929394245147705  L2 dice : 0.09587545692920685  mean_dice : 0.28758469223976135  eval_loss : 0.4079892039299011  train_loss : 0.2473413646221161  TOP_epoch : 16.0  TOP_L1 dice : 0.47929394245147705  TOP_L2 dice : 0.09587545692920685  TOP_mean_dice : 0.28758469223976135  TOP_eval_loss : 0.4079892039299011  TOP_train_loss : 0.2473413646221161 
Batch processed: 0 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 2 | Producer 303] Processing index 108
[GPU Rank 2] Processed batch 1.
Batch processed: 0 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 1 | Producer 297] Processing index 23
[GPU Rank 1] Processed batch 1.
:::MLLOG {"namespace": "", "time_ms": 1743705427253, "event_type": "INTERVAL_END", "key": "block_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 135, "first_epoch_num": 16, "epoch_count": 1}}
:::MLLOG {"namespace": "", "time_ms": 1743705427254, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 66, "first_epoch_num": 17, "epoch_count": 1}}
:::MLLOG {"namespace": "", "time_ms": 1743705427254, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 68, "epoch_num": 17}}
Batch processed: 0 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 0 | Producer 302] Processing index 57
[GPU Rank 0] Processed batch 1.
Batch processed: 0 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 3 | Producer 300] Processing index 16
[GPU Rank 3] Processed batch 1.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2997, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2115, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3123, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.1996, device='cuda:3', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 43
[GPU Rank 2 | Producer 303] Processing index 137
[GPU Rank 1 | Producer 297] Processing index 127
Batch processed:Batch processed:  11 Batch processed:for rank:  for rank:3  
11
 for rank: Queue size for GPU 3: 20 samples0

Queue size for GPU 1: 20 samples
Queue size for GPU 0: 20 samples
Batch processed: 1 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 1 | Producer 305] Processing index 110[GPU Rank 3 | Producer 291] Processing index 11
[GPU Rank 0 | Producer 306] Processing index 46

[GPU Rank 2 | Producer 295] Processing index 22
[GPU Rank 3] Processed batch 2.
[GPU Rank 0] Processed batch 2.
[GPU Rank 1] Processed batch 2.
[GPU Rank 2] Processed batch 2.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 141
tensor(0.1906, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2724, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2531, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2432, device='cuda:3', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 146
[GPU Rank 3 | Producer 291] Processing index 136
[GPU Rank 2 | Producer 295] Processing index 164
Batch processed:Batch processed:  2 for rank:2 2 
for rank: 3
Queue size for GPU 2: 20 samples
Batch processed: Queue size for GPU 3: 20 samples
2 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 2 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 292] Processing index 125
[GPU Rank 3 | Producer 300] Processing index 8[GPU Rank 1 | Producer 297] Processing index 136[GPU Rank 0 | Producer 294] Processing index 43


[GPU Rank 1] Processed batch 3.
[GPU Rank 3] Processed batch 3.
[GPU Rank 0] Processed batch 3.
[GPU Rank 2] Processed batch 3.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 306] Processing index 121
tensor(0.2827, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2162, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2764, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.3867, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 29
[GPU Rank 2 | Producer 292] Processing index 106
[GPU Rank 1 | Producer 297] Processing index 16
Batch processed: 3 for rank: 3
Batch processed:Queue size for GPU 3: 20 samples
 3 for rank: 2
Batch processed:Queue size for GPU 2: 20 samples
 3 for rank: 1
Batch processed: 3 for rank: 0
Queue size for GPU 1: 20 samples
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 303] Processing index 87[GPU Rank 3 | Producer 304] Processing index 158[GPU Rank 0 | Producer 302] Processing index 110
[GPU Rank 1 | Producer 305] Processing index 78


[GPU Rank 3] Processed batch 4.
[GPU Rank 1] Processed batch 4.
[GPU Rank 2] Processed batch 4.
[GPU Rank 0] Processed batch 4.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 294] Processing index 75
tensor(0.2313, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2539, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1472, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1931, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 303] Processing index 136
[GPU Rank 0 | Producer 302] Processing index 65
[GPU Rank 1 | Producer 305] Processing index 112
[GPU Rank 3 | Producer 304] Processing index 99
Batch processed: 4 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed:Batch processed: 4  for rank:4  1
for rank: 2
Queue size for GPU 1: 20 samplesQueue size for GPU 2: 20 samples

Batch processed: 4 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 300] Processing index 3[GPU Rank 2 | Producer 292] Processing index 152[GPU Rank 1 | Producer 297] Processing index 0

[GPU Rank 0 | Producer 298] Processing index 165

[GPU Rank 3] Processed batch 5.
[GPU Rank 1] Processed batch 5.
[GPU Rank 2] Processed batch 5.
[GPU Rank 0] Processed batch 5.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2243, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1408, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2547, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2902, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 94
[GPU Rank 1 | Producer 297] Processing index 125
[GPU Rank 2 | Producer 292] Processing index 35
[GPU Rank 0 | Producer 298] Processing index 28
Batch processed: 5 for rank: 3
Batch processed:Queue size for GPU 3: 20 samples
 5 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: Batch processed:5  5for rank:  for rank:2 
0
Queue size for GPU 2: 20 samples
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 291] Processing index 90[GPU Rank 1 | Producer 305] Processing index 162[GPU Rank 2 | Producer 303] Processing index 113


[GPU Rank 0 | Producer 302] Processing index 97
[GPU Rank 3] Processed batch 6.
[GPU Rank 1] Processed batch 6.
[GPU Rank 2] Processed batch 6.
[GPU Rank 0] Processed batch 6.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2928, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2622, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2876, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3024, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 291] Processing index 153
[GPU Rank 0 | Producer 302] Processing index 101
[GPU Rank 1 | Producer 305] Processing index 26
[GPU Rank 2 | Producer 303] Processing index 74
Batch processed: 6 Batch processed:for rank: 3 
6 for rank: 2Queue size for GPU 3: 20 samples

Batch processed:Queue size for GPU 2: 20 samples
 6 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 6 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 300] Processing index 86
[GPU Rank 0 | Producer 294] Processing index 106
[GPU Rank 1 | Producer 293] Processing index 164[GPU Rank 2 | Producer 292] Processing index 138

[GPU Rank 3] Processed batch 7.
[GPU Rank 1] Processed batch 7.
[GPU Rank 2] Processed batch 7.
[GPU Rank 0] Processed batch 7.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 3 | Producer 300] Processing index 0
tensor(0.2055, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1476, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2784, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1286, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 293] Processing index 77
[GPU Rank 2 | Producer 292] Processing index 99
[GPU Rank 0 | Producer 294] Processing index 72
Batch processed:Batch processed:  7 for rank: 0
Queue size for GPU 0: 20 samples
7 Batch processed:for rank:  37 
for rank: 1
Batch processed: Queue size for GPU 3: 20 samples
7 Queue size for GPU 1: 20 samples
for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 0 | Producer 302] Processing index 68[GPU Rank 3 | Producer 291] Processing index 65[GPU Rank 1 | Producer 305] Processing index 8
[GPU Rank 2 | Producer 303] Processing index 20


[GPU Rank 3] Processed batch 8.
[GPU Rank 0] Processed batch 8.
[GPU Rank 2] Processed batch 8.
[GPU Rank 1] Processed batch 8.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2242, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1816, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.1644, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2994, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 64
[GPU Rank 0 | Producer 302] Processing index 114
[GPU Rank 3 | Producer 291] Processing index 154
Batch processed: 8 Batch processed:for rank: Batch processed:3 
 88Batch processed:  Queue size for GPU 3: 20 samplesfor rank: for rank:
  821 

for rank: 0
Queue size for GPU 2: 20 samplesQueue size for GPU 1: 20 samples

Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 292] Processing index 72
[GPU Rank 0 | Producer 298] Processing index 151[GPU Rank 1 | Producer 293] Processing index 150

[GPU Rank 3] Processed batch 9.
[GPU Rank 2] Processed batch 9.
[GPU Rank 0] Processed batch 9.
[GPU Rank 1] Processed batch 9.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 3 | Producer 296] Processing index 124
[GPU Rank 2 | Producer 303] Processing index 49
tensor(0.2579, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2702, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2671, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2002, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 47
[GPU Rank 0 | Producer 298] Processing index 76
[GPU Rank 1 | Producer 293] Processing index 128
[GPU Rank 2 | Producer 292] Processing index 43
Batch processed:Batch processed:  99  Batch processed:for rank:for rank:  3 0
9
 for rank: 2Queue size for GPU 3: 20 samples
Queue size for GPU 0: 20 samples

Queue size for GPU 2: 20 samples
Batch processed: 9 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 0 | Producer 302] Processing index 86
[GPU Rank 2 | Producer 299] Processing index 65[GPU Rank 3 | Producer 304] Processing index 74[GPU Rank 1 | Producer 305] Processing index 55


[GPU Rank 3] Processed batch 10.
[GPU Rank 0] Processed batch 10.
[GPU Rank 1] Processed batch 10.
[GPU Rank 2] Processed batch 10.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 145
tensor(0.2547, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2376, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2145, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1485, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 133
[GPU Rank 3 | Producer 304] Processing index 23
[GPU Rank 2 | Producer 299] Processing index 60
Batch processed:Batch processed:  10 10for rank:  3for rank: 
2
Queue size for GPU 3: 20 samples
Queue size for GPU 2: 20 samples
Batch processed: 10 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 10 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 296] Processing index 137
[GPU Rank 2 | Producer 303] Processing index 38
[GPU Rank 0 | Producer 298] Processing index 93[GPU Rank 1 | Producer 293] Processing index 122

[GPU Rank 0] Processed batch 11.
[GPU Rank 2] Processed batch 11.
[GPU Rank 3] Processed batch 11.
[GPU Rank 1] Processed batch 11.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2065, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2240, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2557, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2009, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 293] Processing index 120
[GPU Rank 0 | Producer 298] Processing index 17
Batch processed: 11 for rank: 2
Batch processed:Queue size for GPU 2: 20 samples
 11 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: Batch processed:11  for rank: 111
 for rank: 0
Queue size for GPU 1: 20 samples
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 291] Processing index 54
[GPU Rank 2 | Producer 292] Processing index 69[GPU Rank 1 | Producer 301] Processing index 56

[GPU Rank 0 | Producer 302] Processing index 57
[GPU Rank 0] Processed batch 12.
[GPU Rank 2] Processed batch 12.
[GPU Rank 3] Processed batch 12.
[GPU Rank 1] Processed batch 12.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 303] Processing index 145
tensor(0.2676, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2285, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2200, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.1427, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 82
[GPU Rank 3 | Producer 291] Processing index 106
[GPU Rank 2 | Producer 292] Processing index 31
[GPU Rank 1 | Producer 301] Processing index 167
Batch processed:Batch processed:Batch processed:   1212 12 for rank: for rank: for rank: 0 2
3

Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samples

Queue size for GPU 3: 20 samples
Batch processed: 12 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 303] Processing index 108[GPU Rank 0 | Producer 298] Processing index 4
[GPU Rank 1 | Producer 305] Processing index 110

[GPU Rank 0] Processed batch 13.
[GPU Rank 3] Processed batch 13.
[GPU Rank 2] Processed batch 13.
[GPU Rank 1] Processed batch 13.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 141
[GPU Rank 3 | Producer 296] Processing index 60
tensor(0.2320, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2039, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1659, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2284, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 146
[GPU Rank 2 | Producer 303] Processing index 137
[GPU Rank 3 | Producer 296] Processing index 126
[GPU Rank 0 | Producer 298] Processing index 74
Batch processed: 13 for rank: 3
Batch processed: 13 for rank:Queue size for GPU 3: 20 samples 
2
Queue size for GPU 2: 20 samplesBatch processed:
 13 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 13 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 291] Processing index 146[GPU Rank 2 | Producer 292] Processing index 125[GPU Rank 0 | Producer 306] Processing index 14


[GPU Rank 1 | Producer 297] Processing index 152
[GPU Rank 2] Processed batch 14.
[GPU Rank 1] Processed batch 14.
[GPU Rank 3] Processed batch 14.
[GPU Rank 0] Processed batch 14.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1838, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2873, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2342, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2509, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 292] Processing index 106
[GPU Rank 3 | Producer 291] Processing index 46
[GPU Rank 1 | Producer 297] Processing index 46
Batch processed:Batch processed:  14 for rank:Batch processed: 0 
1414  for rank:for rank:  Queue size for GPU 0: 20 samples32


Queue size for GPU 2: 20 samplesQueue size for GPU 3: 20 samples

Batch processed: 14 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 296] Processing index 87
[GPU Rank 2 | Producer 295] Processing index 141[GPU Rank 0 | Producer 302] Processing index 110

[GPU Rank 1 | Producer 293] Processing index 158
[GPU Rank 2] Processed batch 15.
[GPU Rank 3] Processed batch 15.
[GPU Rank 0] Processed batch 15.
[GPU Rank 1] Processed batch 15.
[GPU Rank 0 | Producer 306] Processing index 80
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2791, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1431, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2575, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.1698, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 0 | Producer 302] Processing index 65
[GPU Rank 2 | Producer 295] Processing index 129
[GPU Rank 1 | Producer 293] Processing index 92
Batch processed: Batch processed:Batch processed:15   1515for rank:   for rank:3 for rank:0 

2
Queue size for GPU 3: 20 samplesQueue size for GPU 0: 20 samples

Queue size for GPU 2: 20 samples
Batch processed: 15 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 300] Processing index 19[GPU Rank 2 | Producer 303] Processing index 87
[GPU Rank 1 | Producer 301] Processing index 14
[GPU Rank 0 | Producer 306] Processing index 38

[GPU Rank 3] Processed batch 16.
[GPU Rank 2] Processed batch 16.
[GPU Rank 1] Processed batch 16.
[GPU Rank 0] Processed batch 16.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2306, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2650, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2915, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2550, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 303] Processing index 136
[GPU Rank 3 | Producer 300] Processing index 51
[GPU Rank 1 | Producer 301] Processing index 145
Batch processed: 16 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: Batch processed:16  for rank:Batch processed: 016 
 for rank: 1Queue size for GPU 0: 20 samples
16
 for rank: 2
Queue size for GPU 1: 20 samples
Queue size for GPU 2: 20 samples
[GPU Rank 3 | Producer 296] Processing index 144[GPU Rank 0 | Producer 302] Processing index 97[GPU Rank 1 | Producer 305] Processing index 78[GPU Rank 2 | Producer 295] Processing index 160



[GPU Rank 3] Processed batch 17.
[GPU Rank 0] Processed batch 17.
[GPU Rank 2] Processed batch 17.
[GPU Rank 1] Processed batch 17.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 306] Processing index 0
tensor(0.4459, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.4057, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1774, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2505, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 101
[GPU Rank 1 | Producer 305] Processing index 112
[GPU Rank 2 | Producer 295] Processing index 143
[GPU Rank 3 | Producer 296] Processing index 35
Batch processed:Batch processed:  1717  for rank:for rank:  02

Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samplesBatch processed:

 17 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 17 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 303] Processing index 113
[GPU Rank 0 | Producer 306] Processing index 102
[GPU Rank 3 | Producer 300] Processing index 16
[GPU Rank 1 | Producer 301] Processing index 35
[GPU Rank 3] Processed batch 18.
[GPU Rank 2] Processed batch 18.
[GPU Rank 0] Processed batch 18.
[GPU Rank 1] Processed batch 18.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2031, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1992, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2228, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2856, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 306] Processing index 152
[GPU Rank 3 | Producer 300] Processing index 43
[GPU Rank 2 | Producer 303] Processing index 74
[GPU Rank 1 | Producer 301] Processing index 115
Batch processed:Batch processed:  Batch processed:1818   for rank:for rank:  1813 

for rank: 2
Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

Queue size for GPU 2: 20 samples
Batch processed: 18 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 1 | Producer 305] Processing index 162
[GPU Rank 3 | Producer 296] Processing index 124
[GPU Rank 2 | Producer 295] Processing index 114
[GPU Rank 0 | Producer 302] Processing index 68
[GPU Rank 3] Processed batch 19.
[GPU Rank 2] Processed batch 19.[GPU Rank 1] Processed batch 19.

[GPU Rank 0] Processed batch 19.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2321, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2048, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2615, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2367, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 47
[GPU Rank 0 | Producer 302] Processing index 114
[GPU Rank 1 | Producer 305] Processing index 26
[GPU Rank 2 | Producer 295] Processing index 41
Batch processed:Batch processed: 19 for rank:  019
 for rank: 3Queue size for GPU 0: 20 samples

Queue size for GPU 3: 20 samples
Batch processed: 19 for rank: 2
Batch processed: 19Queue size for GPU 2: 20 samples
 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 292] Processing index 152[GPU Rank 1 | Producer 301] Processing index 63
[GPU Rank 3 | Producer 304] Processing index 131

[GPU Rank 0 | Producer 306] Processing index 45
[GPU Rank 3] Processed batch 20.
[GPU Rank 0] Processed batch 20.
[GPU Rank 2] Processed batch 20.
[GPU Rank 1] Processed batch 20.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2523, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1945, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1875, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1672, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 306] Processing index 63
[GPU Rank 1 | Producer 301] Processing index 143
[GPU Rank 2 | Producer 292] Processing index 35
[GPU Rank 3 | Producer 304] Processing index 52
Batch processed: Batch processed:20 for rank:  203 
for rank: 0
Queue size for GPU 3: 20 samples
Queue size for GPU 0: 20 samples
Batch processed: 20 for rank: 1
Batch processed:Queue size for GPU 1: 20 samples
 20 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 3 | Producer 296] Processing index 137
[GPU Rank 0 | Producer 302] Processing index 86[GPU Rank 2 | Producer 295] Processing index 63[GPU Rank 1 | Producer 305] Processing index 8


[GPU Rank 3] Processed batch 21.
[GPU Rank 2] Processed batch 21.
[GPU Rank 1] Processed batch 21.
[GPU Rank 0] Processed batch 21.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 145
tensor(0.2823, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2916, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1977, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2681, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 64
[GPU Rank 2 | Producer 295] Processing index 107
Batch processed:Batch processed:  2121  for rank:for rank:  02

RAISE StopIterationRAISE StopIteration

Batch processed: 21 for rank: 3
RAISE StopIteration
Batch processed: 21 for rank: 1
RAISE StopIteration
Batch processed: 0 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 0 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 0 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 303] Processing index 20:::MLLOG {"namespace": "", "time_ms": 1743705443704, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 106, "epoch_num": 17, "current_lr": 0.8}}
[GPU Rank 1 | Producer 301] Processing index 19
[GPU Rank 3 | Producer 300] Processing index 8

:::MLLOG {"namespace": "", "time_ms": 1743705443705, "event_type": "INTERVAL_END", "key": "block_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 135, "first_epoch_num": 17, "epoch_count": 1}}
:::MLLOG {"namespace": "", "time_ms": 1743705443705, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 66, "first_epoch_num": 18, "epoch_count": 1}}
[GPU Rank 3] Processed batch 1.
:::MLLOG {"namespace": "", "time_ms": 1743705443706, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 68, "epoch_num": 18}}
[GPU Rank 1] Processed batch 1.
[GPU Rank 2] Processed batch 1.
Batch processed: 0 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 0 | Producer 306] Processing index 46
[GPU Rank 0] Processed batch 1.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2817, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2033, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2751, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1459, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 82
[GPU Rank 1 | Producer 301] Processing index 141
[GPU Rank 3 | Producer 300] Processing index 29
[GPU Rank 0 | Producer 306] Processing index 121
Batch processed: 1 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: Batch processed:1  for rank: 13 
for rank: 1
Queue size for GPU 3: 20 samples
Batch processed: 1 Queue size for GPU 1: 20 samplesfor rank:
 0
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 295] Processing index 22[GPU Rank 1 | Producer 305] Processing index 55[GPU Rank 0 | Producer 294] Processing index 166


[GPU Rank 2] Processed batch 2.
[GPU Rank 3] Processed batch 2.
[GPU Rank 1] Processed batch 2.
[GPU Rank 0] Processed batch 2.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 3 | Producer 296] Processing index 60
[GPU Rank 2 | Producer 303] Processing index 49
tensor(0.1497, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2894, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2498, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2099, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 133
[GPU Rank 3 | Producer 296] Processing index 126
[GPU Rank 2 | Producer 295] Processing index 164
[GPU Rank 0 | Producer 294] Processing index 55
Batch processed: 2 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed:Batch processed:  22  for rank: for rank:1 
3
Queue size for GPU 1: 20 samples
Batch processed: 2 Queue size for GPU 3: 20 samplesfor rank:
 0
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 299] Processing index 30[GPU Rank 0 | Producer 306] Processing index 14
[GPU Rank 1 | Producer 301] Processing index 56[GPU Rank 3 | Producer 300] Processing index 3


[GPU Rank 2] Processed batch 3.
[GPU Rank 1] Processed batch 3.
[GPU Rank 0] Processed batch 3.
[GPU Rank 3] Processed batch 3.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1768, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3023, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3271, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2958, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 94
[GPU Rank 1 | Producer 301] Processing index 167
[GPU Rank 0 | Producer 306] Processing index 80
[GPU Rank 2 | Producer 299] Processing index 50
Batch processed: 3 for rank: 1Batch processed:
 3 Queue size for GPU 1: 20 samplesfor rank:
 3Batch processed:
 3 Queue size for GPU 3: 20 samplesfor rank:
 2
Queue size for GPU 2: 20 samples
Batch processed: 3 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 303] Processing index 38[GPU Rank 1 | Producer 293] Processing index 157[GPU Rank 3 | Producer 296] Processing index 87
[GPU Rank 0 | Producer 298] Processing index 111


[GPU Rank 2] Processed batch 4.
[GPU Rank 1] Processed batch 4.
[GPU Rank 3] Processed batch 4.
[GPU Rank 0] Processed batch 4.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2145, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1772, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2680, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.5080, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 1 | Producer 293] Processing index 94
[GPU Rank 0 | Producer 298] Processing index 62
Batch processed: 4 for rank: 3
Batch processed:Queue size for GPU 3: 20 samples 
Batch processed:4  for rank:4  2for rank:
 1
Queue size for GPU 2: 20 samples
Queue size for GPU 1: 20 samples
Batch processed: 4 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 300] Processing index 86[GPU Rank 2 | Producer 292] Processing index 138
[GPU Rank 1 | Producer 305] Processing index 110

[GPU Rank 0 | Producer 306] Processing index 38
[GPU Rank 2] Processed batch 5.
[GPU Rank 3] Processed batch 5.
[GPU Rank 0] Processed batch 5.
[GPU Rank 1] Processed batch 5.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 303] Processing index 145
[GPU Rank 3 | Producer 300] Processing index 0
tensor(0.2145, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2058, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2653, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2942, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 146
[GPU Rank 2 | Producer 292] Processing index 99
Batch processed: Batch processed:5 for rank:  35
 for rank:Batch processed: 2Queue size for GPU 3: 20 samples 

5 for rank: Queue size for GPU 2: 20 samples0

Queue size for GPU 0: 20 samples
Batch processed: 5 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 296] Processing index 144[GPU Rank 2 | Producer 295] Processing index 141
[GPU Rank 0 | Producer 294] Processing index 134

[GPU Rank 1 | Producer 293] Processing index 164
[GPU Rank 3] Processed batch 6.
[GPU Rank 2] Processed batch 6.
[GPU Rank 1] Processed batch 6.
[GPU Rank 0] Processed batch 6.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 306] Processing index 0
tensor(0.2393, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1637, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2471, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3091, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 294] Processing index 59
[GPU Rank 1 | Producer 293] Processing index 77
[GPU Rank 3 | Producer 296] Processing index 35
[GPU Rank 2 | Producer 295] Processing index 129
Batch processed: 6 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed:Batch processed:  6 6for rank:  1for rank: 
2
Batch processed: 6 Queue size for GPU 1: 20 samplesfor rank:
 0
Queue size for GPU 2: 20 samples
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 291] Processing index 11
[GPU Rank 1 | Producer 305] Processing index 78[GPU Rank 2 | Producer 299] Processing index 103[GPU Rank 0 | Producer 298] Processing index 165


[GPU Rank 0] Processed batch 7.
[GPU Rank 1] Processed batch 7.
[GPU Rank 3] Processed batch 7.
[GPU Rank 2] Processed batch 7.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 299] Processing index 156
tensor(0.1879, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2040, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2610, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1789, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 112
[GPU Rank 3 | Producer 291] Processing index 136
[GPU Rank 0 | Producer 298] Processing index 28
Batch processed: 7Batch processed: for rank:  37
 for rank: 2Queue size for GPU 3: 20 samples

Batch processed:Queue size for GPU 2: 20 samples 
7 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 7 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 295] Processing index 160
[GPU Rank 3 | Producer 296] Processing index 124
[GPU Rank 0 | Producer 294] Processing index 8[GPU Rank 1 | Producer 293] Processing index 150

[GPU Rank 2] Processed batch 8.
[GPU Rank 3] Processed batch 8.
[GPU Rank 1] Processed batch 8.
[GPU Rank 0] Processed batch 8.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2340, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2402, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2711, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1968, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 47
[GPU Rank 0 | Producer 294] Processing index 6
[GPU Rank 2 | Producer 295] Processing index 143
[GPU Rank 1 | Producer 293] Processing index 128
Batch processed: 8 for rank: 3Batch processed:
 8Queue size for GPU 3: 20 samples 
for rank: Batch processed:1
 Queue size for GPU 1: 20 samples8
 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 8 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 1 | Producer 305] Processing index 162
[GPU Rank 3 | Producer 291] Processing index 90[GPU Rank 2 | Producer 299] Processing index 9

[GPU Rank 0 | Producer 302] Processing index 57
[GPU Rank 3] Processed batch 9.
[GPU Rank 1] Processed batch 9.
[GPU Rank 2] Processed batch 9.
[GPU Rank 0] Processed batch 9.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1277, device='cuda:3', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 291] Processing index 153
tensor(0.2802, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1458, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2258, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 26
[GPU Rank 2 | Producer 299] Processing index 26
Batch processed: 9 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 9 Batch processed:for rank: 1 
9Batch processed: for rank:  09
 for rank: 2
Queue size for GPU 0: 20 samples
Queue size for GPU 2: 20 samples
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 296] Processing index 137
[GPU Rank 2 | Producer 295] Processing index 114
[GPU Rank 1 | Producer 293] Processing index 122
[GPU Rank 0] Processed batch 10.
[GPU Rank 2] Processed batch 10.
[GPU Rank 1] Processed batch 10.
[GPU Rank 3] Processed batch 10.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 141
tensor(0.1876, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2220, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2281, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2327, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 306] Processing index 102
[GPU Rank 1 | Producer 293] Processing index 120
[GPU Rank 2 | Producer 295] Processing index 41
[GPU Rank 0 | Producer 306] Processing index 152
Batch processed:Batch processed:  10 for rank:10  2for rank:
Batch processed: 3 Batch processed:
10Queue size for GPU 2: 20 samples  
for rank:10 Queue size for GPU 3: 20 samples 0
for rank:
 1
Queue size for GPU 1: 20 samples
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 291] Processing index 65[GPU Rank 2 | Producer 292] Processing index 72
[GPU Rank 0 | Producer 298] Processing index 151[GPU Rank 1 | Producer 301] Processing index 14


[GPU Rank 0] Processed batch 11.
[GPU Rank 2] Processed batch 11.
[GPU Rank 3] Processed batch 11.
[GPU Rank 1] Processed batch 11.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2565, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2434, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3277, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1816, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 82
[GPU Rank 0 | Producer 298] Processing index 76
[GPU Rank 3 | Producer 291] Processing index 154
[GPU Rank 2 | Producer 292] Processing index 43
[GPU Rank 1 | Producer 301] Processing index 145
Batch processed:Batch processed:  1111 for rank: 2
 for rank: 3Queue size for GPU 2: 20 samples

Queue size for GPU 3: 20 samples
Batch processed: 11 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 11 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 295] Processing index 63
[GPU Rank 3 | Producer 300] Processing index 19
[GPU Rank 0 | Producer 302] Processing index 110[GPU Rank 1 | Producer 293] Processing index 158

[GPU Rank 2] Processed batch 12.
[GPU Rank 3] Processed batch 12.
[GPU Rank 0] Processed batch 12.
[GPU Rank 1] Processed batch 12.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1091, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2365, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1931, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2741, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 65
[GPU Rank 3 | Producer 300] Processing index 51
[GPU Rank 2 | Producer 295] Processing index 107
[GPU Rank 1 | Producer 293] Processing index 92
Batch processed:Batch processed:  1212  for rank:for rank:  31

Queue size for GPU 3: 20 samplesBatch processed:Queue size for GPU 1: 20 samples

 12 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 12 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 0 | Producer 302] Processing index 97
[GPU Rank 3 | Producer 304] Processing index 32
[GPU Rank 2 | Producer 299] Processing index 104[GPU Rank 1 | Producer 305] Processing index 8

[GPU Rank 2] Processed batch 13.
[GPU Rank 0] Processed batch 13.
[GPU Rank 3] Processed batch 13.[GPU Rank 1] Processed batch 13.

loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2046, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1746, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2403, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2096, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 101
[GPU Rank 1 | Producer 305] Processing index 64
[GPU Rank 3 | Producer 304] Processing index 161
[GPU Rank 2 | Producer 299] Processing index 83
Batch processed:Batch processed:  1313  for rank:for rank:  31

Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

Batch processed: 13 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 13 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 295] Processing index 22[GPU Rank 0 | Producer 306] Processing index 45[GPU Rank 3 | Producer 300] Processing index 16
[GPU Rank 1 | Producer 293] Processing index 157


[GPU Rank 3] Processed batch 14.
[GPU Rank 0] Processed batch 14.
[GPU Rank 1] Processed batch 14.
[GPU Rank 2] Processed batch 14.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2841, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1467, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2180, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2843, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 43
[GPU Rank 0 | Producer 306] Processing index 63
[GPU Rank 1 | Producer 293] Processing index 94
[GPU Rank 2 | Producer 295] Processing index 164
Batch processed:Batch processed:  Batch processed:Batch processed:1414   for rank: for rank: 14 143 1 
for rank:for rank:
  02

Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

Queue size for GPU 2: 20 samplesQueue size for GPU 0: 20 samples

[GPU Rank 2 | Producer 299] Processing index 65[GPU Rank 3 | Producer 296] Processing index 60[GPU Rank 0 | Producer 298] Processing index 93
[GPU Rank 1 | Producer 297] Processing index 140


[GPU Rank 3] Processed batch 15.
[GPU Rank 1] Processed batch 15.
[GPU Rank 2] Processed batch 15.
[GPU Rank 0] Processed batch 15.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2041, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2685, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2309, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2547, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 297] Processing index 42
[GPU Rank 3 | Producer 296] Processing index 126
[GPU Rank 2 | Producer 299] Processing index 60
[GPU Rank 0 | Producer 298] Processing index 17
Batch processed: 15 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: Batch processed:15  for rank: 152 
for rank: 1
Queue size for GPU 2: 20 samples
Batch processed: Queue size for GPU 1: 20 samples15
 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 292] Processing index 69[GPU Rank 0 | Producer 306] Processing index 46
[GPU Rank 3 | Producer 300] Processing index 8

[GPU Rank 1 | Producer 293] Processing index 164
[GPU Rank 2] Processed batch 16.
[GPU Rank 0] Processed batch 16.
[GPU Rank 3] Processed batch 16.
[GPU Rank 1] Processed batch 16.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1826, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2438, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2656, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2726, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 29
[GPU Rank 1 | Producer 293] Processing index 77
[GPU Rank 2 | Producer 292] Processing index 31
[GPU Rank 0 | Producer 306] Processing index 121
Batch processed: 16Batch processed: Batch processed:for rank: Batch processed:  016 16
 16 for rank:  for rank:for rank:3 Queue size for GPU 0: 20 samples 
1
2

Queue size for GPU 3: 20 samples
Queue size for GPU 2: 20 samplesQueue size for GPU 1: 20 samples

[GPU Rank 2 | Producer 299] Processing index 30[GPU Rank 3 | Producer 296] Processing index 87[GPU Rank 0 | Producer 302] Processing index 68

[GPU Rank 1 | Producer 305] Processing index 55

[GPU Rank 2] Processed batch 17.
[GPU Rank 0] Processed batch 17.
[GPU Rank 3] Processed batch 17.
[GPU Rank 1] Processed batch 17.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2008, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2478, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2318, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2535, device='cuda:2', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 114
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 1 | Producer 305] Processing index 133
[GPU Rank 2 | Producer 299] Processing index 50
Batch processed:Batch processed:  1717  for rank:for rank:  20

Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samples

Batch processed: 17 Batch processed:for rank:  1
17 for rank: 3
Queue size for GPU 1: 20 samples
Queue size for GPU 3: 20 samples
[GPU Rank 0 | Producer 306] Processing index 14
[GPU Rank 2 | Producer 292] Processing index 125
[GPU Rank 3 | Producer 300] Processing index 3
[GPU Rank 1 | Producer 293] Processing index 150
[GPU Rank 0] Processed batch 18.
[GPU Rank 2] Processed batch 18.
[GPU Rank 1] Processed batch 18.
[GPU Rank 3] Processed batch 18.
loss_value in pytorch loss_value in pytorchloss_value in pytorch  loss_value in pytorch tensor(0.2403, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2682, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2244, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3377, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 292] Processing index 106
[GPU Rank 3 | Producer 300] Processing index 94
[GPU Rank 1 | Producer 293] Processing index 128
[GPU Rank 0 | Producer 306] Processing index 80
Batch processed:Batch processed:  1818  for rank:for rank:  31

Batch processed:Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samplesBatch processed:

  1818  for rank:for rank:  02

Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samples

[GPU Rank 3 | Producer 296] Processing index 144
[GPU Rank 1 | Producer 297] Processing index 23
[GPU Rank 2 | Producer 299] Processing index 103[GPU Rank 0 | Producer 302] Processing index 86

[GPU Rank 3] Processed batch 19.[GPU Rank 1] Processed batch 19.

[GPU Rank 2] Processed batch 19.
[GPU Rank 0] Processed batch 19.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 299] Processing index 156
[GPU Rank 0 | Producer 302] Processing index 145
tensor(0.1714, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2610, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1598, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.1910, device='cuda:3', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 35
[GPU Rank 1 | Producer 297] Processing index 127
Batch processed: 19Batch processed:Batch processed: for rank:   01919
  for rank:for rank:  31Queue size for GPU 0: 20 samples


Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

Batch processed: 19 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 0 | Producer 306] Processing index 38
[GPU Rank 3 | Producer 300] Processing index 86[GPU Rank 1 | Producer 305] Processing index 110

[GPU Rank 2 | Producer 295] Processing index 141
[GPU Rank 0] Processed batch 20.
[GPU Rank 3] Processed batch 20.
[GPU Rank 1] Processed batch 20.
[GPU Rank 2] Processed batch 20.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 3 | Producer 300] Processing index 0
tensor(0.2266, device='cuda:3', grad_fn=<DivBackward0>)tensor(0.2424, device='cuda:0', grad_fn=<DivBackward0>)

tensor(0.1902, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2735, device='cuda:2', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 146
[GPU Rank 2 | Producer 295] Processing index 129
Batch processed: 20 for rank: 3
Batch processed:Queue size for GPU 3: 20 samples
Batch processed:  20 20for rank:  for rank:2 
1
Queue size for GPU 2: 20 samplesQueue size for GPU 1: 20 samples

Batch processed: 20 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 304] Processing index 17
[GPU Rank 2 | Producer 299] Processing index 9
[GPU Rank 1 | Producer 293] Processing index 122
[GPU Rank 0 | Producer 298] Processing index 4
[GPU Rank 2] Processed batch 21.
[GPU Rank 3] Processed batch 21.
[GPU Rank 1] Processed batch 21.
[GPU Rank 0] Processed batch 21.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 306] Processing index 0
tensor(0.2148, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1688, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2163, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2767, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 293] Processing index 120
[GPU Rank 3 | Producer 304] Processing index 88
[GPU Rank 2 | Producer 299] Processing index 26
Batch processed:Batch processed:  2121  for rank:for rank:  3
1RAISE StopIteration

RAISE StopIteration
Batch processed:Batch processed:  2121  for rank:for rank:  02

RAISE StopIterationRAISE StopIteration

Batch processed:Batch processed:  00  for rank: for rank:3 
1
Queue size for GPU 3: 20 samples
Queue size for GPU 1: 20 samples
Batch processed: 0 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 3 | Producer 304] Processing index 158
[GPU Rank 1 | Producer 305] Processing index 78
[GPU Rank 2 | Producer 292] Processing index 152:::MLLOG {"namespace": "", "time_ms": 1743705460168, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 106, "epoch_num": 18, "current_lr": 0.8}}

:::MLLOG {"namespace": "", "time_ms": 1743705460169, "event_type": "INTERVAL_END", "key": "block_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 135, "first_epoch_num": 18, "epoch_count": 1}}
:::MLLOG {"namespace": "", "time_ms": 1743705460169, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 66, "first_epoch_num": 19, "epoch_count": 1}}
[GPU Rank 3] Processed batch 1.
:::MLLOG {"namespace": "", "time_ms": 1743705460170, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 68, "epoch_num": 19}}
[GPU Rank 2] Processed batch 1.
Batch processed: 0 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 1] Processed batch 1.
[GPU Rank 0 | Producer 306] Processing index 102
[GPU Rank 0] Processed batch 1.
loss_value in pytorch [GPU Rank 0 | Producer 298] Processing index 74
loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1127, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1599, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1667, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1709, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 306] Processing index 152
[GPU Rank 1 | Producer 305] Processing index 112
[GPU Rank 2 | Producer 292] Processing index 35
[GPU Rank 3 | Producer 304] Processing index 99
Batch processed:Batch processed:  11  for rank:for rank:  30

Batch processed:Queue size for GPU 3: 20 samples
 Queue size for GPU 0: 20 samples1
 for rank: Batch processed:1
 1 for rank: 2
Queue size for GPU 1: 20 samples
Queue size for GPU 2: 20 samples
[GPU Rank 3 | Producer 291] Processing index 54[GPU Rank 0 | Producer 294] Processing index 43
[GPU Rank 2 | Producer 299] Processing index 104

[GPU Rank 1 | Producer 293] Processing index 158
[GPU Rank 0] Processed batch 2.
[GPU Rank 1] Processed batch 2.
[GPU Rank 3] Processed batch 2.
[GPU Rank 2] Processed batch 2.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2115, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1314, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2332, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.1668, device='cuda:3', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 299] Processing index 83
[GPU Rank 3 | Producer 291] Processing index 106
[GPU Rank 1 | Producer 293] Processing index 92
Batch processed:Batch processed:  22  for rank:for rank:  30

Queue size for GPU 3: 20 samplesQueue size for GPU 0: 20 samples

Batch processed: 2 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 2 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 0 | Producer 306] Processing index 45[GPU Rank 3 | Producer 304] Processing index 74

[GPU Rank 1 | Producer 305] Processing index 162
[GPU Rank 2 | Producer 303] Processing index 108
[GPU Rank 3] Processed batch 3.[GPU Rank 0] Processed batch 3.

[GPU Rank 1] Processed batch 3.
[GPU Rank 2] Processed batch 3.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 294] Processing index 75
tensor(0.2225, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1715, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2020, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2374, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 26
[GPU Rank 0 | Producer 306] Processing index 63
[GPU Rank 3 | Producer 304] Processing index 23
[GPU Rank 2 | Producer 303] Processing index 137
Batch processed: 3 for rank:Batch processed: 3
 3 for rank: Queue size for GPU 3: 20 samples2

Queue size for GPU 2: 20 samples
Batch processed: 3 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 3 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 296] Processing index 124
[GPU Rank 2 | Producer 299] Processing index 65[GPU Rank 0 | Producer 294] Processing index 106

[GPU Rank 1 | Producer 301] Processing index 35
[GPU Rank 3] Processed batch 4.
[GPU Rank 2] Processed batch 4.
[GPU Rank 1] Processed batch 4.
[GPU Rank 0] Processed batch 4.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2622, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3426, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2468, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2492, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 47
[GPU Rank 1 | Producer 301] Processing index 115
[GPU Rank 2 | Producer 299] Processing index 60
[GPU Rank 0 | Producer 294] Processing index 72
Batch processed: 4 Batch processed:for rank: 2 
4 for rank: Queue size for GPU 2: 20 samples3

Queue size for GPU 3: 20 samples
Batch processed: 4 for rank: 1
Batch processed: 4 for rank:Queue size for GPU 1: 20 samples 
0
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 304] Processing index 131[GPU Rank 0 | Producer 306] Processing index 46
[GPU Rank 2 | Producer 295] Processing index 160

[GPU Rank 1 | Producer 305] Processing index 8
[GPU Rank 3] Processed batch 5.
[GPU Rank 2] Processed batch 5.
[GPU Rank 1] Processed batch 5.
[GPU Rank 0] Processed batch 5.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2772, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2444, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.4068, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2683, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 64
[GPU Rank 2 | Producer 295] Processing index 143
[GPU Rank 3 | Producer 304] Processing index 52
[GPU Rank 0 | Producer 306] Processing index 121
Batch processed: 5 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 5 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 5 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 5 for rank: 0
[GPU Rank 3 | Producer 296] Processing index 137Queue size for GPU 0: 20 samples[GPU Rank 2 | Producer 303] Processing index 87

[GPU Rank 1 | Producer 297] Processing index 136

[GPU Rank 0 | Producer 298] Processing index 111
[GPU Rank 3] Processed batch 6.
[GPU Rank 2] Processed batch 6.
[GPU Rank 1] Processed batch 6.
[GPU Rank 0] Processed batch 6.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2959, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3421, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2775, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3244, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 303] Processing index 136
[GPU Rank 1 | Producer 297] Processing index 16
[GPU Rank 0 | Producer 298] Processing index 62
Batch processed: 6 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 6 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 6 for rank:Batch processed: 1 
6 for rank: 0
Queue size for GPU 1: 20 samples
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 304] Processing index 32
[GPU Rank 0 | Producer 302] Processing index 57
[GPU Rank 1 | Producer 305] Processing index 55[GPU Rank 2 | Producer 292] Processing index 138

[GPU Rank 3] Processed batch 7.
[GPU Rank 2] Processed batch 7.
[GPU Rank 0] Processed batch 7.
[GPU Rank 1] Processed batch 7.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2203, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1621, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1835, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2567, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 82
[GPU Rank 1 | Producer 305] Processing index 133
[GPU Rank 3 | Producer 304] Processing index 161
[GPU Rank 2 | Producer 292] Processing index 99
Batch processed:Batch processed: 7  for rank:7  2for rank:
 3Batch processed:
Queue size for GPU 2: 20 samples 
7 for rank:Queue size for GPU 3: 20 samples 
0
Queue size for GPU 0: 20 samples
Batch processed: 7 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 291] Processing index 146
[GPU Rank 2 | Producer 303] Processing index 113
[GPU Rank 0 | Producer 294] Processing index 166[GPU Rank 1 | Producer 293] Processing index 157

[GPU Rank 2] Processed batch 8.
[GPU Rank 0] Processed batch 8.
[GPU Rank 3] Processed batch 8.
[GPU Rank 1] Processed batch 8.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 141
tensor(0.2334, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2024, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2524, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2056, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 303] Processing index 74
[GPU Rank 3 | Producer 291] Processing index 46
[GPU Rank 1 | Producer 293] Processing index 94
[GPU Rank 0 | Producer 294] Processing index 55
Batch processed:Batch processed:  88  for rank:for rank:  32

Queue size for GPU 3: 20 samplesQueue size for GPU 2: 20 samples

Batch processed: Batch processed:8  8for rank:  for rank:1 
0
Queue size for GPU 0: 20 samples
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 304] Processing index 17
[GPU Rank 2 | Producer 295] Processing index 114[GPU Rank 0 | Producer 306] Processing index 14[GPU Rank 1 | Producer 305] Processing index 110


[GPU Rank 3] Processed batch 9.
[GPU Rank 1] Processed batch 9.
[GPU Rank 0] Processed batch 9.
[GPU Rank 2] Processed batch 9.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1690, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1471, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1747, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2324, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 146
[GPU Rank 3 | Producer 304] Processing index 88
[GPU Rank 2 | Producer 295] Processing index 41
[GPU Rank 0 | Producer 306] Processing index 80
Batch processed: Batch processed:9 for rank:  39
 for rank: 2Queue size for GPU 3: 20 samples

Batch processed: Queue size for GPU 2: 20 samples9
 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 300] Processing index 19[GPU Rank 2 | Producer 303] Processing index 20
[GPU Rank 1 | Producer 297] Processing index 0

Batch processed: 9 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3] Processed batch 10.
[GPU Rank 2] Processed batch 10.
[GPU Rank 0 | Producer 302] Processing index 110[GPU Rank 1] Processed batch 10.

[GPU Rank 0] Processed batch 10.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2735, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2113, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2229, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1782, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 65
[GPU Rank 1 | Producer 297] Processing index 125
[GPU Rank 3 | Producer 300] Processing index 51
Batch processed: 10 for rank: 2
Batch processed: Queue size for GPU 2: 20 samples
10 for rank: 3Batch processed:
 10 for rank:Batch processed: Queue size for GPU 3: 20 samples
0 
10 for rank: 1
Queue size for GPU 1: 20 samples
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 295] Processing index 63
[GPU Rank 3 | Producer 296] Processing index 60[GPU Rank 0 | Producer 306] Processing index 38[GPU Rank 1 | Producer 305] Processing index 78


[GPU Rank 3] Processed batch 11.
[GPU Rank 0] Processed batch 11.
[GPU Rank 1] Processed batch 11.
[GPU Rank 2] Processed batch 11.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 303] Processing index 49
tensor(0.2362, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1422, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3175, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2202, device='cuda:2', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 112
[GPU Rank 3 | Producer 296] Processing index 126
[GPU Rank 2 | Producer 295] Processing index 107
Batch processed:Batch processed:  1111  for rank:for rank:  02

Queue size for GPU 2: 20 samplesQueue size for GPU 0: 20 samples

Batch processed: 11 for rank: 1
Batch processed: Queue size for GPU 1: 20 samples11
 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 0 | Producer 302] Processing index 97
[GPU Rank 2 | Producer 299] Processing index 30
[GPU Rank 1 | Producer 301] Processing index 63
[GPU Rank 3 | Producer 300] Processing index 16
[GPU Rank 1] Processed batch 12.
[GPU Rank 3] Processed batch 12.
[GPU Rank 0] Processed batch 12.
[GPU Rank 2] Processed batch 12.
[GPU Rank 0 | Producer 306] Processing index 0
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2270, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1918, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2307, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.1965, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 101
[GPU Rank 3 | Producer 300] Processing index 43
[GPU Rank 1 | Producer 301] Processing index 143
[GPU Rank 2 | Producer 299] Processing index 50
Batch processed:Batch processed:  1212  for rank:for rank:  23

Queue size for GPU 2: 20 samplesQueue size for GPU 3: 20 samples

Batch processed: 12 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 12 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 296] Processing index 87[GPU Rank 2 | Producer 295] Processing index 22
[GPU Rank 0 | Producer 306] Processing index 102[GPU Rank 1 | Producer 305] Processing index 162


[GPU Rank 3] Processed batch 13.
[GPU Rank 0] Processed batch 13.
[GPU Rank 2] Processed batch 13.
[GPU Rank 1] Processed batch 13.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.0934, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1390, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2249, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2929, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 306] Processing index 152
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 1 | Producer 305] Processing index 26
[GPU Rank 2 | Producer 295] Processing index 164
Batch processed: 13 for rank: 3
Queue size for GPU 3: 20 samplesBatch processed:Batch processed:
  Batch processed:1313   for rank:for rank:  1320 

for rank: 1
Queue size for GPU 2: 20 samplesQueue size for GPU 0: 20 samples

Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 291] Processing index 11[GPU Rank 2 | Producer 299] Processing index 103[GPU Rank 1 | Producer 293] Processing index 164
[GPU Rank 0 | Producer 302] Processing index 68


[GPU Rank 0] Processed batch 14.
[GPU Rank 3] Processed batch 14.
[GPU Rank 1] Processed batch 14.
[GPU Rank 2] Processed batch 14.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 299] Processing index 156
tensor(0.2785, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2054, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4418, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2524, device='cuda:2', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 114
[GPU Rank 1 | Producer 293] Processing index 77
[GPU Rank 3 | Producer 291] Processing index 136
Batch processed: 14 for rank: 3
Batch processed:Queue size for GPU 3: 20 samples
 Batch processed:14  for rank: 140 
for rank: 1
Queue size for GPU 0: 20 samples
Queue size for GPU 1: 20 samples
Batch processed: 14 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 3 | Producer 296] Processing index 144
[GPU Rank 0 | Producer 306] Processing index 45
[GPU Rank 1 | Producer 305] Processing index 8
[GPU Rank 2 | Producer 303] Processing index 38
[GPU Rank 3] Processed batch 15.
[GPU Rank 2] Processed batch 15.[GPU Rank 0] Processed batch 15.

[GPU Rank 1] Processed batch 15.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1649, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2387, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3267, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2710, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 64
[GPU Rank 0 | Producer 306] Processing index 63
[GPU Rank 3 | Producer 296] Processing index 35
Batch processed:Batch processed:  1515  for rank:Batch processed:for rank:  02
 
15 Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samplesfor rank:

 3
Queue size for GPU 3: 20 samples
Batch processed: 15 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 299] Processing index 9
[GPU Rank 0 | Producer 302] Processing index 86[GPU Rank 3 | Producer 291] Processing index 90

[GPU Rank 1 | Producer 293] Processing index 150
[GPU Rank 3] Processed batch 16.
[GPU Rank 1] Processed batch 16.
[GPU Rank 2] Processed batch 16.
[GPU Rank 0] Processed batch 16.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 303] Processing index 145
[GPU Rank 0 | Producer 302] Processing index 145
tensor(0.2443, device='cuda:3', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 291] Processing index 153
tensor(0.2077, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2990, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1900, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 299] Processing index 26
[GPU Rank 1 | Producer 293] Processing index 128
Batch processed: 16 for rank: 3
Batch processed:Batch processed:Queue size for GPU 3: 20 samples
  1616  for rank:for rank:  02

Queue size for GPU 2: 20 samplesQueue size for GPU 0: 20 samples

Batch processed: 16 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 296] Processing index 124[GPU Rank 0 | Producer 306] Processing index 46[GPU Rank 1 | Producer 305] Processing index 55


[GPU Rank 2 | Producer 292] Processing index 72
[GPU Rank 3] Processed batch 17.
[GPU Rank 0] Processed batch 17.
[GPU Rank 2] Processed batch 17.
[GPU Rank 1] Processed batch 17.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1970, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2066, device='cuda:2', grad_fn=<DivBackward0>)tensor(0.1994, device='cuda:0', grad_fn=<DivBackward0>)

tensor(0.2269, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 47
[GPU Rank 1 | Producer 305] Processing index 133
[GPU Rank 0 | Producer 306] Processing index 121
[GPU Rank 2 | Producer 292] Processing index 43
Batch processed: Batch processed:17  for rank: 172 
for rank: 3
Queue size for GPU 2: 20 samples
Queue size for GPU 3: 20 samples
Batch processed: 17 for rank: Batch processed:1
 17 for rank: 0
Queue size for GPU 0: 20 samples
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 291] Processing index 65
[GPU Rank 2 | Producer 299] Processing index 104
[GPU Rank 0 | Producer 294] Processing index 134
[GPU Rank 1 | Producer 301] Processing index 19
[GPU Rank 3] Processed batch 18.
[GPU Rank 0] Processed batch 18.
[GPU Rank 1] Processed batch 18.[GPU Rank 2] Processed batch 18.

loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2510, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2929, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1451, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2441, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 294] Processing index 59
[GPU Rank 1 | Producer 301] Processing index 141
[GPU Rank 2 | Producer 299] Processing index 83
[GPU Rank 3 | Producer 291] Processing index 154
Batch processed:Batch processed:  1818  for rank:for rank:  20

Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samples
Batch processed:
 18 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 18 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 0 | Producer 306] Processing index 14[GPU Rank 3 | Producer 296] Processing index 137

[GPU Rank 2 | Producer 295] Processing index 141
[GPU Rank 1 | Producer 293] Processing index 122
[GPU Rank 3] Processed batch 19.
[GPU Rank 0] Processed batch 19.
[GPU Rank 1] Processed batch 19.
[GPU Rank 2] Processed batch 19.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2140, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3036, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1784, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2575, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 293] Processing index 120
[GPU Rank 2 | Producer 295] Processing index 129
[GPU Rank 0 | Producer 306] Processing index 80
Batch processed:Batch processed:  1919  for rank:for rank:  20

Batch processed:Queue size for GPU 0: 20 samples 
Queue size for GPU 2: 20 samples
19 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 19 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 300] Processing index 8[GPU Rank 0 | Producer 294] Processing index 8

[GPU Rank 2 | Producer 292] Processing index 69[GPU Rank 1 | Producer 305] Processing index 110

[GPU Rank 0] Processed batch 20.
[GPU Rank 3] Processed batch 20.[GPU Rank 2] Processed batch 20.

[GPU Rank 1] Processed batch 20.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2107, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3185, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2176, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2602, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 294] Processing index 6
[GPU Rank 1 | Producer 305] Processing index 146
[GPU Rank 3 | Producer 296] Processing index 82
[GPU Rank 3 | Producer 300] Processing index 29
[GPU Rank 2 | Producer 292] Processing index 31
Batch processed:Batch processed:  2020  for rank:for rank:  02

Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samples

Batch processed: 20 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 20 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 1 | Producer 293] Processing index 158
[GPU Rank 2 | Producer 295] Processing index 160
[GPU Rank 0 | Producer 306] Processing index 38
[GPU Rank 3] Processed batch 21.
[GPU Rank 2] Processed batch 21.
[GPU Rank 0] Processed batch 21.
[GPU Rank 1] Processed batch 21.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 3 | Producer 296] Processing index 60
tensor(0.2349, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1743, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2348, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2081, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 295] Processing index 143
[GPU Rank 3 | Producer 296] Processing index 126
[GPU Rank 1 | Producer 293] Processing index 92
Batch processed: 21 for rank: 3
RAISE StopIterationBatch processed:
 21 for rank: 2
RAISE StopIteration
Batch processed: 21 for rank: 0
RAISE StopIteration
Batch processed: 21 for rank: 1
RAISE StopIteration
Batch processed: 0 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 0 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 3 | Producer 300] Processing index 3[GPU Rank 2 | Producer 292] Processing index 125
Batch processed: 0 for rank: 1
:::MLLOG {"namespace": "", "time_ms": 1743705476699, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 106, "epoch_num": 19, "current_lr": 0.8}}
Queue size for GPU 1: 20 samples

:::MLLOG {"namespace": "", "time_ms": 1743705476700, "event_type": "INTERVAL_END", "key": "block_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 135, "first_epoch_num": 19, "epoch_count": 1}}
[GPU Rank 1 | Producer 305] Processing index 78
[GPU Rank 2] Processed batch 1.
[GPU Rank 3] Processed batch 1.
:::MLLOG {"namespace": "", "time_ms": 1743705476701, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 66, "first_epoch_num": 20, "epoch_count": 1}}
:::MLLOG {"namespace": "", "time_ms": 1743705476701, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 68, "epoch_num": 20}}
Batch processed: 0 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 1] Processed batch 1.
[GPU Rank 0 | Producer 298] Processing index 165
[GPU Rank 0] Processed batch 1.
loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 306] Processing index 0
loss_value in pytorch tensor(0.1232, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4383, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1875, device='cuda:2', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 292] Processing index 106
tensor(0.2200, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 112
[GPU Rank 3 | Producer 300] Processing index 94
[GPU Rank 0 | Producer 298] Processing index 28
Batch processed: 1 for rank: 3Batch processed:Batch processed:
  11Queue size for GPU 3: 20 samples  
for rank:for rank:  20

Queue size for GPU 2: 20 samplesQueue size for GPU 0: 20 samples

Batch processed: 1 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 296] Processing index 87[GPU Rank 2 | Producer 295] Processing index 114[GPU Rank 0 | Producer 302] Processing index 57[GPU Rank 1 | Producer 293] Processing index 157



[GPU Rank 3] Processed batch 2.
[GPU Rank 2] Processed batch 2.
[GPU Rank 0] Processed batch 2.
[GPU Rank 1] Processed batch 2.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2641, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2708, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2645, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1712, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 2 | Producer 295] Processing index 41
[GPU Rank 1 | Producer 293] Processing index 94
Batch processed: 2 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 2 Batch processed:for rank:  02
 Queue size for GPU 0: 20 samplesfor rank:
 2
Queue size for GPU 2: 20 samples
Batch processed: 2 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 292] Processing index 152[GPU Rank 3 | Producer 300] Processing index 86
[GPU Rank 0 | Producer 298] Processing index 151[GPU Rank 1 | Producer 305] Processing index 162


[GPU Rank 0] Processed batch 3.
[GPU Rank 3] Processed batch 3.
[GPU Rank 2] Processed batch 3.
[GPU Rank 1] Processed batch 3.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 141
[GPU Rank 3 | Producer 300] Processing index 0
tensor(0.2342, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2165, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2749, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1964, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 26
[GPU Rank 0 | Producer 298] Processing index 76
[GPU Rank 2 | Producer 292] Processing index 35
Batch processed:Batch processed:  33Batch processed:  for rank:for rank:   02

3 for rank: 3Queue size for GPU 2: 20 samplesQueue size for GPU 0: 20 samples
Batch processed:

 3Queue size for GPU 3: 20 samples 
for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 296] Processing index 144
[GPU Rank 2 | Producer 295] Processing index 63
[GPU Rank 0 | Producer 306] Processing index 102
[GPU Rank 1 | Producer 297] Processing index 152
[GPU Rank 3] Processed batch 4.
[GPU Rank 1] Processed batch 4.
[GPU Rank 2] Processed batch 4.
[GPU Rank 0] Processed batch 4.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2129, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2344, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1825, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1922, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 306] Processing index 152
[GPU Rank 2 | Producer 295] Processing index 107
[GPU Rank 1 | Producer 297] Processing index 46
[GPU Rank 3 | Producer 296] Processing index 35
Batch processed: 4 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 4 for rank: 3
Batch processed:Queue size for GPU 3: 20 samples
 4 for rank: 0
Batch processed: 4 for rank: 1Queue size for GPU 0: 20 samples

Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 299] Processing index 65
[GPU Rank 3 | Producer 304] Processing index 158
[GPU Rank 0 | Producer 302] Processing index 110
[GPU Rank 1 | Producer 301] Processing index 56
[GPU Rank 2] Processed batch 5.
[GPU Rank 3] Processed batch 5.
[GPU Rank 1] Processed batch 5.
[GPU Rank 0] Processed batch 5.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1996, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2073, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1740, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2292, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 65
[GPU Rank 1 | Producer 301] Processing index 167
[GPU Rank 2 | Producer 299] Processing index 60
[GPU Rank 3 | Producer 304] Processing index 99
Batch processed: 5 for rank: 3
Batch processed: Batch processed:5Queue size for GPU 3: 20 samples 
5  for rank:for rank:  21

Queue size for GPU 2: 20 samples
Queue size for GPU 1: 20 samples
Batch processed: 5 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 296] Processing index 124[GPU Rank 2 | Producer 295] Processing index 22
[GPU Rank 1 | Producer 293] Processing index 164
[GPU Rank 0 | Producer 306] Processing index 45

[GPU Rank 1] Processed batch 6.
[GPU Rank 2] Processed batch 6.
[GPU Rank 0] Processed batch 6.
[GPU Rank 3] Processed batch 6.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1685, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1727, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2374, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1705, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 47
[GPU Rank 0 | Producer 306] Processing index 63
[GPU Rank 1 | Producer 293] Processing index 77
[GPU Rank 2 | Producer 295] Processing index 164
Batch processed: 6 for rank: Batch processed:3
 6Queue size for GPU 3: 20 samples 
for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 6 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 292] Processing index 138[GPU Rank 3 | Producer 291] Processing index 54Batch processed: 6 for rank: 0
Queue size for GPU 0: 20 samples

[GPU Rank 1 | Producer 305] Processing index 8

[GPU Rank 0 | Producer 298] Processing index 93
[GPU Rank 2] Processed batch 7.
[GPU Rank 3] Processed batch 7.
[GPU Rank 1] Processed batch 7.
[GPU Rank 0] Processed batch 7.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.0905, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2164, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1875, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.0774, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 64
[GPU Rank 0 | Producer 298] Processing index 17
[GPU Rank 3 | Producer 291] Processing index 106
[GPU Rank 2 | Producer 292] Processing index 99
Batch processed: 7 for rank: 3
Batch processed:Queue size for GPU 3: 20 samples
 7 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: Batch processed:7 for rank:  0
7 for rank: 1
Queue size for GPU 0: 20 samples
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 303] Processing index 108
[GPU Rank 3 | Producer 296] Processing index 137
[GPU Rank 1 | Producer 293] Processing index 150
[GPU Rank 0 | Producer 306] Processing index 46
[GPU Rank 2] Processed batch 8.
[GPU Rank 3] Processed batch 8.
[GPU Rank 0] Processed batch 8.
[GPU Rank 1] Processed batch 8.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2320, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2091, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2525, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2177, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 303] Processing index 137
[GPU Rank 1 | Producer 293] Processing index 128
[GPU Rank 0 | Producer 306] Processing index 121
Batch processed: 8 for rank:Batch processed: 2
 8Queue size for GPU 2: 20 samples 
for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 8 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 8 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 299] Processing index 30[GPU Rank 0 | Producer 302] Processing index 97
[GPU Rank 1 | Producer 305] Processing index 55

[GPU Rank 3 | Producer 291] Processing index 146
[GPU Rank 2] Processed batch 9.
[GPU Rank 3] Processed batch 9.
[GPU Rank 1] Processed batch 9.
[GPU Rank 0] Processed batch 9.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 3 | Producer 296] Processing index 82
tensor(0.2540, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2816, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2378, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.1898, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 101
[GPU Rank 1 | Producer 305] Processing index 133
[GPU Rank 3 | Producer 291] Processing index 46
[GPU Rank 2 | Producer 299] Processing index 50
Batch processed: 9 Batch processed:for rank: 2
 9 for rank:Queue size for GPU 2: 20 samples 
0
Queue size for GPU 0: 20 samplesBatch processed:
 9 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 9 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 0 | Producer 294] Processing index 43
[GPU Rank 2 | Producer 295] Processing index 141
[GPU Rank 3 | Producer 300] Processing index 19
[GPU Rank 1 | Producer 297] Processing index 140
[GPU Rank 0] Processed batch 10.
[GPU Rank 3] Processed batch 10.
[GPU Rank 2] Processed batch 10.
[GPU Rank 1] Processed batch 10.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2941, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1900, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1986, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2821, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 297] Processing index 42
[GPU Rank 3 | Producer 300] Processing index 51
[GPU Rank 2 | Producer 295] Processing index 129
Batch processed: 10 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 10Batch processed: for rank: 0 
10 for rank:Queue size for GPU 0: 20 samples
 3
Queue size for GPU 3: 20 samples
Batch processed: 10 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 303] Processing index 87
[GPU Rank 0 | Producer 298] Processing index 4[GPU Rank 1 | Producer 293] Processing index 122
[GPU Rank 3 | Producer 296] Processing index 60

[GPU Rank 2] Processed batch 11.
[GPU Rank 0] Processed batch 11.
[GPU Rank 3] Processed batch 11.
[GPU Rank 1] Processed batch 11.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 294] Processing index 75
tensor(0.1807, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1524, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2176, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.1805, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 303] Processing index 136
[GPU Rank 1 | Producer 293] Processing index 120
[GPU Rank 3 | Producer 296] Processing index 126
[GPU Rank 0 | Producer 298] Processing index 74
Batch processed:Batch processed:  1111  for rank:for rank:  23
Batch processed:
 Queue size for GPU 3: 20 samples11Batch processed:Queue size for GPU 2: 20 samples
 
for rank:  011
 for rank: 1
Queue size for GPU 0: 20 samplesQueue size for GPU 1: 20 samples

[GPU Rank 3 | Producer 300] Processing index 16[GPU Rank 2 | Producer 295] Processing index 160[GPU Rank 1 | Producer 305] Processing index 110[GPU Rank 0 | Producer 306] Processing index 14



[GPU Rank 3] Processed batch 12.
[GPU Rank 2] Processed batch 12.
[GPU Rank 1] Processed batch 12.
[GPU Rank 0] Processed batch 12.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1387, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2698, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2050, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1572, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 43
[GPU Rank 1 | Producer 305] Processing index 146
[GPU Rank 2 | Producer 295] Processing index 143
[GPU Rank 0 | Producer 306] Processing index 80
Batch processed: 12 for rank: 3Batch processed:
 12 for rank:Queue size for GPU 3: 20 samples 
Batch processed:2
 12 for rank: 1
Queue size for GPU 2: 20 samples
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 296] Processing index 87Batch processed: 12 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 1 | Producer 293] Processing index 158

[GPU Rank 2 | Producer 303] Processing index 113
[GPU Rank 0 | Producer 302] Processing index 68
[GPU Rank 3] Processed batch 13.
[GPU Rank 2] Processed batch 13.
[GPU Rank 1] Processed batch 13.
[GPU Rank 0] Processed batch 13.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.4066, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1060, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1932, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2591, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 2 | Producer 303] Processing index 74
[GPU Rank 0 | Producer 302] Processing index 114
[GPU Rank 1 | Producer 293] Processing index 92
Batch processed: 13 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed:Batch processed:  1313  for rank:for rank:  20

Queue size for GPU 2: 20 samplesQueue size for GPU 0: 20 samples

Batch processed: 13 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 291] Processing index 11
[GPU Rank 2 | Producer 295] Processing index 114
[GPU Rank 1 | Producer 297] Processing index 23[GPU Rank 0 | Producer 306] Processing index 38

[GPU Rank 3] Processed batch 14.
[GPU Rank 2] Processed batch 14.
[GPU Rank 0] Processed batch 14.
[GPU Rank 1] Processed batch 14.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2415, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2061, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2893, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.3138, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 295] Processing index 41
[GPU Rank 3 | Producer 291] Processing index 136
[GPU Rank 1 | Producer 297] Processing index 127
[GPU Rank 0 | Producer 306] Processing index 0
Batch processed:Batch processed: 14  for rank: 142 
for rank: 3
Queue size for GPU 2: 20 samples
Queue size for GPU 3: 20 samples
Batch processed: 14 for rank: 0
Queue size for GPU 0: 20 samplesBatch processed:
 14 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 303] Processing index 20[GPU Rank 3 | Producer 296] Processing index 144

[GPU Rank 0 | Producer 302] Processing index 86
[GPU Rank 1 | Producer 301] Processing index 14
[GPU Rank 3] Processed batch 15.
[GPU Rank 2] Processed batch 15.
[GPU Rank 1] Processed batch 15.
[GPU Rank 0] Processed batch 15.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 145
tensor(0.2601, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2322, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2157, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2676, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 35
[GPU Rank 1 | Producer 301] Processing index 145
Batch processed:Batch processed:  1515  for rank:for rank:  20

Queue size for GPU 2: 20 samplesQueue size for GPU 0: 20 samples

Batch processed: 15 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 15 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 295] Processing index 63[GPU Rank 3 | Producer 291] Processing index 90[GPU Rank 0 | Producer 294] Processing index 106

[GPU Rank 1 | Producer 305] Processing index 78

[GPU Rank 0] Processed batch 16.
[GPU Rank 3] Processed batch 16.
[GPU Rank 2] Processed batch 16.
[GPU Rank 1] Processed batch 16.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 303] Processing index 49
tensor(0.1555, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2794, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1578, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.1258, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 291] Processing index 153
[GPU Rank 1 | Producer 305] Processing index 112
[GPU Rank 2 | Producer 295] Processing index 107
[GPU Rank 0 | Producer 294] Processing index 72
Batch processed: 16 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 16 for rank: 3
Batch processed:Queue size for GPU 3: 20 samples
 16 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 16 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 292] Processing index 72[GPU Rank 1 | Producer 293] Processing index 157[GPU Rank 3 | Producer 304] Processing index 74

[GPU Rank 0 | Producer 298] Processing index 111

[GPU Rank 2] Processed batch 17.
[GPU Rank 3] Processed batch 17.
[GPU Rank 0] Processed batch 17.
[GPU Rank 1] Processed batch 17.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2482, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1698, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2535, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2098, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 304] Processing index 23
[GPU Rank 1 | Producer 293] Processing index 94
[GPU Rank 0 | Producer 298] Processing index 62
[GPU Rank 2 | Producer 292] Processing index 43
Batch processed: Batch processed:17 for rank:  317 for rank: 0
Queue size for GPU 0: 20 samples

Queue size for GPU 3: 20 samples
Batch processed: Batch processed:17  for rank:17  1for rank:
 2
Queue size for GPU 2: 20 samples
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 291] Processing index 65
[GPU Rank 2 | Producer 295] Processing index 22
[GPU Rank 1 | Producer 305] Processing index 162
[GPU Rank 0 | Producer 306] Processing index 102
[GPU Rank 3] Processed batch 18.
[GPU Rank 0] Processed batch 18.
[GPU Rank 2] Processed batch 18.
[GPU Rank 1] Processed batch 18.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2002, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1800, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1893, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2712, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 306] Processing index 152
[GPU Rank 1 | Producer 305] Processing index 26
[GPU Rank 3 | Producer 291] Processing index 154
[GPU Rank 2 | Producer 295] Processing index 164
Batch processed: 18 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: Batch processed:18  for rank:18  for rank:3 
Batch processed:0
 Queue size for GPU 3: 20 samples18
 for rank: 1
Queue size for GPU 0: 20 samplesQueue size for GPU 1: 20 samples

[GPU Rank 2 | Producer 299] Processing index 103
[GPU Rank 3 | Producer 296] Processing index 124[GPU Rank 1 | Producer 293] Processing index 164
[GPU Rank 0 | Producer 298] Processing index 165

[GPU Rank 2] Processed batch 19.
[GPU Rank 3] Processed batch 19.
[GPU Rank 1] Processed batch 19.
[GPU Rank 0] Processed batch 19.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2129, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2662, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2300, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2032, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 299] Processing index 156
[GPU Rank 3 | Producer 296] Processing index 47
[GPU Rank 1 | Producer 293] Processing index 77
[GPU Rank 0 | Producer 298] Processing index 28
Batch processed: 19 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: Batch processed:19  for rank:19  3for rank:
 1
Queue size for GPU 1: 20 samplesQueue size for GPU 3: 20 samples

Batch processed: 19 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 303] Processing index 38
[GPU Rank 1 | Producer 305] Processing index 8
[GPU Rank 3 | Producer 300] Processing index 8[GPU Rank 0 | Producer 306] Processing index 45

[GPU Rank 2] Processed batch 20.
[GPU Rank 1] Processed batch 20.
[GPU Rank 3] Processed batch 20.
[GPU Rank 0] Processed batch 20.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2764, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2664, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.0946, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2401, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 64
[GPU Rank 0 | Producer 306] Processing index 63
[GPU Rank 3 | Producer 300] Processing index 29
Batch processed: 20Batch processed: for rank:  2
20 for rank: 3
Queue size for GPU 2: 20 samples
Queue size for GPU 3: 20 samples
Batch processed: Batch processed:20  20for rank:  for rank:1 
0
Queue size for GPU 0: 20 samples
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 299] Processing index 9
[GPU Rank 3 | Producer 296] Processing index 137
[GPU Rank 0 | Producer 298] Processing index 151
[GPU Rank 1 | Producer 293] Processing index 150
[GPU Rank 3] Processed batch 21.
[GPU Rank 2] Processed batch 21.
[GPU Rank 1] Processed batch 21.
[GPU Rank 0] Processed batch 21.
[GPU Rank 2 | Producer 303] Processing index 145
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1248, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1281, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3208, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3787, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 298] Processing index 76
[GPU Rank 2 | Producer 299] Processing index 26
[GPU Rank 1 | Producer 293] Processing index 128
Batch processed: 21 for rank: 2
Batch processed:RAISE StopIteration
 21 for rank: 3
RAISE StopIteration
Batch processed: 21 for rank: 1
RAISE StopIteration
Batch processed: 21 for rank: 0
RAISE StopIteration
:::MLLOG {"namespace": "", "time_ms": 1743705493227, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 106, "epoch_num": 20, "current_lr": 0.8}}
:::MLLOG {"namespace": "", "time_ms": 1743705493228, "event_type": "INTERVAL_START", "key": "eval_start", "value": 20, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 115, "epoch_num": 20}}
Batch processed: 0 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 2 | Producer 307] Processing index 9
[GPU Rank 2] Processed batch 1.
I AM HERe to evaluate
Batch processed: 0 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 3 | Producer 308] Processing index 9
[GPU Rank 3] Processed batch 1.
I AM HERe to evaluate
Batch processed: 0 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 1 | Producer 309] Processing index 9
[GPU Rank 1] Processed batch 1.
I AM HERe to evaluate
Batch processed: 0 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 0 | Producer 310] Processing index 7
[GPU Rank 0] Processed batch 1.
I AM HERe to evaluate
[GPU Rank 3 | Producer 296] Processing index 82
Batch processed: 1 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 2 | Producer 307] Processing index 0
[GPU Rank 2] Processed batch 2.
I AM HERe to evaluate
Batch processed: 1 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 3 | Producer 308] Processing index 0
[GPU Rank 3] Processed batch 2.
I AM HERe to evaluate
Batch processed: 2 for rank: 2
RAISE StopIteration
Batch processed: 2 for rank: 3
RAISE StopIteration
Batch processed: 1 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 0 | Producer 310] Processing index 8
[GPU Rank 0] Processed batch 2.
I AM HERe to evaluate
Batch processed: 1 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 1 | Producer 309] Processing index 0
[GPU Rank 1] Processed batch 2.
I AM HERe to evaluate
Batch processed: 2 for rank: 0
RAISE StopIteration
Batch processed: 2 for rank: 1
RAISE StopIteration
Batch processed: 0 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 2 | Producer 292] Processing index 69
[GPU Rank 2] Processed batch 1.
:::MLLOG {"namespace": "", "time_ms": 1743705514219, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.25942549109458923, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 120, "epoch_num": 20}}
:::MLLOG {"namespace": "", "time_ms": 1743705514220, "event_type": "INTERVAL_END", "key": "eval_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 124, "epoch_num": 20}}
DLL 2025-04-03 18:38:34.221291 - 20.0 epoch : 20.0  L1 dice : 0.4747427999973297  L2 dice : 0.044108182191848755  mean_dice : 0.25942549109458923  eval_loss : 0.4395403563976288  train_loss : 0.21821308135986328  TOP_epoch : 16.0  TOP_L1 dice : 0.47929394245147705  TOP_L2 dice : 0.09587545692920685  TOP_mean_dice : 0.28758469223976135  TOP_eval_loss : 0.4079892039299011  TOP_train_loss : 0.2473413646221161 
:::MLLOG {"namespace": "", "time_ms": 1743705514224, "event_type": "INTERVAL_END", "key": "block_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 135, "first_epoch_num": 20, "epoch_count": 1}}
:::MLLOG {"namespace": "", "time_ms": 1743705514224, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 66, "first_epoch_num": 21, "epoch_count": 1}}
Batch processed: 0 for rank: 3
Queue size for GPU 3: 20 samples
:::MLLOG {"namespace": "", "time_ms": 1743705514225, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 68, "epoch_num": 21}}
[GPU Rank 3 | Producer 296] Processing index 60
Batch processed: 0 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 0 | Producer 306] Processing index 46
Batch processed: 0 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 1 | Producer 293] Processing index 122
[GPU Rank 0] Processed batch 1.
[GPU Rank 3] Processed batch 1.
[GPU Rank 1] Processed batch 1.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2008, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2341, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2811, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.1818, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 293] Processing index 120
[GPU Rank 3 | Producer 296] Processing index 126
[GPU Rank 2 | Producer 292] Processing index 31
Batch processed:Batch processed:Batch processed:Batch processed:    11  for rank:for rank:  1131  
for rank:for rank:
  20Queue size for GPU 3: 20 samples


Queue size for GPU 1: 20 samples
Queue size for GPU 2: 20 samplesQueue size for GPU 0: 20 samples

[GPU Rank 0 | Producer 298] Processing index 93[GPU Rank 3 | Producer 304] Processing index 131[GPU Rank 2 | Producer 299] Processing index 104
[GPU Rank 1 | Producer 301] Processing index 35


[GPU Rank 1] Processed batch 2.
[GPU Rank 2] Processed batch 2.
[GPU Rank 3] Processed batch 2.
[GPU Rank 0] Processed batch 2.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 306] Processing index 121
tensor(0.2053, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2002, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2204, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2758, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 299] Processing index 83
[GPU Rank 0 | Producer 298] Processing index 17
[GPU Rank 1 | Producer 301] Processing index 115
[GPU Rank 3 | Producer 304] Processing index 52
Batch processed:Batch processed:Batch processed:   222   for rank:for rank:for rank:   320


Queue size for GPU 3: 20 samplesQueue size for GPU 2: 20 samplesQueue size for GPU 0: 20 samples


Batch processed: 2 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 295] Processing index 141
[GPU Rank 0 | Producer 302] Processing index 57[GPU Rank 3 | Producer 296] Processing index 87
[GPU Rank 1 | Producer 305] Processing index 55

[GPU Rank 0] Processed batch 3.
[GPU Rank 1] Processed batch 3.
[GPU Rank 3] Processed batch 3.
[GPU Rank 2] Processed batch 3.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2650, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1613, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1818, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2292, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 1 | Producer 305] Processing index 133
[GPU Rank 2 | Producer 295] Processing index 129
Batch processed:Batch processed:  33  for rank:for rank:  20

Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samples

Batch processed: 3 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 3 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 304] Processing index 32[GPU Rank 0 | Producer 298] Processing index 4[GPU Rank 2 | Producer 299] Processing index 65

[GPU Rank 1 | Producer 301] Processing index 63

[GPU Rank 0] Processed batch 4.
[GPU Rank 3] Processed batch 4.
[GPU Rank 2] Processed batch 4.
[GPU Rank 1] Processed batch 4.
loss_value in pytorch loss_value in pytorch loss_value in pytorchloss_value in pytorch  [GPU Rank 0 | Producer 302] Processing index 141
tensor(0.2766, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2934, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3022, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.1390, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 304] Processing index 161
[GPU Rank 1 | Producer 301] Processing index 143
[GPU Rank 2 | Producer 299] Processing index 60
[GPU Rank 0 | Producer 298] Processing index 74
Batch processed: Batch processed:4 for rank: 3
 Queue size for GPU 3: 20 samples4
 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: Batch processed:4  4for rank:  for rank:1 
0
Queue size for GPU 1: 20 samplesQueue size for GPU 0: 20 samples

[GPU Rank 3 | Producer 296] Processing index 144
[GPU Rank 1 | Producer 293] Processing index 158
[GPU Rank 0 | Producer 294] Processing index 166
[GPU Rank 2 | Producer 292] Processing index 125
[GPU Rank 2] Processed batch 5.
[GPU Rank 0] Processed batch 5.
[GPU Rank 3] Processed batch 5.
[GPU Rank 1] Processed batch 5.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2108, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1977, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2573, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2555, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 292] Processing index 106
[GPU Rank 3 | Producer 296] Processing index 35
[GPU Rank 1 | Producer 293] Processing index 92
[GPU Rank 0 | Producer 294] Processing index 55
Batch processed:Batch processed:  55  for rank:for rank:  02

Queue size for GPU 2: 20 samplesQueue size for GPU 0: 20 samples

Batch processed: 5 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 5 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 299] Processing index 30
[GPU Rank 0 | Producer 302] Processing index 110
[GPU Rank 3 | Producer 304] Processing index 17[GPU Rank 1 | Producer 301] Processing index 19

[GPU Rank 2] Processed batch 6.
[GPU Rank 0] Processed batch 6.
[GPU Rank 3] Processed batch 6.
[GPU Rank 1] Processed batch 6.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2432, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1047, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1844, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2370, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 301] Processing index 141
[GPU Rank 0 | Producer 302] Processing index 65
[GPU Rank 3 | Producer 304] Processing index 88
[GPU Rank 2 | Producer 299] Processing index 50
Batch processed:Batch processed:  6 6for rank: Batch processed: for rank:3  
Batch processed:60  
for rank:Queue size for GPU 3: 20 samples 
26
 Queue size for GPU 0: 20 samplesfor rank:
Queue size for GPU 2: 20 samples 1

Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 300] Processing index 3[GPU Rank 2 | Producer 295] Processing index 160
[GPU Rank 0 | Producer 294] Processing index 134[GPU Rank 1 | Producer 293] Processing index 157


[GPU Rank 3] Processed batch 7.
[GPU Rank 2] Processed batch 7.
[GPU Rank 0] Processed batch 7.
[GPU Rank 1] Processed batch 7.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2070, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2051, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1500, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.1680, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 294] Processing index 59
[GPU Rank 2 | Producer 295] Processing index 143
[GPU Rank 3 | Producer 300] Processing index 94
[GPU Rank 1 | Producer 293] Processing index 94
Batch processed:Batch processed:  77  for rank:for rank:  Batch processed:20

 7Queue size for GPU 2: 20 samples Queue size for GPU 0: 20 samples

for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 7 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 0 | Producer 302] Processing index 97[GPU Rank 3 | Producer 304] Processing index 158[GPU Rank 2 | Producer 299] Processing index 103


[GPU Rank 1 | Producer 301] Processing index 56
[GPU Rank 3] Processed batch 8.
[GPU Rank 1] Processed batch 8.
[GPU Rank 2] Processed batch 8.
[GPU Rank 0] Processed batch 8.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 299] Processing index 156
tensor(0.1274, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2966, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2481, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3046, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 101
[GPU Rank 1 | Producer 301] Processing index 167
[GPU Rank 3 | Producer 304] Processing index 99
Batch processed:Batch processed:  88 for rank:  3for rank:Batch processed:
 2
 Queue size for GPU 3: 20 samples8
 for rank:Queue size for GPU 2: 20 samples 
0
Batch processed:Queue size for GPU 0: 20 samples 
8 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 0 | Producer 294] Processing index 8[GPU Rank 2 | Producer 292] Processing index 152[GPU Rank 1 | Producer 293] Processing index 164
[GPU Rank 3 | Producer 291] Processing index 54


[GPU Rank 2] Processed batch 9.
[GPU Rank 3] Processed batch 9.
[GPU Rank 1] Processed batch 9.
[GPU Rank 0] Processed batch 9.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1868, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1716, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3011, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1635, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 294] Processing index 6
[GPU Rank 1 | Producer 293] Processing index 77
[GPU Rank 3 | Producer 291] Processing index 106
[GPU Rank 2 | Producer 292] Processing index 35
Batch processed:Batch processed:  99  for rank:for rank:  02

Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samples

Batch processed: 9 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 9 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 304] Processing index 74[GPU Rank 2 | Producer 299] Processing index 9
[GPU Rank 0 | Producer 302] Processing index 68
[GPU Rank 1 | Producer 301] Processing index 14

[GPU Rank 2] Processed batch 10.
[GPU Rank 0] Processed batch 10.
[GPU Rank 3] Processed batch 10.
[GPU Rank 1] Processed batch 10.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3069, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.0737, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2883, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2214, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 114
[GPU Rank 3 | Producer 304] Processing index 23
[GPU Rank 2 | Producer 299] Processing index 26
[GPU Rank 1 | Producer 301] Processing index 145
Batch processed:Batch processed:  1010  for rank: 2
for rank: Queue size for GPU 2: 20 samplesBatch processed:0

 10 for rank:Queue size for GPU 0: 20 samples 
1
Queue size for GPU 1: 20 samples
Batch processed: 10 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 0 | Producer 306] Processing index 14[GPU Rank 1 | Producer 293] Processing index 150
[GPU Rank 3 | Producer 296] Processing index 124

[GPU Rank 2 | Producer 295] Processing index 114
[GPU Rank 1] Processed batch 11.
[GPU Rank 3] Processed batch 11.
[GPU Rank 2] Processed batch 11.
[GPU Rank 0] Processed batch 11.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2069, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2685, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2671, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1489, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 47
[GPU Rank 2 | Producer 295] Processing index 41
[GPU Rank 1 | Producer 293] Processing index 128
[GPU Rank 0 | Producer 306] Processing index 80
Batch processed: 11 Batch processed:for rank: 2 
11Batch processed: for rank:  Queue size for GPU 2: 20 samples3

11 for rank: 1Queue size for GPU 3: 20 samples

Queue size for GPU 1: 20 samples
Batch processed: 11 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 299] Processing index 104[GPU Rank 1 | Producer 301] Processing index 35
[GPU Rank 3 | Producer 304] Processing index 131
[GPU Rank 0 | Producer 302] Processing index 86

[GPU Rank 2] Processed batch 12.
[GPU Rank 3] Processed batch 12.
[GPU Rank 1] Processed batch 12.
[GPU Rank 0] Processed batch 12.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 145
tensor(0.1247, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3864, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2673, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1432, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 299] Processing index 83
[GPU Rank 1 | Producer 301] Processing index 115
[GPU Rank 3 | Producer 304] Processing index 52
Batch processed: 12 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 12 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 12 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: [GPU Rank 3 | Producer 296] Processing index 13712 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 295] Processing index 63
[GPU Rank 1 | Producer 305] Processing index 110
[GPU Rank 0 | Producer 306] Processing index 38

[GPU Rank 3] Processed batch 13.
[GPU Rank 1] Processed batch 13.
[GPU Rank 2] Processed batch 13.
[GPU Rank 0] Processed batch 13.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1301, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2569, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2614, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2576, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 146
[GPU Rank 2 | Producer 295] Processing index 107
Batch processed:Batch processed:  1313  for rank:for rank:  31

Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

Batch processed: 13 for rank: 2
Batch processed: 13 for rank:Queue size for GPU 2: 20 samples 
0
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 304] Processing index 32[GPU Rank 1 | Producer 293] Processing index 122
[GPU Rank 0 | Producer 302] Processing index 57[GPU Rank 2 | Producer 299] Processing index 65


[GPU Rank 3] Processed batch 14.
[GPU Rank 2] Processed batch 14.
[GPU Rank 1] Processed batch 14.
[GPU Rank 0] Processed batch 14.
loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 306] Processing index 0
loss_value in pytorch tensor(0.1710, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1679, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1179, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2833, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 82
[GPU Rank 1 | Producer 293] Processing index 120
[GPU Rank 3 | Producer 304] Processing index 161
[GPU Rank 2 | Producer 299] Processing index 60
Batch processed: 14 for rank: 2
Batch processed:Queue size for GPU 2: 20 samples 
14 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 14 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 14 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 300] Processing index 86[GPU Rank 1 | Producer 305] Processing index 78
[GPU Rank 2 | Producer 303] Processing index 108

[GPU Rank 0 | Producer 306] Processing index 102
[GPU Rank 3] Processed batch 15.
[GPU Rank 2] Processed batch 15.
[GPU Rank 0] Processed batch 15.
[GPU Rank 1] Processed batch 15.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 141
tensor(0.1003, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1138, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1934, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2078, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 0
[GPU Rank 0 | Producer 306] Processing index 152
[GPU Rank 1 | Producer 305] Processing index 112
[GPU Rank 2 | Producer 303] Processing index 137
Batch processed: 15Batch processed: for rank:Batch processed:  2 
1515 for rank:  for rank:Queue size for GPU 2: 20 samples3 

0
Queue size for GPU 3: 20 samples
Queue size for GPU 0: 20 samples
Batch processed: 15 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 299] Processing index 30[GPU Rank 0 | Producer 298] Processing index 111[GPU Rank 3 | Producer 304] Processing index 17


[GPU Rank 1 | Producer 293] Processing index 158
[GPU Rank 2] Processed batch 16.
[GPU Rank 0] Processed batch 16.
[GPU Rank 1] Processed batch 16.
[GPU Rank 3] Processed batch 16.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2825, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2349, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1587, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3171, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 304] Processing index 88
[GPU Rank 1 | Producer 293] Processing index 92
[GPU Rank 0 | Producer 298] Processing index 62
[GPU Rank 2 | Producer 299] Processing index 50
Batch processed: 16 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 16 for rank: 2
Batch processed: Queue size for GPU 2: 20 samples
16 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 300] Processing index 19
[GPU Rank 0 | Producer 306] Processing index 45[GPU Rank 2 | Producer 295] Processing index 22

Batch processed:[GPU Rank 3] Processed batch 17. 
16 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 1 | Producer 305] Processing index 162
[GPU Rank 2] Processed batch 17.
[GPU Rank 0] Processed batch 17.
[GPU Rank 1] Processed batch 17.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3008, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1112, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2373, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1373, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 26
[GPU Rank 3 | Producer 300] Processing index 51
[GPU Rank 0 | Producer 306] Processing index 63
[GPU Rank 2 | Producer 295] Processing index 164
Batch processed:Batch processed:  1717  for rank:for rank:  2Batch processed:
 17 for rank:Queue size for GPU 2: 20 samples 
03

Queue size for GPU 3: 20 samples
Batch processed: 17 for rank: 1Queue size for GPU 0: 20 samples

Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 303] Processing index 87[GPU Rank 3 | Producer 304] Processing index 158[GPU Rank 0 | Producer 294] Processing index 43[GPU Rank 1 | Producer 297] Processing index 136



[GPU Rank 2] Processed batch 18.
[GPU Rank 3] Processed batch 18.
[GPU Rank 0] Processed batch 18.
[GPU Rank 1] Processed batch 18.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2871, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2791, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3004, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2222, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 303] Processing index 136
[GPU Rank 1 | Producer 297] Processing index 16
[GPU Rank 3 | Producer 304] Processing index 99
Batch processed:Batch processed:  1818  for rank:for rank:  31

Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

Batch processed: 18 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 18 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 300] Processing index 16[GPU Rank 1 | Producer 305] Processing index 8[GPU Rank 0 | Producer 298] Processing index 165
[GPU Rank 2 | Producer 292] Processing index 138


[GPU Rank 2] Processed batch 19.
[GPU Rank 3] Processed batch 19.
[GPU Rank 0] Processed batch 19.
[GPU Rank 1] Processed batch 19.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 294] Processing index 75
tensor(0.2681, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2476, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1906, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1879, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 64
[GPU Rank 3 | Producer 300] Processing index 43
[GPU Rank 0 | Producer 298] Processing index 28
[GPU Rank 2 | Producer 292] Processing index 99
Batch processed:Batch processed:Batch processed:Batch processed:   19 191919    for rank:for rank:for rank:for rank:    3102



Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samplesQueue size for GPU 1: 20 samplesQueue size for GPU 3: 20 samples



[GPU Rank 1 | Producer 297] Processing index 0[GPU Rank 2 | Producer 303] Processing index 113
[GPU Rank 0 | Producer 294] Processing index 106[GPU Rank 3 | Producer 296] Processing index 60


[GPU Rank 2] Processed batch 20.
[GPU Rank 0] Processed batch 20.
[GPU Rank 1] Processed batch 20.
[GPU Rank 3] Processed batch 20.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2212, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2230, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2189, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2567, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 303] Processing index 74
[GPU Rank 1 | Producer 297] Processing index 125
[GPU Rank 3 | Producer 296] Processing index 126
[GPU Rank 0 | Producer 294] Processing index 72
Batch processed: Batch processed:Batch processed:20 for rank:   Batch processed:22020
   for rank:for rank:20   Queue size for GPU 2: 20 samples3for rank:1

 
0
Queue size for GPU 1: 20 samplesQueue size for GPU 3: 20 samplesQueue size for GPU 0: 20 samples


[GPU Rank 3 | Producer 291] Processing index 146[GPU Rank 0 | Producer 306] Processing index 46[GPU Rank 1 | Producer 305] Processing index 55
[GPU Rank 2 | Producer 295] Processing index 141


[GPU Rank 3] Processed batch 21.
[GPU Rank 2] Processed batch 21.
[GPU Rank 1] Processed batch 21.
[GPU Rank 0] Processed batch 21.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3486, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1539, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2737, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2274, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 133
[GPU Rank 2 | Producer 295] Processing index 129
[GPU Rank 3 | Producer 291] Processing index 46
Batch processed:Batch processed:  2121  for rank:for rank:  31

RAISE StopIterationRAISE StopIteration

Batch processed: 21 for rank: 0
RAISE StopIteration
Batch processed: 21 for rank: 2
RAISE StopIteration
Batch processed: 0 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 0 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 296] Processing index 87
Batch processed: 0 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 1 | Producer 293] Processing index 157:::MLLOG {"namespace": "", "time_ms": 1743705530755, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 106, "epoch_num": 21, "current_lr": 0.8}}
[GPU Rank 2 | Producer 303] Processing index 20
:::MLLOG {"namespace": "", "time_ms": 1743705530756, "event_type": "INTERVAL_END", "key": "block_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 135, "first_epoch_num": 21, "epoch_count": 1}}

:::MLLOG {"namespace": "", "time_ms": 1743705530756, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 66, "first_epoch_num": 22, "epoch_count": 1}}
:::MLLOG {"namespace": "", "time_ms": 1743705530757, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 68, "epoch_num": 22}}
[GPU Rank 1] Processed batch 1.
[GPU Rank 2] Processed batch 1.
Batch processed: 0 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3] Processed batch 1.
[GPU Rank 0 | Producer 302] Processing index 110
[GPU Rank 0] Processed batch 1.
loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 306] Processing index 121
loss_value in pytorch tensor(0.2208, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2449, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2803, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.3117, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 65
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 1 | Producer 293] Processing index 94
Batch processed:Batch processed:  11  Batch processed:for rank:for rank:  31 

1 for rank:Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples 

2
Queue size for GPU 2: 20 samples
Batch processed: 1 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 300] Processing index 8
[GPU Rank 1 | Producer 297] Processing index 152
[GPU Rank 0 | Producer 298] Processing index 151[GPU Rank 2 | Producer 295] Processing index 160

[GPU Rank 1] Processed batch 2.
[GPU Rank 3] Processed batch 2.
[GPU Rank 0] Processed batch 2.
[GPU Rank 2] Processed batch 2.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 303] Processing index 49
tensor(0.1603, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1631, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1044, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2240, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 298] Processing index 76
[GPU Rank 2 | Producer 295] Processing index 143
[GPU Rank 3 | Producer 300] Processing index 29
[GPU Rank 1 | Producer 297] Processing index 46
Batch processed:Batch processed: Batch processed: Batch processed:22    for rank:2for rank:2    3for rank:1for rank: 

 02

Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

Queue size for GPU 2: 20 samplesQueue size for GPU 0: 20 samples

[GPU Rank 0 | Producer 302] Processing index 97
[GPU Rank 3 | Producer 296] Processing index 144[GPU Rank 2 | Producer 299] Processing index 103[GPU Rank 1 | Producer 301] Processing index 63


[GPU Rank 0] Processed batch 3.
[GPU Rank 3] Processed batch 3.
[GPU Rank 2] Processed batch 3.
[GPU Rank 1] Processed batch 3.
loss_value in pytorchloss_value in pytorch  loss_value in pytorch loss_value in pytorch tensor(0.3054, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3216, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1850, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1908, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 299] Processing index 156
[GPU Rank 0 | Producer 302] Processing index 101
[GPU Rank 1 | Producer 301] Processing index 143
[GPU Rank 3 | Producer 296] Processing index 35
Batch processed:Batch processed:  3 for rank: 32 
Batch processed:for rank: 1 Queue size for GPU 2: 20 samples
3
 for rank: 0
Queue size for GPU 1: 20 samples
Queue size for GPU 0: 20 samples
Batch processed: 3 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 1 | Producer 297] Processing index 140[GPU Rank 2 | Producer 303] Processing index 38

[GPU Rank 3 | Producer 300] Processing index 3
[GPU Rank 0 | Producer 298] Processing index 93
[GPU Rank 2] Processed batch 4.
[GPU Rank 1] Processed batch 4.
[GPU Rank 3] Processed batch 4.
[GPU Rank 0] Processed batch 4.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1735, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1250, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2070, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.0778, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 297] Processing index 42
[GPU Rank 3 | Producer 300] Processing index 94
[GPU Rank 0 | Producer 298] Processing index 17
Batch processed:Batch processed:  44  for rank:for rank:  02

Queue size for GPU 2: 20 samplesQueue size for GPU 0: 20 samples

Batch processed: 4 for rank: 3
Batch processed: Queue size for GPU 3: 20 samples4
 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 299] Processing index 9[GPU Rank 0 | Producer 302] Processing index 68[GPU Rank 3 | Producer 304] Processing index 74[GPU Rank 1 | Producer 293] Processing index 164



[GPU Rank 1] Processed batch 5.
[GPU Rank 0] Processed batch 5.
[GPU Rank 2] Processed batch 5.
[GPU Rank 3] Processed batch 5.
loss_value in pytorch loss_value in pytorchloss_value in pytorch  loss_value in pytorch [GPU Rank 2 | Producer 303] Processing index 145
tensor(0.2121, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1500, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1945, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2950, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 114
[GPU Rank 1 | Producer 293] Processing index 77
[GPU Rank 3 | Producer 304] Processing index 23
[GPU Rank 2 | Producer 299] Processing index 26
Batch processed: 5 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed:Batch processed:  55  for rank:for rank:  20

Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samples

Batch processed: 5 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 0 | Producer 298] Processing index 4[GPU Rank 1 | Producer 305] Processing index 110
[GPU Rank 3 | Producer 300] Processing index 86[GPU Rank 2 | Producer 295] Processing index 114


[GPU Rank 3] Processed batch 6.
[GPU Rank 0] Processed batch 6.
[GPU Rank 1] Processed batch 6.
[GPU Rank 2] Processed batch 6.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 3 | Producer 300] Processing index 0
tensor(0.1122, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1761, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2055, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.1264, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 146
[GPU Rank 2 | Producer 295] Processing index 41
[GPU Rank 0 | Producer 298] Processing index 74
Batch processed: Batch processed:Batch processed:6  6 for rank:  6for rank:2  
for rank:3 1

Queue size for GPU 2: 20 samples
Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

Batch processed: 6 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 299] Processing index 104[GPU Rank 3 | Producer 296] Processing index 124[GPU Rank 0 | Producer 302] Processing index 86

[GPU Rank 1 | Producer 293] Processing index 150

[GPU Rank 1] Processed batch 7.
[GPU Rank 2] Processed batch 7.
[GPU Rank 3] Processed batch 7.
[GPU Rank 0] Processed batch 7.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2016, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2936, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3568, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2098, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 145
[GPU Rank 3 | Producer 296] Processing index 47
[GPU Rank 2 | Producer 299] Processing index 83
[GPU Rank 1 | Producer 293] Processing index 128
Batch processed:Batch processed:Batch processed:   777   for rank:for rank:for rank:   123


Queue size for GPU 1: 20 samplesQueue size for GPU 2: 20 samplesQueue size for GPU 3: 20 samples


Batch processed: 7 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 295] Processing index 63
[GPU Rank 3 | Producer 291] Processing index 11
[GPU Rank 1 | Producer 305] Processing index 78[GPU Rank 0 | Producer 306] Processing index 14

[GPU Rank 2] Processed batch 8.
[GPU Rank 1] Processed batch 8.
[GPU Rank 3] Processed batch 8.
[GPU Rank 0] Processed batch 8.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2191, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2908, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2030, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1590, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 112
[GPU Rank 2 | Producer 295] Processing index 107
[GPU Rank 3 | Producer 291] Processing index 136
[GPU Rank 0 | Producer 306] Processing index 80
Batch processed:Batch processed: Batch processed:8  8 for rank:  83for rank:  
for rank:2 
1
Queue size for GPU 3: 20 samples
Queue size for GPU 2: 20 samples
Queue size for GPU 1: 20 samples
Batch processed: 8 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 299] Processing index 65
[GPU Rank 3 | Producer 296] Processing index 137[GPU Rank 1 | Producer 301] Processing index 19

[GPU Rank 0 | Producer 302] Processing index 57
[GPU Rank 3] Processed batch 9.
[GPU Rank 2] Processed batch 9.
[GPU Rank 1] Processed batch 9.
[GPU Rank 0] Processed batch 9.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2938, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2375, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2449, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1649, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 301] Processing index 141
[GPU Rank 2 | Producer 299] Processing index 60
Batch processed:Batch processed:  99  for rank:for rank:  3Batch processed:1

 9Queue size for GPU 3: 20 samples Queue size for GPU 1: 20 samples
for rank:
 2
Batch processed: Queue size for GPU 2: 20 samples9
 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 291] Processing index 90[GPU Rank 2 | Producer 292] Processing index 72
[GPU Rank 1 | Producer 293] Processing index 122
[GPU Rank 0 | Producer 298] Processing index 111

[GPU Rank 3] Processed batch 10.
[GPU Rank 0] Processed batch 10.
[GPU Rank 2] Processed batch 10.
[GPU Rank 1] Processed batch 10.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 141
tensor(0.3156, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1694, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3896, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2269, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 82
[GPU Rank 3 | Producer 291] Processing index 153
[GPU Rank 1 | Producer 293] Processing index 120
[GPU Rank 0 | Producer 298] Processing index 62
[GPU Rank 2 | Producer 292] Processing index 43
Batch processed:Batch processed:  1010  for rank:for rank:  31

Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

Batch processed: 10 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 10 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 304] Processing index 131
[GPU Rank 1 | Producer 301] Processing index 56[GPU Rank 2 | Producer 299] Processing index 30
[GPU Rank 0 | Producer 294] Processing index 166

[GPU Rank 0] Processed batch 11.
[GPU Rank 2] Processed batch 11.
[GPU Rank 1] Processed batch 11.
[GPU Rank 3] Processed batch 11.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1731, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1985, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3560, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1542, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 301] Processing index 167
[GPU Rank 2 | Producer 299] Processing index 50
[GPU Rank 0 | Producer 294] Processing index 55
Batch processed:Batch processed:Batch processed: 11 for rank:   2
1111  for rank:for rank:Queue size for GPU 2: 20 samples  
13

Queue size for GPU 1: 20 samplesQueue size for GPU 3: 20 samples

Batch processed: 11 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 295] Processing index 22
[GPU Rank 3 | Producer 291] Processing index 65[GPU Rank 0 | Producer 306] Processing index 38[GPU Rank 1 | Producer 293] Processing index 158
[GPU Rank 3 | Producer 304] Processing index 52


[GPU Rank 3] Processed batch 12.
[GPU Rank 1] Processed batch 12.
[GPU Rank 0] Processed batch 12.
[GPU Rank 2] Processed batch 12.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1418, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1664, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2571, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2532, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 291] Processing index 154
[GPU Rank 2 | Producer 295] Processing index 164
[GPU Rank 1 | Producer 293] Processing index 92
Batch processed:Batch processed:Batch processed:Batch processed:    1212  for rank:for rank: 12 122 0 
for rank:
for rank:Queue size for GPU 2: 20 samples 
Queue size for GPU 0: 20 samples 13


Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

[GPU Rank 3 | Producer 300] Processing index 19[GPU Rank 0 | Producer 298] Processing index 165[GPU Rank 2 | Producer 292] Processing index 69
[GPU Rank 1 | Producer 301] Processing index 14


[GPU Rank 2] Processed batch 13.
[GPU Rank 0] Processed batch 13.
[GPU Rank 1] Processed batch 13.
[GPU Rank 3] Processed batch 13.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 306] Processing index 0
tensor(0.2215, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.5309, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2002, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2436, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 51
[GPU Rank 2 | Producer 292] Processing index 31
[GPU Rank 0 | Producer 298] Processing index 28
[GPU Rank 1 | Producer 301] Processing index 145
Batch processed:Batch processed:  13Batch processed:13Batch processed:  for rank: for rank:   133131 
 
for rank:for rank:  20
Queue size for GPU 3: 20 samples
Queue size for GPU 1: 20 samples

Queue size for GPU 2: 20 samplesQueue size for GPU 0: 20 samples

[GPU Rank 0 | Producer 306] Processing index 102
[GPU Rank 3 | Producer 296] Processing index 60[GPU Rank 2 | Producer 303] Processing index 108

[GPU Rank 1 | Producer 293] Processing index 157
[GPU Rank 3] Processed batch 14.
[GPU Rank 1] Processed batch 14.
[GPU Rank 0] Processed batch 14.
[GPU Rank 2] Processed batch 14.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1268, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2701, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2343, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2860, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 306] Processing index 152
[GPU Rank 3 | Producer 296] Processing index 126
[GPU Rank 1 | Producer 293] Processing index 94
[GPU Rank 2 | Producer 303] Processing index 137
Batch processed:Batch processed:  1414Batch processed:  for rank:for rank:   3114

 for rank: 2Queue size for GPU 1: 20 samplesQueue size for GPU 3: 20 samples


Queue size for GPU 2: 20 samplesBatch processed:
 14 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 1 | Producer 297] Processing index 23
[GPU Rank 3 | Producer 304] Processing index 32
[GPU Rank 2 | Producer 292] Processing index 125
[GPU Rank 0 | Producer 294] Processing index 134
[GPU Rank 1] Processed batch 15.
[GPU Rank 2] Processed batch 15.
[GPU Rank 0] Processed batch 15.
[GPU Rank 3] Processed batch 15.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2811, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2118, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3381, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1832, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 292] Processing index 106
[GPU Rank 0 | Producer 294] Processing index 59
[GPU Rank 3 | Producer 304] Processing index 161
[GPU Rank 1 | Producer 297] Processing index 127
Batch processed:Batch processed:Batch processed:Batch processed:  1515    for rank:for rank:  151520  

for rank:for rank:  31
Queue size for GPU 0: 20 samples
Queue size for GPU 2: 20 samples

Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

[GPU Rank 1 | Producer 293] Processing index 164[GPU Rank 2 | Producer 295] Processing index 141

[GPU Rank 0 | Producer 306] Processing index 45[GPU Rank 3 | Producer 296] Processing index 87

[GPU Rank 3] Processed batch 16.
[GPU Rank 1] Processed batch 16.
[GPU Rank 0] Processed batch 16.
[GPU Rank 2] Processed batch 16.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3839, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1811, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2645, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1921, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 0 | Producer 306] Processing index 63
[GPU Rank 1 | Producer 293] Processing index 77
[GPU Rank 2 | Producer 295] Processing index 129
Batch processed:Batch processed:  1616  for rank:for rank:  13

Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

Batch processed: Batch processed:16  for rank:16  0for rank:
 2
Queue size for GPU 0: 20 samples
Queue size for GPU 2: 20 samples
[GPU Rank 1 | Producer 297] Processing index 136[GPU Rank 3 | Producer 304] Processing index 17[GPU Rank 2 | Producer 303] Processing index 87[GPU Rank 0 | Producer 294] Processing index 8



[GPU Rank 1] Processed batch 17.
[GPU Rank 2] Processed batch 17.
[GPU Rank 0] Processed batch 17.
[GPU Rank 3] Processed batch 17.
loss_value in pytorchloss_value in pytorch  loss_value in pytorch loss_value in pytorch tensor(0.1106, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1783, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2384, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2393, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 303] Processing index 136
[GPU Rank 0 | Producer 294] Processing index 6
[GPU Rank 3 | Producer 304] Processing index 88
[GPU Rank 1 | Producer 297] Processing index 16
Batch processed: 17 for rank: 1
Batch processed: Queue size for GPU 1: 20 samples
17 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 17 for rank: 3
Queue size for GPU 3: 20 samplesBatch processed:
 17 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 295] Processing index 160[GPU Rank 1 | Producer 293] Processing index 150[GPU Rank 3 | Producer 296] Processing index 144
[GPU Rank 0 | Producer 306] Processing index 46


[GPU Rank 2] Processed batch 18.
[GPU Rank 1] Processed batch 18.
[GPU Rank 3] Processed batch 18.
[GPU Rank 0] Processed batch 18.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1690, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1520, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2057, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3094, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 295] Processing index 143
[GPU Rank 3 | Producer 296] Processing index 35
[GPU Rank 1 | Producer 293] Processing index 128
[GPU Rank 0 | Producer 306] Processing index 121
Batch processed: Batch processed:18  for rank:18  1for rank:
 2
Queue size for GPU 1: 20 samples
Queue size for GPU 2: 20 samples
Batch processed: 18 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 18 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 303] Processing index 113[GPU Rank 1 | Producer 297] Processing index 0[GPU Rank 0 | Producer 294] Processing index 43


[GPU Rank 3] Processed batch 19.
[GPU Rank 2] Processed batch 19.
[GPU Rank 1] Processed batch 19.
[GPU Rank 0] Processed batch 19.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 3 | Producer 296] Processing index 124
tensor(0.1779, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1494, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1183, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1899, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 303] Processing index 74
[GPU Rank 1 | Producer 297] Processing index 125
[GPU Rank 3 | Producer 296] Processing index 47
[GPU Rank 0 | Producer 294] Processing index 75
Batch processed: 19 for rank:Batch processed:Batch processed: 2
  19Queue size for GPU 2: 20 samples19 
 for rank: for rank:3
 1
Queue size for GPU 3: 20 samples
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 295] Processing index 114Batch processed: 19 for rank: 0
[GPU Rank 3 | Producer 291] Processing index 54[GPU Rank 1 | Producer 297] Processing index 152Queue size for GPU 0: 20 samples



[GPU Rank 0 | Producer 306] Processing index 14
[GPU Rank 1] Processed batch 20.
[GPU Rank 2] Processed batch 20.
[GPU Rank 3] Processed batch 20.
[GPU Rank 0] Processed batch 20.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1370, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1290, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2167, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2186, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 295] Processing index 41
[GPU Rank 1 | Producer 297] Processing index 46
[GPU Rank 3 | Producer 291] Processing index 106
[GPU Rank 0 | Producer 306] Processing index 80
Batch processed: 20 Batch processed:for rank: 2 
20 for rank: Queue size for GPU 2: 20 samples3

Batch processed: 20Queue size for GPU 3: 20 samples 
for rank:Batch processed: 0 
Queue size for GPU 0: 20 samples20
 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 292] Processing index 152[GPU Rank 3 | Producer 296] Processing index 137[GPU Rank 0 | Producer 302] Processing index 110


[GPU Rank 1 | Producer 293] Processing index 122
[GPU Rank 2] Processed batch 21.
[GPU Rank 3] Processed batch 21.
[GPU Rank 0] Processed batch 21.
[GPU Rank 1] Processed batch 21.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2314, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1998, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1933, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2404, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 293] Processing index 120
[GPU Rank 0 | Producer 302] Processing index 65
[GPU Rank 2 | Producer 292] Processing index 35
Batch processed: 21 for rank: 2
RAISE StopIteration
Batch processed: 21 for rank: 3
RAISE StopIteration
Batch processed: 21 for rank: 0
RAISE StopIteration
Batch processed: 21 for rank: 1
RAISE StopIteration
Batch processed: 0 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 2 | Producer 295] Processing index 63Batch processed: 0 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 3 | Producer 291] Processing index 146

Batch processed: 0 for rank: 1
Queue size for GPU 1: 20 samples
:::MLLOG {"namespace": "", "time_ms": 1743705547322, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 106, "epoch_num": 22, "current_lr": 0.8}}
[GPU Rank 1 | Producer 297] Processing index 140
:::MLLOG {"namespace": "", "time_ms": 1743705547323, "event_type": "INTERVAL_END", "key": "block_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 135, "first_epoch_num": 22, "epoch_count": 1}}
[GPU Rank 3] Processed batch 1.
:::MLLOG {"namespace": "", "time_ms": 1743705547324, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 66, "first_epoch_num": 23, "epoch_count": 1}}
:::MLLOG {"namespace": "", "time_ms": 1743705547324, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 68, "epoch_num": 23}}
[GPU Rank 2] Processed batch 1.
Batch processed: 0 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 0 | Producer 306] Processing index 38[GPU Rank 1] Processed batch 1.

[GPU Rank 0] Processed batch 1.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2447, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1875, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2177, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1966, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 82
[GPU Rank 1 | Producer 297] Processing index 42
[GPU Rank 2 | Producer 295] Processing index 107
[GPU Rank 3 | Producer 291] Processing index 46
Batch processed:Batch processed:Batch processed:   1Batch processed:11   1 for rank:for rank: for rank:  for rank: 132 

0

Queue size for GPU 2: 20 samplesQueue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples
Queue size for GPU 0: 20 samples


[GPU Rank 0 | Producer 302] Processing index 97[GPU Rank 2 | Producer 303] Processing index 20[GPU Rank 1 | Producer 293] Processing index 158


[GPU Rank 2] Processed batch 2.
[GPU Rank 3] Processed batch 2.
[GPU Rank 1] Processed batch 2.
[GPU Rank 0] Processed batch 2.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 3 | Producer 296] Processing index 60
[GPU Rank 0 | Producer 306] Processing index 0
tensor(0.2218, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2763, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2753, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2826, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 101
[GPU Rank 3 | Producer 296] Processing index 126
[GPU Rank 1 | Producer 293] Processing index 92
Batch processed:Batch processed:Batch processed:  22   2for rank:for rank:   for rank:Batch processed:31 
2
 
2 for rank:Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples 

Queue size for GPU 2: 20 samples0

Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 300] Processing index 16[GPU Rank 2 | Producer 295] Processing index 22

[GPU Rank 1 | Producer 301] Processing index 35[GPU Rank 0 | Producer 306] Processing index 102

[GPU Rank 2] Processed batch 3.
[GPU Rank 0] Processed batch 3.
[GPU Rank 1] Processed batch 3.
[GPU Rank 3] Processed batch 3.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 303] Processing index 49
tensor(0.1928, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2633, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1415, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1930, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 306] Processing index 152
[GPU Rank 3 | Producer 300] Processing index 43
[GPU Rank 1 | Producer 301] Processing index 115
[GPU Rank 2 | Producer 295] Processing index 164
Batch processed:Batch processed:  33  for rank:for rank:  13

Queue size for GPU 1: 20 samplesQueue size for GPU 3: 20 samples

Batch processed:Batch processed:  33  for rank:for rank:  02

Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samples

[GPU Rank 3 | Producer 296] Processing index 87[GPU Rank 1 | Producer 305] Processing index 162[GPU Rank 0 | Producer 302] Processing index 68


[GPU Rank 2 | Producer 299] Processing index 103
[GPU Rank 1] Processed batch 4.
[GPU Rank 3] Processed batch 4.
[GPU Rank 0] Processed batch 4.
[GPU Rank 2] Processed batch 4.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1408, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1948, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1995, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2319, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 299] Processing index 156
[GPU Rank 0 | Producer 302] Processing index 114
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 1 | Producer 305] Processing index 26
Batch processed:Batch processed:  4 4for rank:  for rank:3 1

Queue size for GPU 1: 20 samplesBatch processed:Queue size for GPU 3: 20 samplesBatch processed:

  44  for rank:for rank:  20

Queue size for GPU 2: 20 samplesQueue size for GPU 0: 20 samples

[GPU Rank 3 | Producer 304] Processing index 158[GPU Rank 1 | Producer 301] Processing index 63[GPU Rank 2 | Producer 303] Processing index 38[GPU Rank 0 | Producer 306] Processing index 45



[GPU Rank 1] Processed batch 5.
[GPU Rank 3] Processed batch 5.
[GPU Rank 2] Processed batch 5.[GPU Rank 0] Processed batch 5.

loss_value in pytorchloss_value in pytorch  loss_value in pytorch loss_value in pytorch tensor(0.1996, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1838, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2605, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1843, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 306] Processing index 63
[GPU Rank 1 | Producer 301] Processing index 143
[GPU Rank 3 | Producer 304] Processing index 99
Batch processed:Batch processed:  55  for rank:for rank:  31

Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

Batch processed: 5 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 5 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 296] Processing index 144[GPU Rank 1 | Producer 293] Processing index 157[GPU Rank 2 | Producer 299] Processing index 9


[GPU Rank 0 | Producer 302] Processing index 86
[GPU Rank 3] Processed batch 6.
[GPU Rank 2] Processed batch 6.
[GPU Rank 1] Processed batch 6.
[GPU Rank 0] Processed batch 6.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 303] Processing index 145
[GPU Rank 0 | Producer 302] Processing index 145
tensor(0.1747, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1241, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2472, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2002, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 35
[GPU Rank 2 | Producer 299] Processing index 26
[GPU Rank 1 | Producer 293] Processing index 94
Batch processed:Batch processed:  66  for rank:for rank:  31

Batch processed:Batch processed:Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

  66  for rank:for rank:  20

Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samples

[GPU Rank 1 | Producer 301] Processing index 19[GPU Rank 3 | Producer 291] Processing index 11[GPU Rank 2 | Producer 295] Processing index 141

[GPU Rank 0 | Producer 306] Processing index 46

[GPU Rank 1] Processed batch 7.
[GPU Rank 0] Processed batch 7.
[GPU Rank 2] Processed batch 7.
[GPU Rank 3] Processed batch 7.
loss_value in pytorch loss_value in pytorch loss_value in pytorchloss_value in pytorch  tensor(0.2512, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2074, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2788, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2522, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 301] Processing index 141
[GPU Rank 3 | Producer 291] Processing index 136
[GPU Rank 2 | Producer 295] Processing index 129
[GPU Rank 0 | Producer 306] Processing index 121
Batch processed:Batch processed:  77  for rank:for rank:  31

Batch processed:Queue size for GPU 1: 20 samplesQueue size for GPU 3: 20 samples

 7 for rank: Batch processed:2
 7 for rank:Queue size for GPU 2: 20 samples 
0
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 296] Processing index 124[GPU Rank 1 | Producer 305] Processing index 8

[GPU Rank 2 | Producer 292] Processing index 138
[GPU Rank 0 | Producer 298] Processing index 151
[GPU Rank 2] Processed batch 8.
[GPU Rank 0] Processed batch 8.
[GPU Rank 3] Processed batch 8.
[GPU Rank 1] Processed batch 8.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2829, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1848, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1570, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2464, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 47
[GPU Rank 1 | Producer 305] Processing index 64
[GPU Rank 0 | Producer 298] Processing index 76
[GPU Rank 2 | Producer 292] Processing index 99
Batch processed:Batch processed:  Batch processed:Batch processed:88    for rank:88for rank:    3for rank:for rank:1  

20

Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

Queue size for GPU 2: 20 samplesQueue size for GPU 0: 20 samples

[GPU Rank 3 | Producer 291] Processing index 90
[GPU Rank 2 | Producer 295] Processing index 160
[GPU Rank 1 | Producer 301] Processing index 56[GPU Rank 0 | Producer 306] Processing index 14

[GPU Rank 0] Processed batch 9.
[GPU Rank 2] Processed batch 9.
[GPU Rank 1] Processed batch 9.
[GPU Rank 3] Processed batch 9.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 3 | Producer 291] Processing index 153
tensor(0.1935, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2095, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2799, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1680, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 295] Processing index 143
[GPU Rank 1 | Producer 301] Processing index 167
[GPU Rank 0 | Producer 306] Processing index 80
Batch processed:Batch processed:  99  for rank:for rank:  Batch processed:Batch processed:31

  99  Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samplesfor rank:
for rank:
  20

Queue size for GPU 2: 20 samplesQueue size for GPU 0: 20 samples

[GPU Rank 1 | Producer 305] Processing index 55
[GPU Rank 0 | Producer 294] Processing index 106[GPU Rank 2 | Producer 299] Processing index 104
[GPU Rank 3 | Producer 296] Processing index 137

[GPU Rank 1] Processed batch 10.
[GPU Rank 3] Processed batch 10.
[GPU Rank 2] Processed batch 10.
[GPU Rank 0] Processed batch 10.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1936, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2124, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1912, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2712, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 133
[GPU Rank 2 | Producer 299] Processing index 83
[GPU Rank 0 | Producer 294] Processing index 72
Batch processed: 10 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 10 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 10 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 10 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 2 | Producer 295] Processing index 114
[GPU Rank 1 | Producer 301] Processing index 14[GPU Rank 0 | Producer 306] Processing index 38[GPU Rank 3 | Producer 300] Processing index 8


[GPU Rank 1] Processed batch 11.
[GPU Rank 2] Processed batch 11.
[GPU Rank 3] Processed batch 11.
[GPU Rank 0] Processed batch 11.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2715, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2750, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2229, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.1116, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 82
[GPU Rank 2 | Producer 295] Processing index 41
[GPU Rank 3 | Producer 300] Processing index 29
[GPU Rank 1 | Producer 301] Processing index 145
Batch processed:Batch processed:  1111  for rank:for rank:  20

Queue size for GPU 2: 20 samplesQueue size for GPU 0: 20 samples

Batch processed:Batch processed:  1111  for rank:for rank:  31

Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

[GPU Rank 2 | Producer 299] Processing index 65[GPU Rank 3 | Producer 291] Processing index 65

[GPU Rank 0 | Producer 298] Processing index 93
[GPU Rank 1 | Producer 293] Processing index 164
[GPU Rank 2] Processed batch 12.
[GPU Rank 3] Processed batch 12.
[GPU Rank 1] Processed batch 12.
[GPU Rank 0] Processed batch 12.
loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 306] Processing index 0
loss_value in pytorch tensor(0.2779, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1578, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2165, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.4449, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 293] Processing index 77
[GPU Rank 3 | Producer 291] Processing index 154
[GPU Rank 2 | Producer 299] Processing index 60
[GPU Rank 0 | Producer 298] Processing index 17
Batch processed:Batch processed:  Batch processed:Batch processed:  12121212    for rank:for rank:for rank:for rank:    0123



Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samplesQueue size for GPU 3: 20 samples
Queue size for GPU 1: 20 samples


[GPU Rank 2 | Producer 295] Processing index 63
[GPU Rank 3 | Producer 296] Processing index 60[GPU Rank 0 | Producer 302] Processing index 57
[GPU Rank 1 | Producer 305] Processing index 110

[GPU Rank 0] Processed batch 13.
[GPU Rank 2] Processed batch 13.
[GPU Rank 1] Processed batch 13.
[GPU Rank 3] Processed batch 13.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.0748, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2368, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2777, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1997, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 146
[GPU Rank 3 | Producer 296] Processing index 126
[GPU Rank 2 | Producer 295] Processing index 107
Batch processed:Batch processed:  Batch processed:1313  for rank: for rank:  3131
 
for rank: 0Queue size for GPU 3: 20 samples

Queue size for GPU 1: 20 samples
Queue size for GPU 0: 20 samples
Batch processed: 13 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 1 | Producer 297] Processing index 23[GPU Rank 3 | Producer 291] Processing index 54[GPU Rank 2 | Producer 299] Processing index 30


[GPU Rank 0 | Producer 298] Processing index 4
[GPU Rank 0] Processed batch 14.
[GPU Rank 2] Processed batch 14.
[GPU Rank 3] Processed batch 14.
[GPU Rank 1] Processed batch 14.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 141
tensor(0.2516, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2617, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1775, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2731, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 291] Processing index 106
[GPU Rank 2 | Producer 299] Processing index 50
[GPU Rank 1 | Producer 297] Processing index 127
[GPU Rank 0 | Producer 298] Processing index 74
Batch processed: 14Batch processed: for rank:  314
 for rank: 2
Queue size for GPU 3: 20 samples
Queue size for GPU 2: 20 samples
Batch processed: 14 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 14 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 295] Processing index 22
[GPU Rank 3 | Producer 296] Processing index 87[GPU Rank 0 | Producer 306] Processing index 102
[GPU Rank 1 | Producer 305] Processing index 78

[GPU Rank 0] Processed batch 15.
[GPU Rank 2] Processed batch 15.
[GPU Rank 3] Processed batch 15.
[GPU Rank 1] Processed batch 15.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1157, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1404, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1351, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2220, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 1 | Producer 305] Processing index 112
[GPU Rank 0 | Producer 306] Processing index 152
[GPU Rank 2 | Producer 295] Processing index 164
Batch processed:Batch processed:Batch processed:   1515  for rank:15for rank:   0for rank:2
 
3
Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samples
Queue size for GPU 3: 20 samples

Batch processed: 15 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 291] Processing index 146[GPU Rank 0 | Producer 302] Processing index 110

[GPU Rank 1 | Producer 293] Processing index 150
[GPU Rank 2 | Producer 292] Processing index 72
[GPU Rank 0] Processed batch 16.
[GPU Rank 2] Processed batch 16.
[GPU Rank 3] Processed batch 16.
[GPU Rank 1] Processed batch 16.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3214, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1583, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2590, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1877, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 65
[GPU Rank 3 | Producer 291] Processing index 46
[GPU Rank 1 | Producer 293] Processing index 128
Batch processed:Batch processed:  Batch processed:Batch processed:16 16   1616for rank:for rank:    for rank:for rank:13  

02

Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples
Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samples


[GPU Rank 3 | Producer 296] Processing index 144[GPU Rank 2 | Producer 303] Processing index 108[GPU Rank 1 | Producer 305] Processing index 162[GPU Rank 0 | Producer 306] Processing index 45



[GPU Rank 1] Processed batch 17.
[GPU Rank 2] Processed batch 17.
[GPU Rank 3] Processed batch 17.
[GPU Rank 0] Processed batch 17.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 292] Processing index 43
tensor(0.2384, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1984, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2806, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2167, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 26
[GPU Rank 0 | Producer 306] Processing index 63
[GPU Rank 3 | Producer 296] Processing index 35
[GPU Rank 2 | Producer 303] Processing index 137
Batch processed:Batch processed:  1717Batch processed:   for rank:for rank:17   31for rank:
 
2
Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

Queue size for GPU 2: 20 samples
Batch processed: 17 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 1 | Producer 297] Processing index 136
[GPU Rank 2 | Producer 299] Processing index 103
[GPU Rank 3 | Producer 291] Processing index 11
[GPU Rank 0 | Producer 302] Processing index 97
[GPU Rank 3] Processed batch 18.[GPU Rank 2] Processed batch 18.

[GPU Rank 0] Processed batch 18.
[GPU Rank 1] Processed batch 18.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 299] Processing index 156
tensor(0.1078, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2551, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1782, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1508, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 101
[GPU Rank 3 | Producer 291] Processing index 136
[GPU Rank 1 | Producer 297] Processing index 16
Batch processed:Batch processed:  18Batch processed:Batch processed: 18for rank:    for rank:18183  
 1for rank:for rank: 
 20
Queue size for GPU 3: 20 samples

Queue size for GPU 1: 20 samples
Queue size for GPU 2: 20 samplesQueue size for GPU 0: 20 samples

[GPU Rank 2 | Producer 295] Processing index 141
[GPU Rank 3 | Producer 300] Processing index 3
[GPU Rank 1 | Producer 293] Processing index 122[GPU Rank 0 | Producer 306] Processing index 46

[GPU Rank 3] Processed batch 19.
[GPU Rank 1] Processed batch 19.
[GPU Rank 0] Processed batch 19.
[GPU Rank 2] Processed batch 19.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2180, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2059, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3100, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1317, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 293] Processing index 120
[GPU Rank 3 | Producer 300] Processing index 94
[GPU Rank 2 | Producer 295] Processing index 129
[GPU Rank 0 | Producer 306] Processing index 121
Batch processed:Batch processed:  1919Batch processed:Batch processed:  for rank:for rank:    119319
 
 for rank:for rank:  02Queue size for GPU 3: 20 samples

Queue size for GPU 1: 20 samples

Queue size for GPU 2: 20 samplesQueue size for GPU 0: 20 samples

[GPU Rank 3 | Producer 291] Processing index 90[GPU Rank 2 | Producer 303] Processing index 87[GPU Rank 0 | Producer 302] Processing index 68
[GPU Rank 1 | Producer 297] Processing index 0


[GPU Rank 2] Processed batch 20.
[GPU Rank 3] Processed batch 20.
[GPU Rank 1] Processed batch 20.
[GPU Rank 0] Processed batch 20.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1607, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2279, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2030, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2503, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 291] Processing index 153
[GPU Rank 0 | Producer 302] Processing index 114
[GPU Rank 2 | Producer 303] Processing index 136
[GPU Rank 1 | Producer 297] Processing index 125
Batch processed:Batch processed:  2020Batch processed: Batch processed: for rank:for rank:   1 3
2020
  for rank:for rank:  Queue size for GPU 1: 20 samples20Queue size for GPU 3: 20 samples



Queue size for GPU 2: 20 samplesQueue size for GPU 0: 20 samples

[GPU Rank 2 | Producer 292] Processing index 69
[GPU Rank 0 | Producer 306] Processing index 14
[GPU Rank 3 | Producer 304] Processing index 74[GPU Rank 1 | Producer 293] Processing index 158

[GPU Rank 2] Processed batch 21.
[GPU Rank 3] Processed batch 21.
[GPU Rank 1] Processed batch 21.
[GPU Rank 0] Processed batch 21.
loss_value in pytorch loss_value in pytorch loss_value in pytorchloss_value in pytorch  tensor(0.2329, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1984, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1934, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2110, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 304] Processing index 23
[GPU Rank 2 | Producer 292] Processing index 31
[GPU Rank 1 | Producer 293] Processing index 92
[GPU Rank 0 | Producer 306] Processing index 80
Batch processed:Batch processed:  2121  for rank:for rank:  31

RAISE StopIterationRAISE StopIteration

Batch processed: 21 for rank: 2
RAISE StopIteration
Batch processed: 21 for rank: 0
RAISE StopIteration
Batch processed: 0 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 0 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 0 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 3 | Producer 291] Processing index 65[GPU Rank 1 | Producer 305] Processing index 8
[GPU Rank 2 | Producer 303] Processing index 113:::MLLOG {"namespace": "", "time_ms": 1743705563873, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 106, "epoch_num": 23, "current_lr": 0.8}}


:::MLLOG {"namespace": "", "time_ms": 1743705563874, "event_type": "INTERVAL_END", "key": "block_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 135, "first_epoch_num": 23, "epoch_count": 1}}
[GPU Rank 3] Processed batch 1.
[GPU Rank 1] Processed batch 1.
:::MLLOG {"namespace": "", "time_ms": 1743705563875, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 66, "first_epoch_num": 24, "epoch_count": 1}}
:::MLLOG {"namespace": "", "time_ms": 1743705563875, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 68, "epoch_num": 24}}
[GPU Rank 2] Processed batch 1.
Batch processed: 0 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 0 | Producer 298] Processing index 111
[GPU Rank 0] Processed batch 1.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1814, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1379, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1284, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2834, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 303] Processing index 74
[GPU Rank 1 | Producer 305] Processing index 64
[GPU Rank 3 | Producer 291] Processing index 154
[GPU Rank 0 | Producer 298] Processing index 62
Batch processed:Batch processed:  11Batch processed:Batch processed:  for rank:  for rank: 11  for rank:3for rank:  
 210


Queue size for GPU 3: 20 samplesQueue size for GPU 2: 20 samples
Queue size for GPU 1: 20 samplesQueue size for GPU 0: 20 samples


[GPU Rank 2 | Producer 292] Processing index 125[GPU Rank 0 | Producer 306] Processing index 38
[GPU Rank 1 | Producer 301] Processing index 35[GPU Rank 3 | Producer 300] Processing index 86


[GPU Rank 2] Processed batch 2.
[GPU Rank 0] Processed batch 2.
[GPU Rank 3] Processed batch 2.
[GPU Rank 1] Processed batch 2.
loss_value in pytorch loss_value in pytorchloss_value in pytorch  loss_value in pytorch [GPU Rank 3 | Producer 300] Processing index 0
tensor(0.1791, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.0876, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2479, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2096, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 292] Processing index 106
[GPU Rank 1 | Producer 301] Processing index 115
Batch processed:Batch processed:  22  for rank:for rank:  31

Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

Batch processed:Batch processed:  22  for rank:for rank:  20

Queue size for GPU 2: 20 samplesQueue size for GPU 0: 20 samples

[GPU Rank 3 | Producer 291] Processing index 54[GPU Rank 1 | Producer 305] Processing index 55
[GPU Rank 2 | Producer 299] Processing index 9
[GPU Rank 0 | Producer 294] Processing index 166

[GPU Rank 3] Processed batch 3.
[GPU Rank 0] Processed batch 3.
[GPU Rank 2] Processed batch 3.
[GPU Rank 1] Processed batch 3.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 306] Processing index 0
tensor(0.1733, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3697, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2754, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2630, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 133
[GPU Rank 3 | Producer 291] Processing index 106
[GPU Rank 2 | Producer 299] Processing index 26
Batch processed: 3 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 3 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 3 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 3 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 2 | Producer 295] Processing index 160
[GPU Rank 1 | Producer 293] Processing index 157[GPU Rank 0 | Producer 298] Processing index 165[GPU Rank 3 | Producer 296] Processing index 124


[GPU Rank 2] Processed batch 4.
[GPU Rank 0] Processed batch 4.
[GPU Rank 1] Processed batch 4.
[GPU Rank 3] Processed batch 4.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 294] Processing index 55
tensor(0.2140, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1975, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1886, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2607, device='cuda:3', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 47
[GPU Rank 2 | Producer 295] Processing index 143
[GPU Rank 0 | Producer 298] Processing index 28
[GPU Rank 1 | Producer 293] Processing index 94
Batch processed:Batch processed:  44  for rank:for rank: 0 Batch processed:
2Batch processed:
  Queue size for GPU 0: 20 samples44Queue size for GPU 2: 20 samples
  
for rank:for rank: 1 3

Queue size for GPU 1: 20 samplesQueue size for GPU 3: 20 samples

[GPU Rank 2 | Producer 303] Processing index 20
[GPU Rank 0 | Producer 294] Processing index 134
[GPU Rank 1 | Producer 305] Processing index 110
[GPU Rank 3 | Producer 291] Processing index 146
[GPU Rank 0] Processed batch 5.
[GPU Rank 2] Processed batch 5.
[GPU Rank 3] Processed batch 5.
[GPU Rank 1] Processed batch 5.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1803, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2735, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1553, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1873, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 146
[GPU Rank 0 | Producer 294] Processing index 59
[GPU Rank 3 | Producer 291] Processing index 46
Batch processed:Batch processed:Batch processed:Batch processed:    55 55 for rank:  for rank: 0 for rank:for rank:2
  
31

Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samples

Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

[GPU Rank 1 | Producer 293] Processing index 164[GPU Rank 3 | Producer 296] Processing index 137
[GPU Rank 2 | Producer 292] Processing index 152
[GPU Rank 0 | Producer 306] Processing index 102

[GPU Rank 2] Processed batch 6.
[GPU Rank 1] Processed batch 6.
[GPU Rank 3] Processed batch 6.
[GPU Rank 0] Processed batch 6.
loss_value in pytorch loss_value in pytorchloss_value in pytorch  loss_value in pytorch [GPU Rank 2 | Producer 303] Processing index 49
tensor(0.1836, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1994, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2723, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1123, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 306] Processing index 152
[GPU Rank 1 | Producer 293] Processing index 77
[GPU Rank 2 | Producer 292] Processing index 35
Batch processed:Batch processed:Batch processed:Batch processed:    6666    for rank:for rank:for rank:for rank:    2031



Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samples

Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

[GPU Rank 2 | Producer 299] Processing index 104[GPU Rank 3 | Producer 300] Processing index 19
[GPU Rank 1 | Producer 305] Processing index 78
[GPU Rank 0 | Producer 294] Processing index 8

[GPU Rank 0] Processed batch 7.
[GPU Rank 2] Processed batch 7.
[GPU Rank 3] Processed batch 7.
[GPU Rank 1] Processed batch 7.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1281, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1336, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1574, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.0990, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 82
[GPU Rank 0 | Producer 294] Processing index 6
[GPU Rank 1 | Producer 305] Processing index 112
[GPU Rank 3 | Producer 300] Processing index 51
[GPU Rank 2 | Producer 299] Processing index 83
Batch processed: Batch processed:Batch processed:7 for rank:  77   for rank:for rank:3  2
0

Queue size for GPU 3: 20 samplesQueue size for GPU 2: 20 samples
Queue size for GPU 0: 20 samples

Batch processed: 7 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 303] Processing index 38[GPU Rank 0 | Producer 306] Processing index 45
[GPU Rank 3 | Producer 304] Processing index 131
[GPU Rank 1 | Producer 293] Processing index 150

[GPU Rank 2] Processed batch 8.
[GPU Rank 3] Processed batch 8.
[GPU Rank 0] Processed batch 8.
[GPU Rank 1] Processed batch 8.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1994, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1468, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2567, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2496, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 306] Processing index 63
[GPU Rank 1 | Producer 293] Processing index 128
[GPU Rank 3 | Producer 304] Processing index 52
Batch processed: 8 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed:Batch processed:Batch processed:   888   for rank:for rank:for rank:   201


Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samples

Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 300] Processing index 16
[GPU Rank 2 | Producer 299] Processing index 65[GPU Rank 0 | Producer 306] Processing index 46

[GPU Rank 1 | Producer 305] Processing index 162
[GPU Rank 0] Processed batch 9.
[GPU Rank 3] Processed batch 9.
[GPU Rank 2] Processed batch 9.
[GPU Rank 1] Processed batch 9.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 303] Processing index 145
tensor(0.1723, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2324, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1786, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.1692, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 43
[GPU Rank 1 | Producer 305] Processing index 26
[GPU Rank 2 | Producer 299] Processing index 60
[GPU Rank 0 | Producer 306] Processing index 121
Batch processed:Batch processed:Batch processed:   999   for rank:for rank:for rank:   301


Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samplesQueue size for GPU 0: 20 samples


Batch processed: 9 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 1 | Producer 297] Processing index 152[GPU Rank 3 | Producer 304] Processing index 32
[GPU Rank 0 | Producer 302] Processing index 86
[GPU Rank 2 | Producer 295] Processing index 114

[GPU Rank 1] Processed batch 10.
[GPU Rank 3] Processed batch 10.
[GPU Rank 0] Processed batch 10.
[GPU Rank 2] Processed batch 10.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2075, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2046, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2923, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2236, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 145
[GPU Rank 3 | Producer 304] Processing index 161
[GPU Rank 2 | Producer 295] Processing index 41
[GPU Rank 1 | Producer 297] Processing index 46
Batch processed:Batch processed:Batch processed:   1010 for rank:  3for rank:
10  1for rank:
 Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

2
Queue size for GPU 2: 20 samples
[GPU Rank 3 | Producer 296] Processing index 60[GPU Rank 1 | Producer 293] Processing index 122

[GPU Rank 2 | Producer 299] Processing index 30Batch processed: 10 for rank: 0
Queue size for GPU 0: 20 samples

[GPU Rank 0 | Producer 306] Processing index 14
[GPU Rank 3] Processed batch 11.
[GPU Rank 1] Processed batch 11.
[GPU Rank 2] Processed batch 11.
[GPU Rank 0] Processed batch 11.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2707, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2596, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3276, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2115, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 293] Processing index 120
[GPU Rank 3 | Producer 296] Processing index 126
[GPU Rank 0 | Producer 306] Processing index 80
[GPU Rank 2 | Producer 299] Processing index 50
Batch processed:Batch processed:  1111  for rank: for rank:3 1

Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

Batch processed: 11 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 11 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 304] Processing index 17
[GPU Rank 2 | Producer 292] Processing index 138[GPU Rank 1 | Producer 301] Processing index 63
[GPU Rank 0 | Producer 302] Processing index 57

[GPU Rank 2] Processed batch 12.
[GPU Rank 3] Processed batch 12.
[GPU Rank 1] Processed batch 12.
[GPU Rank 0] Processed batch 12.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1880, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2373, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2401, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3068, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 304] Processing index 88
[GPU Rank 1 | Producer 301] Processing index 143
[GPU Rank 2 | Producer 292] Processing index 99
Batch processed:Batch processed:  1212  for rank:for rank:  31

Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

Batch processed: 12 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed:[GPU Rank 3 | Producer 296] Processing index 87 
12 [GPU Rank 1 | Producer 293] Processing index 158for rank: 
0
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 299] Processing index 103
[GPU Rank 0 | Producer 306] Processing index 38
[GPU Rank 3] Processed batch 13.
[GPU Rank 1] Processed batch 13.
[GPU Rank 2] Processed batch 13.
[GPU Rank 0] Processed batch 13.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 141
[GPU Rank 2 | Producer 299] Processing index 156
tensor(0.4510, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2296, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2120, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1787, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 1 | Producer 293] Processing index 92
Batch processed:Batch processed:  1313  for rank:for rank:  31

Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

Batch processed: 13 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 3 | Producer 304] Processing index 158Batch processed: 13 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 295] Processing index 63

[GPU Rank 1 | Producer 301] Processing index 19
[GPU Rank 3] Processed batch 14.
[GPU Rank 1] Processed batch 14.
[GPU Rank 0 | Producer 298] Processing index 151
[GPU Rank 2] Processed batch 14.
[GPU Rank 0] Processed batch 14.
loss_value in pytorchloss_value in pytorch  loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 306] Processing index 0
tensor(0.2239, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2030, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1994, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1327, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 301] Processing index 141
[GPU Rank 0 | Producer 298] Processing index 76
[GPU Rank 2 | Producer 295] Processing index 107
[GPU Rank 3 | Producer 304] Processing index 99
Batch processed:Batch processed:  1414  for rank:for rank:  31

Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

Batch processed: 14 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 14 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 296] Processing index 144
[GPU Rank 2 | Producer 299] Processing index 9
[GPU Rank 1 | Producer 305] Processing index 8[GPU Rank 0 | Producer 302] Processing index 110

[GPU Rank 2] Processed batch 15.
[GPU Rank 1] Processed batch 15.
[GPU Rank 3] Processed batch 15.
[GPU Rank 0] Processed batch 15.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2294, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2655, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2713, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.1705, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 65
[GPU Rank 1 | Producer 305] Processing index 64
[GPU Rank 3 | Producer 296] Processing index 35
[GPU Rank 2 | Producer 299] Processing index 26
Batch processed:Batch processed:  1515  Batch processed:for rank:for rank:  31 

15 for rank: Queue size for GPU 1: 20 samplesQueue size for GPU 3: 20 samples2


Queue size for GPU 2: 20 samples
Batch processed: 15 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 295] Processing index 22
[GPU Rank 3 | Producer 304] Processing index 74
[GPU Rank 1 | Producer 301] Processing index 56[GPU Rank 0 | Producer 298] Processing index 93

[GPU Rank 2] Processed batch 16.
[GPU Rank 3] Processed batch 16.
[GPU Rank 1] Processed batch 16.
[GPU Rank 0] Processed batch 16.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1736, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2162, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2055, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1854, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 301] Processing index 167
[GPU Rank 3 | Producer 304] Processing index 23
[GPU Rank 0 | Producer 298] Processing index 17
[GPU Rank 2 | Producer 295] Processing index 164
Batch processed:Batch processed:  1616  for rank:for rank:  31

Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

Batch processed: 16 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 1 | Producer 305] Processing index 55[GPU Rank 3 | Producer 291] Processing index 11

Batch processed: 16 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 299] Processing index 104[GPU Rank 0 | Producer 302] Processing index 97

[GPU Rank 1] Processed batch 17.
[GPU Rank 3] Processed batch 17.
[GPU Rank 2] Processed batch 17.
[GPU Rank 0] Processed batch 17.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2887, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2773, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2058, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2485, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 101
[GPU Rank 1 | Producer 305] Processing index 133
[GPU Rank 2 | Producer 299] Processing index 83
[GPU Rank 3 | Producer 291] Processing index 136
Batch processed:Batch processed:Batch processed:   17 for rank:1717   1for rank:for rank:  
20

Queue size for GPU 1: 20 samples
Queue size for GPU 2: 20 samplesQueue size for GPU 0: 20 samples

Batch processed: 17 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 2 | Producer 295] Processing index 141[GPU Rank 0 | Producer 298] Processing index 4
[GPU Rank 1 | Producer 301] Processing index 14

[GPU Rank 3 | Producer 304] Processing index 131
[GPU Rank 1] Processed batch 18.
[GPU Rank 2] Processed batch 18.
[GPU Rank 0] Processed batch 18.
[GPU Rank 3] Processed batch 18.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1903, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1994, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1372, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1521, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 295] Processing index 129
[GPU Rank 1 | Producer 301] Processing index 145
[GPU Rank 3 | Producer 304] Processing index 52
[GPU Rank 0 | Producer 298] Processing index 74
Batch processed: 18 for rank: 1
Batch processed: Queue size for GPU 1: 20 samples18
 for rank: 3
Batch processed:Queue size for GPU 3: 20 samples
 18Batch processed: for rank:  218
 for rank: 0
Queue size for GPU 2: 20 samples
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 300] Processing index 8[GPU Rank 0 | Producer 302] Processing index 68
[GPU Rank 2 | Producer 299] Processing index 65

[GPU Rank 1 | Producer 293] Processing index 157
[GPU Rank 2] Processed batch 19.
[GPU Rank 3] Processed batch 19.[GPU Rank 1] Processed batch 19.

[GPU Rank 0] Processed batch 19.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1329, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2635, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2068, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1978, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 114
[GPU Rank 3 | Producer 300] Processing index 29
[GPU Rank 2 | Producer 299] Processing index 60
[GPU Rank 1 | Producer 293] Processing index 94
Batch processed:Batch processed:  1919  for rank:for rank:  13

Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

Batch processed: 19 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 19 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 1 | Producer 297] Processing index 140[GPU Rank 3 | Producer 304] Processing index 32[GPU Rank 2 | Producer 295] Processing index 160
[GPU Rank 0 | Producer 294] Processing index 43


[GPU Rank 2] Processed batch 20.
[GPU Rank 1] Processed batch 20.
[GPU Rank 0] Processed batch 20.
[GPU Rank 3] Processed batch 20.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1643, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1120, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2938, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.1223, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 297] Processing index 42
[GPU Rank 2 | Producer 295] Processing index 143
[GPU Rank 3 | Producer 304] Processing index 161
Batch processed:Batch processed:Batch processed:Batch processed:    20202020    for rank:for rank:for rank:for rank:    3021



Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samplesQueue size for GPU 1: 20 samplesQueue size for GPU 3: 20 samples



[GPU Rank 2 | Producer 299] Processing index 30[GPU Rank 0 | Producer 302] Processing index 86[GPU Rank 1 | Producer 293] Processing index 164[GPU Rank 3 | Producer 291] Processing index 90



[GPU Rank 0] Processed batch 21.
[GPU Rank 2] Processed batch 21.
[GPU Rank 1] Processed batch 21.
[GPU Rank 3] Processed batch 21.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 294] Processing index 75
[GPU Rank 0 | Producer 302] Processing index 145
tensor(0.0936, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1402, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3004, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2408, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 291] Processing index 153
[GPU Rank 1 | Producer 293] Processing index 77
[GPU Rank 2 | Producer 299] Processing index 50
Batch processed: 21 for rank: 3
RAISE StopIteration
Batch processed: Batch processed:21  for rank: 021
 for rank:RAISE StopIteration 
2
RAISE StopIteration
Batch processed: 21 for rank: 1
RAISE StopIteration
:::MLLOG {"namespace": "", "time_ms": 1743705580442, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 106, "epoch_num": 24, "current_lr": 0.8}}
:::MLLOG {"namespace": "", "time_ms": 1743705580443, "event_type": "INTERVAL_START", "key": "eval_start", "value": 24, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 115, "epoch_num": 24}}
Batch processed: 0 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 0 | Producer 310] Processing index 9
[GPU Rank 0] Processed batch 1.
I AM HERe to evaluate
Batch processed: 0 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 1] Processed batch 1.
I AM HERe to evaluate
Batch processed: 0 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 3 | Producer 308] Processing index 1
[GPU Rank 3] Processed batch 1.
I AM HERe to evaluate
Batch processed: 0 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 2] Processed batch 1.
I AM HERe to evaluate
[GPU Rank 2 | Producer 307] Processing index 1
[GPU Rank 1 | Producer 309] Processing index 1
Batch processed: 1 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 2 | Producer 307] Processing index 2
[GPU Rank 2] Processed batch 2.
I AM HERe to evaluate
Batch processed: 1 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 3] Processed batch 2.
[GPU Rank 3 | Producer 308] Processing index 2
I AM HERe to evaluate
Batch processed: 1 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 1 | Producer 309] Processing index 2
[GPU Rank 1] Processed batch 2.
I AM HERe to evaluate
Batch processed: 1 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 0 | Producer 310] Processing index 10
[GPU Rank 0] Processed batch 2.
I AM HERe to evaluate
Batch processed: 2 for rank: 2
RAISE StopIteration
Batch processed: 2 for rank: 1
RAISE StopIteration
Batch processed: 2 for rank: 3
RAISE StopIteration
Batch processed: 2 for rank: 0
RAISE StopIteration
Batch processed: 0 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 2 | Producer 303] Processing index 108
[GPU Rank 2] Processed batch 1.
Batch processed: 0 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 1 | Producer 305] Processing index 110
[GPU Rank 1] Processed batch 1.
:::MLLOG {"namespace": "", "time_ms": 1743705590807, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.30371201038360596, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 120, "epoch_num": 24}}
loss_value in pytorch :::MLLOG {"namespace": "", "time_ms": 1743705590808, "event_type": "INTERVAL_END", "key": "eval_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 124, "epoch_num": 24}}
DLL 2025-04-03 18:39:50.809017 - 24.0 epoch : 24.0  L1 dice : 0.532049834728241  L2 dice : 0.07537420094013214  mean_dice : 0.30371201038360596  eval_loss : 0.4258071184158325  train_loss : 0.20915357768535614  TOP_epoch : 24.0  TOP_L1 dice : 0.532049834728241  TOP_L2 dice : 0.07537420094013214  TOP_mean_dice : 0.30371201038360596  TOP_eval_loss : 0.4258071184158325  TOP_train_loss : 0.20915357768535614 
Batch processed: 0 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 3 | Producer 304] Processing index 17
[GPU Rank 3] Processed batch 1.
:::MLLOG {"namespace": "", "time_ms": 1743705590828, "event_type": "INTERVAL_END", "key": "block_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 135, "first_epoch_num": 24, "epoch_count": 1}}
:::MLLOG {"namespace": "", "time_ms": 1743705590829, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 66, "first_epoch_num": 25, "epoch_count": 1}}
:::MLLOG {"namespace": "", "time_ms": 1743705590829, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 68, "epoch_num": 25}}
Batch processed: 0 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 0 | Producer 294] Processing index 106
[GPU Rank 0] Processed batch 1.
loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1774, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2754, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2858, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2815, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 146
[GPU Rank 3 | Producer 304] Processing index 88
[GPU Rank 2 | Producer 303] Processing index 137
[GPU Rank 0 | Producer 294] Processing index 72
Batch processed:Batch processed:  1Batch processed:1 for rank:   3for rank:1 
 1for rank:
 0
Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

Queue size for GPU 0: 20 samples
Batch processed: 1 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 3 | Producer 296] Processing index 124[GPU Rank 0 | Producer 302] Processing index 57[GPU Rank 1 | Producer 293] Processing index 150


[GPU Rank 2 | Producer 299] Processing index 103
[GPU Rank 1] Processed batch 2.
[GPU Rank 3] Processed batch 2.
[GPU Rank 0] Processed batch 2.
[GPU Rank 2] Processed batch 2.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1947, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1241, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2066, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1933, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 299] Processing index 156
[GPU Rank 3 | Producer 296] Processing index 47
[GPU Rank 1 | Producer 293] Processing index 128
Batch processed:Batch processed:  22  for rank:for rank:  31

Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

Batch processed: 2 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 2 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 1 | Producer 297] Processing index 23[GPU Rank 2 | Producer 292] Processing index 72
[GPU Rank 3 | Producer 304] Processing index 158

[GPU Rank 0 | Producer 298] Processing index 111
[GPU Rank 3] Processed batch 3.
[GPU Rank 1] Processed batch 3.
[GPU Rank 2] Processed batch 3.
[GPU Rank 0] Processed batch 3.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 141
tensor(0.1006, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.0834, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3359, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.1934, device='cuda:2', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 304] Processing index 99
[GPU Rank 0 | Producer 298] Processing index 62
[GPU Rank 2 | Producer 292] Processing index 43
[GPU Rank 1 | Producer 297] Processing index 127
Batch processed:Batch processed:  33  for rank:for rank:  13

Queue size for GPU 1: 20 samplesQueue size for GPU 3: 20 samples

Batch processed: 3 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 3 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 1 | Producer 305] Processing index 78[GPU Rank 0 | Producer 306] Processing index 102[GPU Rank 2 | Producer 303] Processing index 87
[GPU Rank 3 | Producer 296] Processing index 137


[GPU Rank 3] Processed batch 4.
[GPU Rank 0] Processed batch 4.
[GPU Rank 1] Processed batch 4.
[GPU Rank 2] Processed batch 4.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1958, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1256, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1949, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2418, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 303] Processing index 136
[GPU Rank 0 | Producer 306] Processing index 152
[GPU Rank 1 | Producer 305] Processing index 112
Batch processed:Batch processed:Batch processed:   4 44for rank:   for rank:0for rank: 
3 Batch processed:1
Queue size for GPU 0: 20 samples
 
4 for rank:Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples 
2

Queue size for GPU 2: 20 samples
[GPU Rank 0 | Producer 302] Processing index 110
[GPU Rank 1 | Producer 293] Processing index 122
[GPU Rank 3 | Producer 304] Processing index 74[GPU Rank 2 | Producer 295] Processing index 114

[GPU Rank 0] Processed batch 5.
[GPU Rank 3] Processed batch 5.
[GPU Rank 2] Processed batch 5.
[GPU Rank 1] Processed batch 5.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 3 | Producer 296] Processing index 82
tensor(0.2617, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1582, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1942, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2041, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 65
[GPU Rank 1 | Producer 293] Processing index 120
[GPU Rank 3 | Producer 304] Processing index 23
[GPU Rank 2 | Producer 295] Processing index 41
Batch processed:Batch processed:  55  for rank:for rank:  31

Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

Batch processed: 5 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 5 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 3 | Producer 291] Processing index 65[GPU Rank 1 | Producer 305] Processing index 162[GPU Rank 0 | Producer 298] Processing index 165


[GPU Rank 2 | Producer 292] Processing index 69
[GPU Rank 0] Processed batch 6.
[GPU Rank 3] Processed batch 6.
[GPU Rank 2] Processed batch 6.
[GPU Rank 1] Processed batch 6.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1749, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1395, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2905, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1989, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 26
[GPU Rank 2 | Producer 292] Processing index 31
[GPU Rank 0 | Producer 298] Processing index 28
[GPU Rank 3 | Producer 291] Processing index 154
Batch processed:Batch processed:  66  for rank:for rank:  31

Batch processed: Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples6

 for rank: 0
Batch processed: Queue size for GPU 0: 20 samples6
 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 3 | Producer 296] Processing index 60[GPU Rank 0 | Producer 302] Processing index 97[GPU Rank 2 | Producer 295] Processing index 63


[GPU Rank 1 | Producer 293] Processing index 158
[GPU Rank 0] Processed batch 7.
[GPU Rank 2] Processed batch 7.
[GPU Rank 3] Processed batch 7.
[GPU Rank 1] Processed batch 7.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2410, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.0812, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1224, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.1638, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 101
[GPU Rank 2 | Producer 295] Processing index 107
[GPU Rank 3 | Producer 296] Processing index 126
[GPU Rank 1 | Producer 293] Processing index 92
Batch processed:Batch processed:Batch processed:   777   for rank:for rank:for rank:   301


Queue size for GPU 3: 20 samplesQueue size for GPU 0: 20 samplesQueue size for GPU 1: 20 samples


Batch processed: 7 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 3 | Producer 300] Processing index 3[GPU Rank 0 | Producer 306] Processing index 45
[GPU Rank 1 | Producer 305] Processing index 8
[GPU Rank 2 | Producer 292] Processing index 125

[GPU Rank 2] Processed batch 8.
[GPU Rank 3] Processed batch 8.
[GPU Rank 0] Processed batch 8.
[GPU Rank 1] Processed batch 8.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 292] Processing index 106
tensor(0.2144, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1814, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2624, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1035, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 64
[GPU Rank 0 | Producer 306] Processing index 63
[GPU Rank 3 | Producer 300] Processing index 94
Batch processed:Batch processed:  88Batch processed:  for rank:for rank:   318

 for rank: 0Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples


Queue size for GPU 0: 20 samples
Batch processed: 8 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 0 | Producer 302] Processing index 68[GPU Rank 1 | Producer 301] Processing index 35
[GPU Rank 2 | Producer 295] Processing index 22[GPU Rank 3 | Producer 296] Processing index 87


[GPU Rank 1] Processed batch 9.
[GPU Rank 3] Processed batch 9.
[GPU Rank 2] Processed batch 9.
[GPU Rank 0] Processed batch 9.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1956, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1367, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1426, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1071, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 0 | Producer 302] Processing index 114
[GPU Rank 2 | Producer 295] Processing index 164
[GPU Rank 1 | Producer 301] Processing index 115
Batch processed:Batch processed:  99  for rank:for rank:  13

Queue size for GPU 1: 20 samples
Queue size for GPU 3: 20 samples
Batch processed: 9 for rank: 2
Batch processed: Queue size for GPU 2: 20 samples9
 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 1 | Producer 305] Processing index 55
[GPU Rank 3 | Producer 300] Processing index 86
[GPU Rank 2 | Producer 303] Processing index 113
[GPU Rank 0 | Producer 306] Processing index 46
[GPU Rank 3] Processed batch 10.
[GPU Rank 2] Processed batch 10.
[GPU Rank 1] Processed batch 10.
[GPU Rank 0] Processed batch 10.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 3 | Producer 300] Processing index 0
tensor(0.1909, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1718, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1731, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1624, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 133
[GPU Rank 2 | Producer 303] Processing index 74
[GPU Rank 0 | Producer 306] Processing index 121
Batch processed:Batch processed:  1010  for rank:for rank:  31

Batch processed:Queue size for GPU 3: 20 samples Queue size for GPU 1: 20 samples

10 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 10 for rank: 0
[GPU Rank 2 | Producer 295] Processing index 141Queue size for GPU 0: 20 samples

[GPU Rank 1 | Producer 293] Processing index 157[GPU Rank 0 | Producer 302] Processing index 86

[GPU Rank 3 | Producer 304] Processing index 131
[GPU Rank 2] Processed batch 11.
[GPU Rank 1] Processed batch 11.
[GPU Rank 0] Processed batch 11.
[GPU Rank 3] Processed batch 11.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 145
tensor(0.0998, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.0852, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3212, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2141, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 293] Processing index 94
[GPU Rank 2 | Producer 295] Processing index 129
Batch processed:Batch processed:  1111  for rank:for rank:  13

Queue size for GPU 1: 20 samples
Queue size for GPU 3: 20 samples
Batch processed:Batch processed:  1111  for rank:for rank: 0 
2
Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samples

[GPU Rank 3 | Producer 304] Processing index 52
[GPU Rank 1 | Producer 305] Processing index 110[GPU Rank 3 | Producer 291] Processing index 54
[GPU Rank 2 | Producer 299] Processing index 9

[GPU Rank 0 | Producer 298] Processing index 151
[GPU Rank 3] Processed batch 12.
[GPU Rank 1] Processed batch 12.
[GPU Rank 0] Processed batch 12.
[GPU Rank 2] Processed batch 12.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1231, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1646, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2921, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1905, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 146
[GPU Rank 0 | Producer 298] Processing index 76
[GPU Rank 3 | Producer 291] Processing index 106
[GPU Rank 2 | Producer 299] Processing index 26
Batch processed: 12 for rank: 3
Batch processed:Queue size for GPU 3: 20 samples
 12 for rank: 2
Batch processed:Queue size for GPU 2: 20 samples
 Batch processed: 1212 for rank:  for rank:0 
1
Queue size for GPU 1: 20 samples
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 304] Processing index 32
[GPU Rank 2 | Producer 295] Processing index 160[GPU Rank 0 | Producer 302] Processing index 57

[GPU Rank 1 | Producer 297] Processing index 136
[GPU Rank 1] Processed batch 13.
[GPU Rank 0] Processed batch 13.
[GPU Rank 2] Processed batch 13.
[GPU Rank 3] Processed batch 13.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.3084, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2463, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2622, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2633, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 295] Processing index 143
[GPU Rank 3 | Producer 304] Processing index 161
[GPU Rank 1 | Producer 297] Processing index 16
Batch processed: 13 for rank: 3
Batch processed:Queue size for GPU 3: 20 samples
 13 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 13 for rank:Batch processed: 2 
13 for rank: Queue size for GPU 2: 20 samples1

Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 291] Processing index 146
[GPU Rank 0 | Producer 298] Processing index 93[GPU Rank 2 | Producer 303] Processing index 20[GPU Rank 1 | Producer 305] Processing index 78


[GPU Rank 2] Processed batch 14.
[GPU Rank 0] Processed batch 14.
[GPU Rank 3] Processed batch 14.
[GPU Rank 1] Processed batch 14.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 141
tensor(0.2328, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1331, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2094, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1930, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 112
[GPU Rank 3 | Producer 291] Processing index 46
[GPU Rank 0 | Producer 298] Processing index 17
Batch processed:Batch processed:  1414  for rank:for rank:  31

Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

Batch processed:Batch processed:  1414  for rank:for rank:  02

Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samples

[GPU Rank 1 | Producer 297] Processing index 0
[GPU Rank 3 | Producer 304] Processing index 17
[GPU Rank 0 | Producer 294] Processing index 166
[GPU Rank 2 | Producer 295] Processing index 114
[GPU Rank 1] Processed batch 15.
[GPU Rank 0] Processed batch 15.
[GPU Rank 2] Processed batch 15.
[GPU Rank 3] Processed batch 15.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 303] Processing index 49
tensor(0.1968, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1045, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1795, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.1210, device='cuda:3', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 295] Processing index 41
[GPU Rank 1 | Producer 297] Processing index 125
[GPU Rank 3 | Producer 304] Processing index 88
[GPU Rank 0 | Producer 294] Processing index 55
Batch processed:Batch processed:  1515  for rank:for rank:  31

Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

Batch processed: 15 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 15 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 1 | Producer 305] Processing index 162
[GPU Rank 3 | Producer 296] Processing index 144[GPU Rank 2 | Producer 299] Processing index 104[GPU Rank 0 | Producer 302] Processing index 110


[GPU Rank 3] Processed batch 16.
[GPU Rank 1] Processed batch 16.
[GPU Rank 2] Processed batch 16.
[GPU Rank 0] Processed batch 16.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1571, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2581, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1708, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2216, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 26
[GPU Rank 0 | Producer 302] Processing index 65
[GPU Rank 2 | Producer 299] Processing index 83
[GPU Rank 3 | Producer 296] Processing index 35
Batch processed:Batch processed:  1616 Batch processed: for rank: for rank: 3 1
16
 for rank: Queue size for GPU 3: 20 samples0Queue size for GPU 1: 20 samples


Queue size for GPU 0: 20 samples
Batch processed: 16 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 0 | Producer 294] Processing index 134[GPU Rank 3 | Producer 304] Processing index 158
[GPU Rank 1 | Producer 293] Processing index 164[GPU Rank 2 | Producer 295] Processing index 63


[GPU Rank 0] Processed batch 17.
[GPU Rank 1] Processed batch 17.
[GPU Rank 3] Processed batch 17.
[GPU Rank 2] Processed batch 17.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2165, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.0950, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2089, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.1277, device='cuda:2', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 294] Processing index 59
[GPU Rank 1 | Producer 293] Processing index 77
[GPU Rank 2 | Producer 295] Processing index 107
[GPU Rank 3 | Producer 304] Processing index 99
Batch processed:Batch processed:  1717  for rank:for rank:  13

Queue size for GPU 1: 20 samplesQueue size for GPU 3: 20 samples

Batch processed:Batch processed:  1717  for rank: 0for rank:
 2
Queue size for GPU 0: 20 samples
Queue size for GPU 2: 20 samples
[GPU Rank 1 | Producer 305] Processing index 8
[GPU Rank 3 | Producer 296] Processing index 124
[GPU Rank 0 | Producer 302] Processing index 97[GPU Rank 2 | Producer 299] Processing index 65

[GPU Rank 1] Processed batch 18.
[GPU Rank 3] Processed batch 18.
[GPU Rank 0] Processed batch 18.
[GPU Rank 2] Processed batch 18.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2136, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3264, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2385, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2616, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 47
[GPU Rank 1 | Producer 305] Processing index 64
[GPU Rank 0 | Producer 302] Processing index 101
[GPU Rank 2 | Producer 299] Processing index 60
Batch processed:Batch processed:  1818  for rank:for rank: Batch processed: 1Batch processed:3

  1818Queue size for GPU 1: 20 samples  
for rank:for rank:Queue size for GPU 3: 20 samples 
 02

Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samples

[GPU Rank 1 | Producer 293] Processing index 150[GPU Rank 2 | Producer 295] Processing index 22[GPU Rank 0 | Producer 294] Processing index 8
[GPU Rank 3 | Producer 300] Processing index 19


[GPU Rank 1] Processed batch 19.
[GPU Rank 3] Processed batch 19.
[GPU Rank 0] Processed batch 19.
[GPU Rank 2] Processed batch 19.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1701, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2653, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1200, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2072, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 294] Processing index 6
[GPU Rank 3 | Producer 300] Processing index 51
[GPU Rank 2 | Producer 295] Processing index 164
[GPU Rank 1 | Producer 293] Processing index 128
Batch processed:Batch processed:Batch processed:Batch processed:    1919  1919for rank:for rank:    for rank:2for rank:0 
 3
1

Queue size for GPU 2: 20 samplesQueue size for GPU 0: 20 samples

Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

[GPU Rank 2 | Producer 299] Processing index 30[GPU Rank 0 | Producer 298] Processing index 4
[GPU Rank 1 | Producer 305] Processing index 55[GPU Rank 3 | Producer 296] Processing index 137


[GPU Rank 3] Processed batch 20.
[GPU Rank 0] Processed batch 20.
[GPU Rank 1] Processed batch 20.
[GPU Rank 2] Processed batch 20.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1181, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3209, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1776, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.3164, device='cuda:2', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 133
[GPU Rank 2 | Producer 299] Processing index 50
Batch processed:Batch processed:Batch processed:Batch processed:    2020  for rank:for rank:  202002  
for rank:
for rank:  31

Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samples

Queue size for GPU 1: 20 samplesQueue size for GPU 3: 20 samples

[GPU Rank 2 | Producer 303] Processing index 38[GPU Rank 0 | Producer 302] Processing index 68
[GPU Rank 3 | Producer 300] Processing index 16[GPU Rank 1 | Producer 301] Processing index 63


[GPU Rank 0] Processed batch 21.
[GPU Rank 3] Processed batch 21.
[GPU Rank 1] Processed batch 21.
[GPU Rank 2] Processed batch 21.
loss_value in pytorch [GPU Rank 0 | Producer 298] Processing index 74loss_value in pytorch
 loss_value in pytorch loss_value in pytorch tensor(0.2094, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2752, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2197, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3206, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 82
[GPU Rank 3 | Producer 300] Processing index 43
[GPU Rank 0 | Producer 302] Processing index 114
[GPU Rank 1 | Producer 301] Processing index 143
Batch processed:Batch processed:  Batch processed:2121   for rank:for rank:21   1for rank:3 

0RAISE StopIterationRAISE StopIteration


RAISE StopIteration
Batch processed: 21 for rank: 2
RAISE StopIteration
Batch processed: 0 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 0 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 291] Processing index 11:::MLLOG {"namespace": "", "time_ms": 1743705607386, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 106, "epoch_num": 25, "current_lr": 0.8}}
Batch processed: 0 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 1 | Producer 297] Processing index 152

[GPU Rank 2 | Producer 299] Processing index 103:::MLLOG {"namespace": "", "time_ms": 1743705607387, "event_type": "INTERVAL_END", "key": "block_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 135, "first_epoch_num": 25, "epoch_count": 1}}
[GPU Rank 3] Processed batch 1.

:::MLLOG {"namespace": "", "time_ms": 1743705607388, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 66, "first_epoch_num": 26, "epoch_count": 1}}
:::MLLOG {"namespace": "", "time_ms": 1743705607388, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 68, "epoch_num": 26}}
[GPU Rank 1] Processed batch 1.
Batch processed: 0 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 0 | Producer 306] Processing index 14
[GPU Rank 2] Processed batch 1.
[GPU Rank 0] Processed batch 1.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 303] Processing index 145
[GPU Rank 2 | Producer 299] Processing index 156
tensor(0.1079, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1656, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3318, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1140, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 291] Processing index 136
[GPU Rank 1 | Producer 297] Processing index 46
[GPU Rank 0 | Producer 306] Processing index 80
Batch processed: 1 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed:Batch processed:  11  for rank: for rank:2 
0
Queue size for GPU 2: 20 samples
Queue size for GPU 0: 20 samples
Batch processed: 1 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 1 | Producer 305] Processing index 110[GPU Rank 2 | Producer 295] Processing index 141
[GPU Rank 0 | Producer 302] Processing index 86[GPU Rank 3 | Producer 296] Processing index 60


[GPU Rank 1] Processed batch 2.
[GPU Rank 2] Processed batch 2.
[GPU Rank 0] Processed batch 2.
[GPU Rank 3] Processed batch 2.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 145
tensor(0.2150, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2422, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1473, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1283, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 146
[GPU Rank 3 | Producer 296] Processing index 126
[GPU Rank 2 | Producer 295] Processing index 129
Batch processed:Batch processed:  Batch processed:Batch processed:22    for rank:for rank:22    20for rank:for rank:

  31

Queue size for GPU 2: 20 samplesQueue size for GPU 0: 20 samples

Queue size for GPU 1: 20 samples
Queue size for GPU 3: 20 samples
[GPU Rank 0 | Producer 294] Processing index 43[GPU Rank 1 | Producer 297] Processing index 140

[GPU Rank 2 | Producer 299] Processing index 9
[GPU Rank 3 | Producer 291] Processing index 90
[GPU Rank 3] Processed batch 3.
[GPU Rank 1] Processed batch 3.
[GPU Rank 0] Processed batch 3.
[GPU Rank 2] Processed batch 3.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2275, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1985, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2152, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1375, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 291] Processing index 153
[GPU Rank 1 | Producer 297] Processing index 42
[GPU Rank 2 | Producer 299] Processing index 26
Batch processed:Batch processed:  Batch processed:33  for rank: for rank:  133
 
Batch processed:for rank: Queue size for GPU 1: 20 samples0 
Queue size for GPU 3: 20 samples
3
 for rank: 2
Queue size for GPU 0: 20 samples
Queue size for GPU 2: 20 samples
[GPU Rank 3 | Producer 296] Processing index 87[GPU Rank 2 | Producer 295] Processing index 160[GPU Rank 1 | Producer 305] Processing index 78


[GPU Rank 0] Processed batch 4.
[GPU Rank 3] Processed batch 4.
[GPU Rank 1] Processed batch 4.
[GPU Rank 2] Processed batch 4.
loss_value in pytorch loss_value in pytorch loss_value in pytorchloss_value in pytorch  [GPU Rank 0 | Producer 294] Processing index 75
tensor(0.1567, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1827, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2938, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.1975, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 0 | Producer 298] Processing index 111
[GPU Rank 1 | Producer 305] Processing index 112
[GPU Rank 2 | Producer 295] Processing index 143
Batch processed:Batch processed:  44  for rank:for rank:  31

Queue size for GPU 1: 20 samplesQueue size for GPU 3: 20 samples

Batch processed: 4Batch processed: for rank:  40 
for rank: 2Queue size for GPU 0: 20 samples

Queue size for GPU 2: 20 samples
[GPU Rank 3 | Producer 291] Processing index 65[GPU Rank 1 | Producer 305] Processing index 162
[GPU Rank 0 | Producer 306] Processing index 38
[GPU Rank 2 | Producer 299] Processing index 104

[GPU Rank 2] Processed batch 5.
[GPU Rank 0] Processed batch 5.
[GPU Rank 3] Processed batch 5.
[GPU Rank 1] Processed batch 5.
loss_value in pytorchloss_value in pytorch  loss_value in pytorchloss_value in pytorch  [GPU Rank 0 | Producer 298] Processing index 62
tensor(0.1733, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2631, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2221, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3431, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 26
[GPU Rank 2 | Producer 299] Processing index 83
[GPU Rank 3 | Producer 291] Processing index 154
Batch processed:Batch processed: Batch processed: 5 for rank: 3
Queue size for GPU 3: 20 samples5 
 5for rank:  for rank:2 
0
Queue size for GPU 2: 20 samples
Queue size for GPU 0: 20 samples
Batch processed: 5 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 296] Processing index 144[GPU Rank 0 | Producer 298] Processing index 165
[GPU Rank 1 | Producer 301] Processing index 19

[GPU Rank 2 | Producer 292] Processing index 152
[GPU Rank 0] Processed batch 6.
[GPU Rank 2] Processed batch 6.
[GPU Rank 1] Processed batch 6.
[GPU Rank 3] Processed batch 6.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 306] Processing index 0
tensor(0.2776, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.0887, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1181, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2243, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 301] Processing index 141
[GPU Rank 3 | Producer 296] Processing index 35
[GPU Rank 0 | Producer 298] Processing index 28
[GPU Rank 2 | Producer 292] Processing index 35
Batch processed:Batch processed:  6 for rank: 3
6 for rank:Queue size for GPU 3: 20 samples 
0
Queue size for GPU 0: 20 samples
Batch processed: 6 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 6 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 0 | Producer 294] Processing index 106
[GPU Rank 3 | Producer 291] Processing index 54[GPU Rank 2 | Producer 299] Processing index 65
[GPU Rank 1 | Producer 305] Processing index 8

[GPU Rank 0] Processed batch 7.
[GPU Rank 3] Processed batch 7.
[GPU Rank 2] Processed batch 7.
[GPU Rank 1] Processed batch 7.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1130, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1951, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1000, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2566, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 64
[GPU Rank 3 | Producer 291] Processing index 106
[GPU Rank 2 | Producer 299] Processing index 60
[GPU Rank 0 | Producer 294] Processing index 72
Batch processed:Batch processed: 7  7Batch processed:for rank:   for rank:37 
 2for rank:
 0
Queue size for GPU 2: 20 samplesQueue size for GPU 3: 20 samples

Batch processed: Queue size for GPU 0: 20 samples
7 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 0 | Producer 298] Processing index 151
[GPU Rank 2 | Producer 295] Processing index 114
[GPU Rank 3 | Producer 304] Processing index 74[GPU Rank 1 | Producer 301] Processing index 56

[GPU Rank 0] Processed batch 8.
[GPU Rank 3] Processed batch 8.
[GPU Rank 2] Processed batch 8.
[GPU Rank 1] Processed batch 8.
loss_value in pytorch loss_value in pytorchloss_value in pytorch  loss_value in pytorch tensor(0.1589, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1382, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.4895, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2265, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 298] Processing index 76
[GPU Rank 1 | Producer 301] Processing index 167
[GPU Rank 2 | Producer 295] Processing index 41
[GPU Rank 3 | Producer 304] Processing index 23
Batch processed:Batch processed:  88 for rank:  3
for rank: 1
Queue size for GPU 3: 20 samples
Queue size for GPU 1: 20 samples
Batch processed:Batch processed:  88  for rank:for rank:  02

Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samples

[GPU Rank 3 | Producer 291] Processing index 146[GPU Rank 1 | Producer 305] Processing index 55[GPU Rank 2 | Producer 299] Processing index 30
[GPU Rank 0 | Producer 302] Processing index 57


[GPU Rank 3] Processed batch 9.
[GPU Rank 0] Processed batch 9.
[GPU Rank 2] Processed batch 9.
[GPU Rank 1] Processed batch 9.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2350, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1207, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.0965, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1998, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 133
[GPU Rank 3 | Producer 291] Processing index 46
[GPU Rank 2 | Producer 299] Processing index 50
Batch processed:Batch processed:  99  Batch processed:Batch processed:for rank:for rank:  31
  
99  Queue size for GPU 3: 20 samplesfor rank:for rank:
  Queue size for GPU 1: 20 samples02


Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samples

[GPU Rank 3 | Producer 300] Processing index 8[GPU Rank 0 | Producer 298] Processing index 93[GPU Rank 2 | Producer 295] Processing index 63[GPU Rank 1 | Producer 301] Processing index 14



[GPU Rank 0] Processed batch 10.
[GPU Rank 1] Processed batch 10.
[GPU Rank 2] Processed batch 10.
[GPU Rank 3] Processed batch 10.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 141
tensor(0.2262, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2035, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1646, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.1903, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 29
[GPU Rank 2 | Producer 295] Processing index 107
[GPU Rank 0 | Producer 298] Processing index 17
[GPU Rank 1 | Producer 301] Processing index 145
Batch processed:Batch processed:Batch processed:Batch processed:  1010   1010   for rank:for rank:for rank:for rank:    3021



Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samples

[GPU Rank 3 | Producer 291] Processing index 11
[GPU Rank 1 | Producer 305] Processing index 110[GPU Rank 0 | Producer 306] Processing index 102[GPU Rank 2 | Producer 299] Processing index 103


[GPU Rank 0] Processed batch 11.
[GPU Rank 1] Processed batch 11.
[GPU Rank 3] Processed batch 11.
[GPU Rank 2] Processed batch 11.
loss_value in pytorch loss_value in pytorch loss_value in pytorchloss_value in pytorch  [GPU Rank 2 | Producer 299] Processing index 156
tensor(0.4715, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2656, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1872, device='cuda:2', grad_fn=<DivBackward0>)tensor(0.2672, device='cuda:0', grad_fn=<DivBackward0>)

[GPU Rank 1 | Producer 305] Processing index 146
[GPU Rank 3 | Producer 291] Processing index 136
[GPU Rank 0 | Producer 306] Processing index 152
Batch processed:Batch processed:  1111Batch processed:  for rank:for rank:   3111Batch processed:

 for rank:  011Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples 


for rank: 2Queue size for GPU 0: 20 samples

Queue size for GPU 2: 20 samples
[GPU Rank 3 | Producer 296] Processing index 124
[GPU Rank 2 | Producer 295] Processing index 22[GPU Rank 0 | Producer 302] Processing index 110[GPU Rank 1 | Producer 293] Processing index 122


[GPU Rank 1] Processed batch 12.
[GPU Rank 3] Processed batch 12.
[GPU Rank 0] Processed batch 12.
[GPU Rank 2] Processed batch 12.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1658, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2999, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2032, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1910, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 65
[GPU Rank 3 | Producer 296] Processing index 47
[GPU Rank 1 | Producer 293] Processing index 120
[GPU Rank 2 | Producer 295] Processing index 164
Batch processed:Batch processed:  1212 for rank:  for rank:3 
Batch processed:Batch processed:1Queue size for GPU 3: 20 samples

  Queue size for GPU 1: 20 samples12
12  for rank:for rank:  20

Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samples

[GPU Rank 3 | Producer 291] Processing index 90
[GPU Rank 1 | Producer 305] Processing index 78
[GPU Rank 2 | Producer 299] Processing index 9[GPU Rank 0 | Producer 306] Processing index 45

[GPU Rank 2] Processed batch 13.
[GPU Rank 0] Processed batch 13.
[GPU Rank 3] Processed batch 13.
[GPU Rank 1] Processed batch 13.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2061, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1118, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3218, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2690, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 291] Processing index 153
[GPU Rank 1 | Producer 305] Processing index 112
[GPU Rank 0 | Producer 306] Processing index 63
[GPU Rank 2 | Producer 299] Processing index 26
Batch processed:Batch processed:  1313  for rank:for rank:  31

Batch processed:Queue size for GPU 1: 20 samplesQueue size for GPU 3: 20 samples 

13 for rank: 0
Queue size for GPU 0: 20 samples
Batch processed: 13 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 0 | Producer 298] Processing index 4[GPU Rank 2 | Producer 292] Processing index 138[GPU Rank 1 | Producer 293] Processing index 158
[GPU Rank 3 | Producer 296] Processing index 137


[GPU Rank 1] Processed batch 14.
[GPU Rank 0] Processed batch 14.
[GPU Rank 3] Processed batch 14.
[GPU Rank 2] Processed batch 14.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1846, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1081, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3202, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.0764, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 292] Processing index 99
[GPU Rank 1 | Producer 293] Processing index 92
[GPU Rank 0 | Producer 298] Processing index 74
Batch processed:Batch processed: Batch processed:Batch processed: 14   141414for rank:    for rank:for rank:for rank:0   2
13


Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samples

Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

[GPU Rank 2 | Producer 299] Processing index 104[GPU Rank 1 | Producer 305] Processing index 162[GPU Rank 3 | Producer 291] Processing index 65


[GPU Rank 0 | Producer 306] Processing index 46
[GPU Rank 3] Processed batch 15.
[GPU Rank 0] Processed batch 15.
[GPU Rank 1] Processed batch 15.
[GPU Rank 2] Processed batch 15.
loss_value in pytorchloss_value in pytorch  loss_value in pytorch loss_value in pytorch [GPU Rank 3 | Producer 296] Processing index 82
tensor(0.1558, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2117, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2136, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2670, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 26
[GPU Rank 2 | Producer 299] Processing index 83
[GPU Rank 3 | Producer 291] Processing index 154
[GPU Rank 0 | Producer 306] Processing index 121
Batch processed: 15 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 15 for rank: 3
Batch processed: 15 for rank:Batch processed: Queue size for GPU 3: 20 samples
2 
15 for rank: 0Queue size for GPU 2: 20 samples

Queue size for GPU 0: 20 samples
[GPU Rank 1 | Producer 293] Processing index 157[GPU Rank 0 | Producer 302] Processing index 97

[GPU Rank 2 | Producer 303] Processing index 108
[GPU Rank 3 | Producer 300] Processing index 3
[GPU Rank 2] Processed batch 16.
[GPU Rank 0] Processed batch 16.
[GPU Rank 3] Processed batch 16.
[GPU Rank 1] Processed batch 16.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2905, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2624, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3087, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2214, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 101
[GPU Rank 3 | Producer 300] Processing index 94
[GPU Rank 1 | Producer 293] Processing index 94
[GPU Rank 2 | Producer 303] Processing index 137
Batch processed:Batch processed:  1616Batch processed: Batch processed: for rank: for rank:   316161
  
for rank:for rank:  02

Queue size for GPU 0: 20 samples
Queue size for GPU 2: 20 samplesQueue size for GPU 1: 20 samples

Queue size for GPU 3: 20 samples
[GPU Rank 1 | Producer 305] Processing index 8
[GPU Rank 2 | Producer 299] Processing index 65[GPU Rank 0 | Producer 294] Processing index 166
[GPU Rank 3 | Producer 296] Processing index 60

[GPU Rank 0] Processed batch 17.
[GPU Rank 2] Processed batch 17.
[GPU Rank 1] Processed batch 17.
[GPU Rank 3] Processed batch 17.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2145, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.1321, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2569, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1619, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 64
[GPU Rank 3 | Producer 296] Processing index 126
[GPU Rank 2 | Producer 299] Processing index 60
[GPU Rank 0 | Producer 294] Processing index 55
Batch processed:Batch processed:Batch processed:Batch processed:    171717 17 for rank:  for rank: for rank:for rank: 3  2
10


Queue size for GPU 3: 20 samples
Queue size for GPU 2: 20 samplesQueue size for GPU 1: 20 samplesQueue size for GPU 0: 20 samples


[GPU Rank 1 | Producer 297] Processing index 23[GPU Rank 3 | Producer 300] Processing index 86[GPU Rank 0 | Producer 302] Processing index 68
[GPU Rank 2 | Producer 295] Processing index 141


[GPU Rank 1] Processed batch 18.
[GPU Rank 3] Processed batch 18.
[GPU Rank 2] Processed batch 18.
[GPU Rank 0] Processed batch 18.
loss_value in pytorchloss_value in pytorch  loss_value in pytorch loss_value in pytorch [GPU Rank 3 | Producer 300] Processing index 0
tensor(0.2776, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1786, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.0953, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1818, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 114
[GPU Rank 2 | Producer 295] Processing index 129
[GPU Rank 1 | Producer 297] Processing index 127
Batch processed:Batch processed:  1818  for rank:for rank:  13

Batch processed:Batch processed:Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

  1818  for rank:for rank:  20

Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samples

[GPU Rank 1 | Producer 305] Processing index 55
[GPU Rank 3 | Producer 296] Processing index 87[GPU Rank 2 | Producer 303] Processing index 87
[GPU Rank 0 | Producer 306] Processing index 14

[GPU Rank 0] Processed batch 19.
[GPU Rank 2] Processed batch 19.
[GPU Rank 3] Processed batch 19.
[GPU Rank 1] Processed batch 19.
loss_value in pytorchloss_value in pytorch  loss_value in pytorchloss_value in pytorch  tensor(0.1353, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2071, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1933, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2122, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 303] Processing index 136
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 1 | Producer 305] Processing index 133
[GPU Rank 0 | Producer 306] Processing index 80
Batch processed:Batch processed:Batch processed:Batch processed:    191919 19  for rank: for rank: for rank:for rank: 3  2
10


Queue size for GPU 2: 20 samplesQueue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samplesQueue size for GPU 0: 20 samples



[GPU Rank 0 | Producer 302] Processing index 86
[GPU Rank 2 | Producer 295] Processing index 160[GPU Rank 3 | Producer 304] Processing index 131
[GPU Rank 1 | Producer 301] Processing index 35

[GPU Rank 3] Processed batch 20.
[GPU Rank 2] Processed batch 20.
[GPU Rank 0] Processed batch 20.
[GPU Rank 1] Processed batch 20.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 145
tensor(0.1374, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1019, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1545, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1790, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 295] Processing index 143
[GPU Rank 1 | Producer 301] Processing index 115
[GPU Rank 3 | Producer 304] Processing index 52
Batch processed:Batch processed:  2020  for rank:for rank:Batch processed:  02 

20Batch processed: for rank: Queue size for GPU 2: 20 samplesQueue size for GPU 0: 20 samples 3


20 for rank: 1Queue size for GPU 3: 20 samples

Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 296] Processing index 144[GPU Rank 1 | Producer 305] Processing index 110

[GPU Rank 0 | Producer 294] Processing index 134
[GPU Rank 2 | Producer 303] Processing index 113
[GPU Rank 2] Processed batch 21.
[GPU Rank 1] Processed batch 21.
[GPU Rank 0] Processed batch 21.
[GPU Rank 3] Processed batch 21.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1268, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2637, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1892, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.1347, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 146
[GPU Rank 2 | Producer 303] Processing index 74
[GPU Rank 0 | Producer 294] Processing index 59
[GPU Rank 3 | Producer 296] Processing index 35
Batch processed:Batch processed:  2121Batch processed:Batch processed:  for rank:for rank:    210221 

 for rank: for rank:RAISE StopIterationRAISE StopIteration3 


1
RAISE StopIteration
RAISE StopIteration
Batch processed:Batch processed:  00  for rank:for rank: 1Batch processed:
  20
Queue size for GPU 1: 20 samples 
for rank: 3Queue size for GPU 2: 20 samples

Queue size for GPU 3: 20 samples
[GPU Rank 2 | Producer 292] Processing index 72[GPU Rank 1 | Producer 293] Processing index 164
[GPU Rank 3 | Producer 304] Processing index 32
:::MLLOG {"namespace": "", "time_ms": 1743705623887, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 106, "epoch_num": 26, "current_lr": 0.8}}

:::MLLOG {"namespace": "", "time_ms": 1743705623888, "event_type": "INTERVAL_END", "key": "block_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 135, "first_epoch_num": 26, "epoch_count": 1}}
:::MLLOG {"namespace": "", "time_ms": 1743705623888, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 66, "first_epoch_num": 27, "epoch_count": 1}}
[GPU Rank 2] Processed batch 1.
[GPU Rank 1] Processed batch 1.
:::MLLOG {"namespace": "", "time_ms": 1743705623888, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 68, "epoch_num": 27}}
[GPU Rank 3] Processed batch 1.
Batch processed: 0 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 0 | Producer 302] Processing index 57
[GPU Rank 0] Processed batch 1.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1813, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3762, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1230, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1254, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 293] Processing index 77
[GPU Rank 3 | Producer 304] Processing index 161
Batch processed:Batch processed:  11  for rank:for rank:  31

Queue size for GPU 1: 20 samplesQueue size for GPU 3: 20 samples

Batch processed: 1 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 1 | Producer 305] Processing index 78
Batch processed: 1 for rank:[GPU Rank 3 | Producer 296] Processing index 124 0

Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 303] Processing index 20
[GPU Rank 0 | Producer 294] Processing index 8
[GPU Rank 1] Processed batch 2.
[GPU Rank 3] Processed batch 2.
[GPU Rank 2] Processed batch 2.
[GPU Rank 0] Processed batch 2.
[GPU Rank 2 | Producer 292] Processing index 43
loss_value in pytorchloss_value in pytorch  loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 141
tensor(0.1277, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1456, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2869, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.0910, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 47
[GPU Rank 0 | Producer 294] Processing index 6
[GPU Rank 1 | Producer 305] Processing index 112
Batch processed:Batch processed:  22  for rank:for rank:  31

Queue size for GPU 1: 20 samplesQueue size for GPU 3: 20 samples

Batch processed: 2 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 2 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 304] Processing index 17
[GPU Rank 1 | Producer 297] Processing index 136
[GPU Rank 2 | Producer 295] Processing index 114
[GPU Rank 0 | Producer 298] Processing index 111
[GPU Rank 1] Processed batch 3.
[GPU Rank 3] Processed batch 3.
[GPU Rank 2] Processed batch 3.
[GPU Rank 0] Processed batch 3.
loss_value in pytorchloss_value in pytorch  loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 303] Processing index 49
tensor(0.1688, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2653, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2175, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2285, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 295] Processing index 41
[GPU Rank 3 | Producer 304] Processing index 88
[GPU Rank 1 | Producer 297] Processing index 16
[GPU Rank 0 | Producer 298] Processing index 62
Batch processed:Batch processed:  33  for rank:for rank:  31

Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

Batch processed: 3 for rank: 0Batch processed:
 3Queue size for GPU 0: 20 samples 
for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 1 | Producer 305] Processing index 162
[GPU Rank 3 | Producer 296] Processing index 137
[GPU Rank 0 | Producer 306] Processing index 38[GPU Rank 2 | Producer 299] Processing index 30

[GPU Rank 3] Processed batch 4.
[GPU Rank 1] Processed batch 4.
[GPU Rank 2] Processed batch 4.
[GPU Rank 0] Processed batch 4.
loss_value in pytorchloss_value in pytorch  loss_value in pytorch loss_value in pytorch tensor(0.2572, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1823, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2223, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2588, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 26
[GPU Rank 2 | Producer 299] Processing index 50
Batch processed:Batch processed:  44  Batch processed:for rank:for rank:  31 

4 for rank:Queue size for GPU 3: 20 samples Queue size for GPU 1: 20 samples
2

Batch processed: 4Queue size for GPU 2: 20 samples 
for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 304] Processing index 158[GPU Rank 1 | Producer 297] Processing index 0
[GPU Rank 2 | Producer 295] Processing index 63[GPU Rank 0 | Producer 294] Processing index 43


[GPU Rank 3] Processed batch 5.
[GPU Rank 1] Processed batch 5.
[GPU Rank 0] Processed batch 5.
[GPU Rank 2] Processed batch 5.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 306] Processing index 0
tensor(0.2557, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2782, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1813, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.1198, device='cuda:2', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 82
[GPU Rank 1 | Producer 297] Processing index 125
[GPU Rank 2 | Producer 295] Processing index 107
[GPU Rank 3 | Producer 304] Processing index 99
Batch processed:Batch processed:Batch processed:Batch processed:    555 5   for rank:for rank:for rank:for rank:    0321



Queue size for GPU 0: 20 samples
Queue size for GPU 2: 20 samplesQueue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples


[GPU Rank 3 | Producer 291] Processing index 54
[GPU Rank 1 | Producer 305] Processing index 8
[GPU Rank 0 | Producer 298] Processing index 165[GPU Rank 2 | Producer 292] Processing index 69

[GPU Rank 0] Processed batch 6.
[GPU Rank 2] Processed batch 6.
[GPU Rank 1] Processed batch 6.
[GPU Rank 3] Processed batch 6.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 294] Processing index 75
tensor(0.1936, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1865, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1481, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1890, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 64
[GPU Rank 0 | Producer 298] Processing index 28
[GPU Rank 2 | Producer 292] Processing index 31
[GPU Rank 3 | Producer 291] Processing index 106
Batch processed:Batch processed:  Batch processed:Batch processed:66    for rank:for rank:6  6 3 for rank:
1for rank: 
 20
Queue size for GPU 3: 20 samples

Queue size for GPU 1: 20 samples
Queue size for GPU 2: 20 samplesQueue size for GPU 0: 20 samples

[GPU Rank 2 | Producer 295] Processing index 22[GPU Rank 3 | Producer 296] Processing index 60[GPU Rank 1 | Producer 293] Processing index 150
[GPU Rank 0 | Producer 294] Processing index 106


[GPU Rank 1] Processed batch 7.[GPU Rank 0] Processed batch 7.

[GPU Rank 3] Processed batch 7.
[GPU Rank 2] Processed batch 7.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2744, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1096, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1605, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2273, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 126
[GPU Rank 0 | Producer 294] Processing index 72
[GPU Rank 2 | Producer 295] Processing index 164
[GPU Rank 1 | Producer 293] Processing index 128
Batch processed:Batch processed:Batch processed:Batch processed:  77    for rank:for rank:77   2 0for rank:
for rank:
  31

Queue size for GPU 2: 20 samplesQueue size for GPU 0: 20 samples

Queue size for GPU 1: 20 samplesQueue size for GPU 3: 20 samples

[GPU Rank 1 | Producer 305] Processing index 55[GPU Rank 3 | Producer 300] Processing index 19
[GPU Rank 0 | Producer 306] Processing index 102[GPU Rank 2 | Producer 292] Processing index 125


[GPU Rank 0] Processed batch 8.[GPU Rank 2] Processed batch 8.

[GPU Rank 3] Processed batch 8.
[GPU Rank 1] Processed batch 8.
loss_value in pytorchloss_value in pytorch  loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 292] Processing index 106
tensor(0.2106, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2067, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1955, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.3045, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 306] Processing index 152
[GPU Rank 1 | Producer 305] Processing index 133
[GPU Rank 3 | Producer 300] Processing index 51
Batch processed:Batch processed:  88  for rank:for rank:  02

Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samples

Batch processed: 8 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 8 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 2 | Producer 303] Processing index 38[GPU Rank 3 | Producer 296] Processing index 87
[GPU Rank 0 | Producer 302] Processing index 110

[GPU Rank 1 | Producer 301] Processing index 63
[GPU Rank 0] Processed batch 9.
[GPU Rank 2] Processed batch 9.
[GPU Rank 3] Processed batch 9.
[GPU Rank 1] Processed batch 9.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2431, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2213, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1798, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2203, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 0 | Producer 302] Processing index 65
[GPU Rank 1 | Producer 301] Processing index 143
Batch processed: Batch processed:9Batch processed: for rank: 1  
99  for rank:Queue size for GPU 1: 20 samplesfor rank: 
 2
0
Queue size for GPU 2: 20 samples
Queue size for GPU 0: 20 samples
Batch processed: 9 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 1 | Producer 293] Processing index 122
[GPU Rank 0 | Producer 306] Processing index 45
[GPU Rank 2 | Producer 292] Processing index 152
[GPU Rank 3 | Producer 300] Processing index 16
[GPU Rank 2] Processed batch 10.
[GPU Rank 1] Processed batch 10.
[GPU Rank 3] Processed batch 10.
[GPU Rank 0] Processed batch 10.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 303] Processing index 145
tensor(0.1587, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2316, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.3091, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1952, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 43
[GPU Rank 1 | Producer 293] Processing index 120
[GPU Rank 0 | Producer 306] Processing index 63
[GPU Rank 2 | Producer 292] Processing index 35
Batch processed:Batch processed:Batch processed:Batch processed:    10101010    for rank:for rank:for rank:for rank:    0321



Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samplesQueue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples



[GPU Rank 1 | Producer 301] Processing index 19[GPU Rank 2 | Producer 295] Processing index 141[GPU Rank 0 | Producer 302] Processing index 97
[GPU Rank 3 | Producer 296] Processing index 144


[GPU Rank 1] Processed batch 11.
[GPU Rank 2] Processed batch 11.
[GPU Rank 3] Processed batch 11.
[GPU Rank 0] Processed batch 11.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2409, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1134, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1205, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1937, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 101
[GPU Rank 1 | Producer 301] Processing index 141
[GPU Rank 3 | Producer 296] Processing index 35
[GPU Rank 2 | Producer 295] Processing index 129
Batch processed: Batch processed:Batch processed:11 for rank:   01111
  for rank:for rank:  31Queue size for GPU 0: 20 samples


Queue size for GPU 1: 20 samplesQueue size for GPU 3: 20 samples

Batch processed: 11 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 0 | Producer 306] Processing index 46[GPU Rank 1 | Producer 293] Processing index 158[GPU Rank 3 | Producer 291] Processing index 146[GPU Rank 2 | Producer 299] Processing index 103



[GPU Rank 1] Processed batch 12.
[GPU Rank 0] Processed batch 12.
[GPU Rank 3] Processed batch 12.
[GPU Rank 2] Processed batch 12.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1103, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1649, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2445, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.1939, device='cuda:2', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 299] Processing index 156
[GPU Rank 3 | Producer 291] Processing index 46
[GPU Rank 1 | Producer 293] Processing index 92
[GPU Rank 0 | Producer 306] Processing index 121
Batch processed:Batch processed:  1212  Batch processed:for rank:for rank:  2 0

12 for rank: Queue size for GPU 2: 20 samplesQueue size for GPU 0: 20 samples3


Queue size for GPU 3: 20 samples
Batch processed: 12 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 0 | Producer 302] Processing index 68[GPU Rank 2 | Producer 295] Processing index 160

[GPU Rank 1 | Producer 301] Processing index 56
[GPU Rank 3 | Producer 304] Processing index 74
[GPU Rank 3] Processed batch 13.
[GPU Rank 0] Processed batch 13.
[GPU Rank 1] Processed batch 13.
[GPU Rank 2] Processed batch 13.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1629, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1958, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2074, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.1731, device='cuda:2', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 114
[GPU Rank 2 | Producer 295] Processing index 143
[GPU Rank 1 | Producer 301] Processing index 167
[GPU Rank 3 | Producer 304] Processing index 23
Batch processed:Batch processed:Batch processed:   13Batch processed: for rank:  313
 1313  for rank:for rank:for rank:   201Queue size for GPU 3: 20 samples



Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samples

Queue size for GPU 1: 20 samples
[GPU Rank 3 | Producer 300] Processing index 8[GPU Rank 0 | Producer 298] Processing index 151[GPU Rank 2 | Producer 292] Processing index 138[GPU Rank 1 | Producer 293] Processing index 157



[GPU Rank 2] Processed batch 14.
[GPU Rank 0] Processed batch 14.
[GPU Rank 3] Processed batch 14.
[GPU Rank 1] Processed batch 14.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.4207, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1675, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2225, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1686, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 29
[GPU Rank 0 | Producer 298] Processing index 76
[GPU Rank 2 | Producer 292] Processing index 99
[GPU Rank 1 | Producer 293] Processing index 94
Batch processed:Batch processed:Batch processed:  14 14 for rank: 14 for rank: 3 for rank:
1 
0
Queue size for GPU 3: 20 samples
Queue size for GPU 1: 20 samples
Queue size for GPU 0: 20 samples
Batch processed: 14 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 0 | Producer 302] Processing index 86[GPU Rank 3 | Producer 296] Processing index 124
[GPU Rank 2 | Producer 295] Processing index 114

[GPU Rank 1 | Producer 301] Processing index 14
[GPU Rank 3] Processed batch 15.
[GPU Rank 2] Processed batch 15.
[GPU Rank 1] Processed batch 15.
[GPU Rank 0] Processed batch 15.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 145
tensor(0.1045, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1812, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2146, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2799, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 47
[GPU Rank 2 | Producer 295] Processing index 41
[GPU Rank 1 | Producer 301] Processing index 145
Batch processed:Batch processed:Batch processed:Batch processed:    1515  for rank:for rank:15  15 31 for rank:
 for rank:
2 0
Queue size for GPU 3: 20 samples
Queue size for GPU 1: 20 samples

Queue size for GPU 2: 20 samples
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 300] Processing index 3
[GPU Rank 2 | Producer 299] Processing index 9[GPU Rank 0 | Producer 298] Processing index 93

[GPU Rank 1 | Producer 293] Processing index 164
[GPU Rank 3] Processed batch 16.
[GPU Rank 0] Processed batch 16.
[GPU Rank 1] Processed batch 16.
[GPU Rank 2] Processed batch 16.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1760, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2592, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1217, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1065, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 293] Processing index 77
[GPU Rank 3 | Producer 300] Processing index 94
[GPU Rank 0 | Producer 298] Processing index 17
[GPU Rank 2 | Producer 299] Processing index 26
Batch processed:Batch processed:  1616  for rank:for rank:  31

Batch processed:Batch processed:Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

  1616  for rank:for rank:  20

Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samples

[GPU Rank 3 | Producer 296] Processing index 137[GPU Rank 1 | Producer 301] Processing index 35[GPU Rank 0 | Producer 302] Processing index 57


[GPU Rank 2 | Producer 295] Processing index 63
[GPU Rank 1] Processed batch 17.
[GPU Rank 3] Processed batch 17.
[GPU Rank 0] Processed batch 17.
[GPU Rank 2] Processed batch 17.
loss_value in pytorchloss_value in pytorch  loss_value in pytorch loss_value in pytorch tensor(0.2660, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1694, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2053, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1236, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 295] Processing index 107
[GPU Rank 1 | Producer 301] Processing index 115
Batch processed:Batch processed:Batch processed:Batch processed:    17171717  for rank:for rank:  1  3
for rank:for rank:
  02

Queue size for GPU 1: 20 samplesQueue size for GPU 3: 20 samples

Queue size for GPU 2: 20 samplesQueue size for GPU 0: 20 samples

[GPU Rank 0 | Producer 298] Processing index 4[GPU Rank 2 | Producer 292] Processing index 72

[GPU Rank 1 | Producer 297] Processing index 152
[GPU Rank 3 | Producer 300] Processing index 86
[GPU Rank 3] Processed batch 18.
[GPU Rank 2] Processed batch 18.
[GPU Rank 0] Processed batch 18.
[GPU Rank 1] Processed batch 18.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 141
[GPU Rank 3 | Producer 296] Processing index 82
tensor(0.2899, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1770, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2311, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2138, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 0
[GPU Rank 1 | Producer 297] Processing index 46
[GPU Rank 2 | Producer 292] Processing index 43
[GPU Rank 0 | Producer 298] Processing index 74
Batch processed:Batch processed:  Batch processed:1818  for rank:for rank:   3118
 for rank: Batch processed:2
 
18 for rank:Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples Queue size for GPU 2: 20 samples

0

Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 304] Processing index 131[GPU Rank 0 | Producer 294] Processing index 166

[GPU Rank 2 | Producer 295] Processing index 22
[GPU Rank 1 | Producer 301] Processing index 63
[GPU Rank 0] Processed batch 19.
[GPU Rank 2] Processed batch 19.
[GPU Rank 1] Processed batch 19.
[GPU Rank 3] Processed batch 19.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1232, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1219, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1130, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1653, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 301] Processing index 143
[GPU Rank 2 | Producer 295] Processing index 164
[GPU Rank 0 | Producer 294] Processing index 55
Batch processed:Batch processed:  1919  for rank:for rank:  13

Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

Batch processed: 19Batch processed: for rank:  219
 for rank: 0
Queue size for GPU 2: 20 samples
Queue size for GPU 0: 20 samples
[GPU Rank 0 | Producer 306] Processing index 14[GPU Rank 3 | Producer 300] Processing index 19
[GPU Rank 2 | Producer 299] Processing index 104[GPU Rank 1 | Producer 293] Processing index 150


[GPU Rank 3] Processed batch 20.
[GPU Rank 2] Processed batch 20.
[GPU Rank 1] Processed batch 20.
[GPU Rank 0] Processed batch 20.
[GPU Rank 3 | Producer 304] Processing index 52
loss_value in pytorchloss_value in pytorch  loss_value in pytorch loss_value in pytorch tensor(0.1829, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1249, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2690, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1462, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 51
[GPU Rank 2 | Producer 299] Processing index 83
[GPU Rank 1 | Producer 293] Processing index 128
[GPU Rank 0 | Producer 306] Processing index 80
Batch processed:Batch processed:  2020  for rank:for rank:  13

Queue size for GPU 1: 20 samplesQueue size for GPU 3: 20 samples

Batch processed: 20 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 20 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 292] Processing index 69[GPU Rank 1 | Producer 301] Processing index 19

[GPU Rank 3 | Producer 304] Processing index 32[GPU Rank 0 | Producer 294] Processing index 134

[GPU Rank 0] Processed batch 21.
[GPU Rank 1] Processed batch 21.
[GPU Rank 2] Processed batch 21.
[GPU Rank 3] Processed batch 21.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2671, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2526, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2075, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2639, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 301] Processing index 141
[GPU Rank 0 | Producer 294] Processing index 59
[GPU Rank 3 | Producer 304] Processing index 161
[GPU Rank 2 | Producer 292] Processing index 31
Batch processed:Batch processed:  Batch processed:Batch processed:2121    for rank:for rank:2121    20for rank:for rank:

  31RAISE StopIterationRAISE StopIteration



RAISE StopIteration
RAISE StopIteration
Batch processed:Batch processed:  00  for rank:for rank:  1
Queue size for GPU 1: 20 samples3

Queue size for GPU 3: 20 samples
Batch processed: 0 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 3 | Producer 296] Processing index 60
[GPU Rank 1 | Producer 305] Processing index 110:::MLLOG {"namespace": "", "time_ms": 1743705640416, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 106, "epoch_num": 27, "current_lr": 0.8}}
[GPU Rank 2 | Producer 299] Processing index 65

:::MLLOG {"namespace": "", "time_ms": 1743705640418, "event_type": "INTERVAL_END", "key": "block_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 135, "first_epoch_num": 27, "epoch_count": 1}}
:::MLLOG {"namespace": "", "time_ms": 1743705640418, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 66, "first_epoch_num": 28, "epoch_count": 1}}
[GPU Rank 2] Processed batch 1.
:::MLLOG {"namespace": "", "time_ms": 1743705640418, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 68, "epoch_num": 28}}
Batch processed: 0 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3] Processed batch 1.
[GPU Rank 0 | Producer 298] Processing index 111[GPU Rank 1] Processed batch 1.

[GPU Rank 0] Processed batch 1.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1008, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1708, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2162, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1879, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 146
[GPU Rank 3 | Producer 296] Processing index 126
[GPU Rank 2 | Producer 299] Processing index 60
[GPU Rank 0 | Producer 298] Processing index 62
Batch processed:Batch processed:  11Batch processed:  for rank:for rank:   20
1
 for rank: 1Queue size for GPU 2: 20 samplesQueue size for GPU 0: 20 samples


Queue size for GPU 1: 20 samples
Batch processed: 1 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 2 | Producer 292] Processing index 125
[GPU Rank 0 | Producer 294] Processing index 8
[GPU Rank 1 | Producer 293] Processing index 122
[GPU Rank 3 | Producer 304] Processing index 17
[GPU Rank 0] Processed batch 2.
[GPU Rank 1] Processed batch 2.
[GPU Rank 2] Processed batch 2.
[GPU Rank 3] Processed batch 2.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2045, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1737, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1466, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1679, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 2 | Producer 292] Processing index 106
[GPU Rank 0 | Producer 294] Processing index 6
[GPU Rank 1 | Producer 293] Processing index 120
[GPU Rank 3 | Producer 304] Processing index 88
Batch processed:Batch processed:Batch processed:  22   2Batch processed:for rank:  for rank: for rank:2  20
1 

for rank: 3Queue size for GPU 2: 20 samples

Queue size for GPU 0: 20 samplesQueue size for GPU 1: 20 samples

Queue size for GPU 3: 20 samples
[GPU Rank 0 | Producer 306] Processing index 38[GPU Rank 1 | Producer 305] Processing index 78
[GPU Rank 2 | Producer 299] Processing index 30
[GPU Rank 3 | Producer 296] Processing index 87

[GPU Rank 1] Processed batch 3.
[GPU Rank 2] Processed batch 3.
[GPU Rank 0] Processed batch 3.
[GPU Rank 3] Processed batch 3.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1444, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2003, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1624, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1434, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 1 | Producer 305] Processing index 112
[GPU Rank 2 | Producer 299] Processing index 50
[GPU Rank 0 | Producer 306] Processing index 0
Batch processed:Batch processed:  33  for rank:for rank:  13

Queue size for GPU 1: 20 samplesQueue size for GPU 3: 20 samplesBatch processed:

 3 for rank: 0
Batch processed: Queue size for GPU 0: 20 samples3
 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 3 | Producer 304] Processing index 158
[GPU Rank 0 | Producer 302] Processing index 110[GPU Rank 2 | Producer 292] Processing index 152

[GPU Rank 1 | Producer 293] Processing index 158
[GPU Rank 1] Processed batch 4.
[GPU Rank 0] Processed batch 4.
[GPU Rank 2] Processed batch 4.
[GPU Rank 3] Processed batch 4.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1084, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2651, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1187, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1147, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 65
[GPU Rank 2 | Producer 292] Processing index 35
[GPU Rank 3 | Producer 304] Processing index 99
[GPU Rank 1 | Producer 293] Processing index 92
Batch processed:Batch processed:Batch processed:Batch processed:    4444  for rank:for rank:    31for rank:for rank:

  20

Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samples

[GPU Rank 3 | Producer 296] Processing index 144[GPU Rank 1 | Producer 305] Processing index 162

[GPU Rank 0 | Producer 306] Processing index 102
[GPU Rank 2 | Producer 299] Processing index 103
[GPU Rank 0] Processed batch 5.
[GPU Rank 3] Processed batch 5.
[GPU Rank 2] Processed batch 5.
[GPU Rank 1] Processed batch 5.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 299] Processing index 156
tensor(0.2793, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1728, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1743, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.1609, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 306] Processing index 152
[GPU Rank 1 | Producer 305] Processing index 26
[GPU Rank 3 | Producer 296] Processing index 35
Batch processed: 5 Batch processed:for rank: 2 
5 for rank:Queue size for GPU 2: 20 samples 
0
Queue size for GPU 0: 20 samples
Batch processed: 5 for rank: 3
Queue size for GPU 3: 20 samples
Batch processed: 5 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 1 | Producer 301] Processing index 56
[GPU Rank 2 | Producer 295] Processing index 141
[GPU Rank 0 | Producer 302] Processing index 97
[GPU Rank 3 | Producer 300] Processing index 16
[GPU Rank 3] Processed batch 6.[GPU Rank 2] Processed batch 6.

[GPU Rank 0] Processed batch 6.
[GPU Rank 1] Processed batch 6.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.0811, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2938, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1653, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1811, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 101
[GPU Rank 3 | Producer 300] Processing index 43
[GPU Rank 1 | Producer 301] Processing index 167
[GPU Rank 2 | Producer 295] Processing index 129
Batch processed: 6 for rank: 0
Batch processed:Queue size for GPU 0: 20 samples
 6 Batch processed:for rank: 3 Batch processed:
6  for rank: 6Queue size for GPU 3: 20 samples1 

for rank: 2
Queue size for GPU 1: 20 samples
Queue size for GPU 2: 20 samples
[GPU Rank 3 | Producer 291] Processing index 11
[GPU Rank 0 | Producer 306] Processing index 45
[GPU Rank 2 | Producer 299] Processing index 9
[GPU Rank 1 | Producer 305] Processing index 8
[GPU Rank 3] Processed batch 7.
[GPU Rank 2] Processed batch 7.
[GPU Rank 0] Processed batch 7.
[GPU Rank 1] Processed batch 7.
loss_value in pytorchloss_value in pytorch  loss_value in pytorch loss_value in pytorch tensor(0.1287, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2074, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.0733, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1644, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 64
[GPU Rank 0 | Producer 306] Processing index 63
[GPU Rank 3 | Producer 291] Processing index 136
[GPU Rank 2 | Producer 299] Processing index 26
Batch processed:Batch processed:Batch processed:Batch processed:    77  77for rank:for rank:    for rank:1for rank:3  

20

Queue size for GPU 1: 20 samplesQueue size for GPU 3: 20 samplesQueue size for GPU 2: 20 samplesQueue size for GPU 0: 20 samples



[GPU Rank 2 | Producer 303] Processing index 108[GPU Rank 3 | Producer 304] Processing index 74
[GPU Rank 0 | Producer 302] Processing index 68

[GPU Rank 1 | Producer 293] Processing index 157
[GPU Rank 3] Processed batch 8.
[GPU Rank 0] Processed batch 8.
[GPU Rank 1] Processed batch 8.
[GPU Rank 2] Processed batch 8.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2057, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1866, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2690, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2323, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 114
[GPU Rank 3 | Producer 304] Processing index 23
[GPU Rank 2 | Producer 303] Processing index 137
[GPU Rank 1 | Producer 293] Processing index 94
Batch processed:Batch processed:  88  for rank:for rank:  31

Queue size for GPU 1: 20 samplesQueue size for GPU 3: 20 samples

Batch processed:Batch processed:  88  for rank:for rank:  02

Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samples

[GPU Rank 3 | Producer 296] Processing index 124
[GPU Rank 2 | Producer 299] Processing index 104
[GPU Rank 0 | Producer 306] Processing index 46[GPU Rank 1 | Producer 305] Processing index 55

[GPU Rank 3] Processed batch 9.
[GPU Rank 2] Processed batch 9.
[GPU Rank 1] Processed batch 9.
[GPU Rank 0] Processed batch 9.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1235, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1439, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1860, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2300, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 133
[GPU Rank 3 | Producer 296] Processing index 47
[GPU Rank 2 | Producer 299] Processing index 83
[GPU Rank 0 | Producer 306] Processing index 121
Batch processed:Batch processed:  99  Batch processed:for rank:Batch processed:for rank:  2  0

99  for rank:for rank:Queue size for GPU 2: 20 samples  Queue size for GPU 0: 20 samples
13


Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

[GPU Rank 2 | Producer 295] Processing index 160[GPU Rank 0 | Producer 302] Processing index 86[GPU Rank 3 | Producer 300] Processing index 8

[GPU Rank 1 | Producer 301] Processing index 14

[GPU Rank 3] Processed batch 10.
[GPU Rank 2] Processed batch 10.
[GPU Rank 0] Processed batch 10.
[GPU Rank 1] Processed batch 10.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 145
tensor(0.1196, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1130, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2061, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1975, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 300] Processing index 29
[GPU Rank 2 | Producer 295] Processing index 143
Batch processed:Batch processed:  1010  for rank:for rank:  31

Queue size for GPU 3: 20 samples
Queue size for GPU 1: 20 samples
Batch processed:Batch processed:  1010  for rank:for rank:  02

Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samples

[GPU Rank 3 | Producer 296] Processing index 137
[GPU Rank 1 | Producer 297] Processing index 140[GPU Rank 2 | Producer 303] Processing index 87

[GPU Rank 0 | Producer 294] Processing index 43
[GPU Rank 2] Processed batch 11.
[GPU Rank 0] Processed batch 11.
[GPU Rank 3] Processed batch 11.
[GPU Rank 1] Processed batch 11.
[GPU Rank 1 | Producer 301] Processing index 145
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1806, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3146, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1477, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1301, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 297] Processing index 42
[GPU Rank 2 | Producer 303] Processing index 136
Batch processed:Batch processed:  1111  for rank:for rank:  02

Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samples

Batch processed:Batch processed:  1111  for rank:for rank:  31

Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

[GPU Rank 0 | Producer 302] Processing index 57[GPU Rank 2 | Producer 292] Processing index 138
[GPU Rank 3 | Producer 300] Processing index 3[GPU Rank 1 | Producer 293] Processing index 164


[GPU Rank 2] Processed batch 12.
[GPU Rank 3] Processed batch 12.
[GPU Rank 0] Processed batch 12.
[GPU Rank 1] Processed batch 12.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 294] Processing index 75
tensor(0.1342, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1250, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.0775, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1378, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 296] Processing index 82
[GPU Rank 3 | Producer 300] Processing index 94
[GPU Rank 1 | Producer 293] Processing index 77
[GPU Rank 2 | Producer 292] Processing index 99
Batch processed:Batch processed:Batch processed:Batch processed:    1212 for rank:  for rank:12123   
1for rank:for rank:
  20

Queue size for GPU 3: 20 samplesQueue size for GPU 1: 20 samples

Queue size for GPU 2: 20 samplesQueue size for GPU 0: 20 samples

[GPU Rank 2 | Producer 303] Processing index 113[GPU Rank 3 | Producer 291] Processing index 90[GPU Rank 1 | Producer 297] Processing index 23
[GPU Rank 0 | Producer 298] Processing index 165


[GPU Rank 2] Processed batch 13.
[GPU Rank 3] Processed batch 13.
[GPU Rank 1] Processed batch 13.
[GPU Rank 0] Processed batch 13.
loss_value in pytorchloss_value in pytorch  loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 302] Processing index 141
tensor(0.1435, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.0739, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2520, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2342, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 3 | Producer 291] Processing index 153
[GPU Rank 2 | Producer 303] Processing index 74
[GPU Rank 0 | Producer 298] Processing index 28
[GPU Rank 1 | Producer 297] Processing index 127
Batch processed:Batch processed:Batch processed:   13 for rank: 21313
  for rank:for rank:  Queue size for GPU 2: 20 samples13


Queue size for GPU 1: 20 samplesQueue size for GPU 3: 20 samples

Batch processed: 13 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 295] Processing index 114
[GPU Rank 3 | Producer 300] Processing index 86
[GPU Rank 1 | Producer 293] Processing index 150
[GPU Rank 0 | Producer 302] Processing index 110
[GPU Rank 3] Processed batch 14.
[GPU Rank 1] Processed batch 14.
[GPU Rank 2] Processed batch 14.
[GPU Rank 0] Processed batch 14.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 3 | Producer 300] Processing index 0
tensor(0.0973, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2634, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1986, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1851, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 65
[GPU Rank 2 | Producer 295] Processing index 41
[GPU Rank 1 | Producer 293] Processing index 128
Batch processed:Batch processed:  1414  for rank:for rank:Batch processed:Batch processed:  13  

1414  for rank:for rank: Queue size for GPU 3: 20 samples Queue size for GPU 1: 20 samples0
2


Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samples

[GPU Rank 2 | Producer 303] Processing index 20[GPU Rank 3 | Producer 291] Processing index 65

[GPU Rank 1 | Producer 297] Processing index 136
[GPU Rank 0 | Producer 306] Processing index 14
[GPU Rank 0] Processed batch 15.
[GPU Rank 2] Processed batch 15.
[GPU Rank 3] Processed batch 15.
[GPU Rank 1] Processed batch 15.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1918, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2048, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2315, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2271, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 297] Processing index 16
[GPU Rank 3 | Producer 291] Processing index 154
[GPU Rank 0 | Producer 306] Processing index 80
Batch processed:Batch processed:Batch processed:  1515  for rank:for rank:   02
15
 for rank: 1Queue size for GPU 0: 20 samplesQueue size for GPU 2: 20 samples


Queue size for GPU 1: 20 samples
Batch processed: 15 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 2 | Producer 295] Processing index 63[GPU Rank 0 | Producer 302] Processing index 97[GPU Rank 1 | Producer 301] Processing index 35

[GPU Rank 3 | Producer 296] Processing index 60

[GPU Rank 0] Processed batch 16.
[GPU Rank 2] Processed batch 16.
[GPU Rank 1] Processed batch 16.
[GPU Rank 3] Processed batch 16.
loss_value in pytorchloss_value in pytorch  loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 303] Processing index 49
tensor(0.2011, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1891, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.3111, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1858, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 101
[GPU Rank 2 | Producer 295] Processing index 107
[GPU Rank 3 | Producer 296] Processing index 126
[GPU Rank 1 | Producer 301] Processing index 115
Batch processed: 16 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 16 for rank: 1
Batch processed:Queue size for GPU 1: 20 samples 
16 for rank: 3
Batch processed: Queue size for GPU 3: 20 samples
16 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 2 | Producer 299] Processing index 65[GPU Rank 1 | Producer 297] Processing index 0[GPU Rank 0 | Producer 294] Processing index 106[GPU Rank 3 | Producer 291] Processing index 54



[GPU Rank 0] Processed batch 17.
[GPU Rank 2] Processed batch 17.
[GPU Rank 3] Processed batch 17.
[GPU Rank 1] Processed batch 17.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.2594, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.3321, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1884, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.2091, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 297] Processing index 125
[GPU Rank 3 | Producer 291] Processing index 106
[GPU Rank 2 | Producer 299] Processing index 60
[GPU Rank 0 | Producer 294] Processing index 72
Batch processed:Batch processed:  17Batch processed:17  for rank:for rank:   3117
 
for rank: 0
Queue size for GPU 1: 20 samplesQueue size for GPU 3: 20 samples

Queue size for GPU 0: 20 samples
Batch processed: 17 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 1 | Producer 301] Processing index 63[GPU Rank 0 | Producer 302] Processing index 68
[GPU Rank 2 | Producer 295] Processing index 22
[GPU Rank 3 | Producer 296] Processing index 87

[GPU Rank 1] Processed batch 18.
[GPU Rank 3] Processed batch 18.
[GPU Rank 0] Processed batch 18.
[GPU Rank 2] Processed batch 18.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.0766, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2671, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.0828, device='cuda:1', grad_fn=<DivBackward0>)
tensor(0.1854, device='cuda:0', grad_fn=<DivBackward0>)
[GPU Rank 0 | Producer 302] Processing index 114
[GPU Rank 3 | Producer 296] Processing index 56
[GPU Rank 1 | Producer 301] Processing index 143
[GPU Rank 2 | Producer 295] Processing index 164
Batch processed:Batch processed:  1818  for rank:for rank:  13

Batch processed:Queue size for GPU 1: 20 samplesQueue size for GPU 3: 20 samples 

18 for rank: 2
Queue size for GPU 2: 20 samples
Batch processed: 18 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 3 | Producer 291] Processing index 146
[GPU Rank 1 | Producer 305] Processing index 110
[GPU Rank 0 | Producer 306] Processing index 38[GPU Rank 2 | Producer 299] Processing index 30

[GPU Rank 3] Processed batch 19.
[GPU Rank 2] Processed batch 19.
[GPU Rank 1] Processed batch 19.
[GPU Rank 0] Processed batch 19.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch tensor(0.1438, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2537, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2298, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2700, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 146
[GPU Rank 3 | Producer 291] Processing index 46
[GPU Rank 2 | Producer 299] Processing index 50
Batch processed: Batch processed:Batch processed:19   for rank: 19193  
for rank:for rank:  02

Queue size for GPU 3: 20 samples
Queue size for GPU 2: 20 samplesQueue size for GPU 0: 20 samples

Batch processed: 19 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 0 | Producer 302] Processing index 86[GPU Rank 2 | Producer 303] Processing index 38[GPU Rank 3 | Producer 296] Processing index 144

[GPU Rank 1 | Producer 301] Processing index 19

[GPU Rank 0] Processed batch 20.
[GPU Rank 2] Processed batch 20.
[GPU Rank 3] Processed batch 20.
[GPU Rank 1] Processed batch 20.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 0 | Producer 306] Processing index 0
[GPU Rank 0 | Producer 302] Processing index 145
tensor(0.3725, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.2998, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.1318, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.1282, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 301] Processing index 141
[GPU Rank 3 | Producer 296] Processing index 35
Batch processed:Batch processed:Batch processed:  Batch processed: 2020  for rank:for rank: 0 
202  
for rank:20  Queue size for GPU 0: 20 samples3for rank:
Queue size for GPU 2: 20 samples
 
1
Queue size for GPU 3: 20 samples
Queue size for GPU 1: 20 samples
[GPU Rank 2 | Producer 299] Processing index 103[GPU Rank 0 | Producer 298] Processing index 151
[GPU Rank 3 | Producer 300] Processing index 19
[GPU Rank 1 | Producer 305] Processing index 78

[GPU Rank 3] Processed batch 21.
[GPU Rank 2] Processed batch 21.[GPU Rank 0] Processed batch 21.

[GPU Rank 1] Processed batch 21.
loss_value in pytorch loss_value in pytorch loss_value in pytorch loss_value in pytorch [GPU Rank 2 | Producer 303] Processing index 145
[GPU Rank 2 | Producer 299] Processing index 156
tensor(0.0633, device='cuda:3', grad_fn=<DivBackward0>)
tensor(0.1187, device='cuda:0', grad_fn=<DivBackward0>)
tensor(0.2126, device='cuda:2', grad_fn=<DivBackward0>)
tensor(0.2395, device='cuda:1', grad_fn=<DivBackward0>)
[GPU Rank 1 | Producer 305] Processing index 112
[GPU Rank 0 | Producer 298] Processing index 76
[GPU Rank 3 | Producer 300] Processing index 51
Batch processed:Batch processed:Batch processed:Batch processed:    21212121    for rank:for rank:for rank:for rank:    1302



RAISE StopIterationRAISE StopIterationRAISE StopIterationRAISE StopIteration



:::MLLOG {"namespace": "", "time_ms": 1743705656964, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 106, "epoch_num": 28, "current_lr": 0.8}}
:::MLLOG {"namespace": "", "time_ms": 1743705656966, "event_type": "INTERVAL_START", "key": "eval_start", "value": 28, "metadata": {"file": "/workspace/unet3d/runtime/training.py", "lineno": 115, "epoch_num": 28}}
Batch processed: 0 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 3] Processed batch 1.
I AM HERe to evaluate
Batch processed: 0 for rank: 1
Queue size for GPU 1: 20 samples
Batch processed: 0 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 2 | Producer 307] Processing index 3
[GPU Rank 1] Processed batch 1.
I AM HERe to evaluate
[GPU Rank 2] Processed batch 1.
I AM HERe to evaluate
Batch processed: 0 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 0] Processed batch 1.
I AM HERe to evaluate
[GPU Rank 1 | Producer 309] Processing index 3
[GPU Rank 0 | Producer 310] Processing index 0
[GPU Rank 3 | Producer 308] Processing index 3
Batch processed: 1 for rank: 1
Queue size for GPU 1: 20 samples
[GPU Rank 1 | Producer 309] Processing index 4
[GPU Rank 1] Processed batch 2.
I AM HERe to evaluate
Batch processed: 1 for rank: 0
Queue size for GPU 0: 20 samples
[GPU Rank 0] Processed batch 2.
I AM HERe to evaluate
[GPU Rank 0 | Producer 310] Processing index 1
Batch processed: 1 for rank: 2
Queue size for GPU 2: 20 samples
[GPU Rank 2] Processed batch 2.
I AM HERe to evaluate
[GPU Rank 2 | Producer 307] Processing index 4
Batch processed: 1 for rank: 3
Queue size for GPU 3: 20 samples
[GPU Rank 3 | Producer 308] Processing index 4
[GPU Rank 3] Processed batch 2.
I AM HERe to evaluate
Batch processed: 2 for rank: 2
RAISE StopIteration
Batch processed: 2 for rank: 1
RAISE StopIteration
Batch processed: 2 for rank: 0
RAISE StopIteration
